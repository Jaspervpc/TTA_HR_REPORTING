{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "TTA-HR-ADF"
		},
		"AzureDatabricks HR Reporting_accessToken": {
			"type": "secureString",
			"metadata": "Secure string for 'accessToken' of 'AzureDatabricks HR Reporting'"
		},
		"AzureHRBlobStorage_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AzureHRBlobStorage'"
		},
		"AzureSqlDatabaseLucanet_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AzureSqlDatabaseLucanet'"
		},
		"Azure_FinReport_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Azure_FinReport'"
		},
		"HR_REPORT_DB_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'HR_REPORT_DB'"
		},
		"Sharepoint_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'Sharepoint'"
		},
		"temd_functionKey": {
			"type": "secureString",
			"metadata": "Secure string for 'functionKey' of 'temd'"
		},
		"Personio Rest API_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://api.personio.de/v1/company/custom-reports/reports/86a27088-ef39-4cc2-8a25-f967f6f62eea"
		},
		"RestService_StandardApi_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://api.personio.de/v1/company/employees"
		},
		"Sharepoint_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://timetoactgroup.sharepoint.com/:f:/r/sites/TTG-PowerBIReporting/Shared%20Documents/HR%20Reporting/Historische%20Daten%20aus%20altem%20Reporting/Finale%20Dateien%20zum%20Upload%20in%20PowerBI?csf=1&web=1&e=bRKzhf"
		},
		"Sharepoint_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "markus.wittmer@timetoact.de"
		},
		"temd_properties_typeProperties_functionAppUrl": {
			"type": "string",
			"defaultValue": "https://transform-employee-md.azurewebsites.net/api/run_script_emp?"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/100 STG - 400 DWH FULL LOAD')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Execute Pipeline 100 STG PERS API",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "100 STG SRAE",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Execute Pipeline 150 STG PERS API",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Execute Pipeline 100 STG PERS API",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "150 STG SPA",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Execute Pipeline175 STG PERS API",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Execute Pipeline 150 STG PERS API",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "175 STG SPAE",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "Execute Pipeline 200 STG PERS API",
						"type": "ExecutePipeline",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [
							{
								"activity": "Execute Pipeline175 STG PERS API",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200 STG SAE",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "400_DWH_FAP_PERSONELL_REPORT",
						"type": "ExecutePipeline",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [
							{
								"activity": "Execute Pipeline 200 STG PERS API",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "400_DWH_FAP_PERSONELL_REPORT",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "FULL LOAD - PERSONIO API EMPLOYEES"
				},
				"annotations": [],
				"lastPublishTime": "2025-10-21T08:50:40Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/100 STG SRAE')]",
				"[concat(variables('factoryId'), '/pipelines/150 STG SPA')]",
				"[concat(variables('factoryId'), '/pipelines/175 STG SPAE')]",
				"[concat(variables('factoryId'), '/pipelines/200 STG SAE')]",
				"[concat(variables('factoryId'), '/pipelines/400_DWH_FAP_PERSONELL_REPORT')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/100 STG SRAE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get Bearer",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {
								"Content-Type": "application/json"
							},
							"url": "https://api.personio.de/v1/auth?client_id=papi-1228d1b2-0fcc-4d05-bfaf-06c92f6b6d68&client_secret=papi-ZDUxY2M2N2ItYzY3NS00OTNiLTgyMTMtNDZmNTA5NjkzNzNj",
							"body": "\""
						}
					},
					{
						"name": "Set Token",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Get Bearer",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "BEARERTOKEN",
							"value": {
								"value": "@concat('Bearer ', activity('Get Bearer').output.data.token)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy JSON to Blob",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set Token",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"additionalHeaders": {
									"Authorization": {
										"value": "@variables('BEARERTOKEN')",
										"type": "Expression"
									}
								},
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "Personio_API_Data",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "JSON_PersonioAPI",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "DF_SRAE",
						"description": "Dataflow to fulfill table SRAE\n",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Copy JSON to Blob",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF 100 STG Personio api data",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "Get Bearer Standard Api",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {
								"Content-Type": "application/json"
							},
							"url": "https://api.personio.de/v1/auth?client_id=OTI2MjA2NjgyODIzMThkYzMwYWVlMGUw&client_secret=MTQ3ZGIzNDlmMTMzNmQwZTI4ZWVlMDVkN2U4MjZhYzkwODYw",
							"body": "\""
						}
					},
					{
						"name": "Set Token Standard Api",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Get Bearer Standard Api",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "token",
							"value": {
								"value": "@concat('Bearer ', activity('Get Bearer Standard Api').output.data.token)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy JSON to Blob 2",
						"type": "Copy",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [
							{
								"activity": "Set Token Standard Api",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"additionalHeaders": {
									"Authorization": {
										"value": "@variables('token')",
										"type": "Expression"
									}
								},
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "RestResource_StandardApi",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "JSON_standard_Api",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"BEARERTOKEN": {
						"type": "String"
					},
					"token": {
						"type": "String"
					}
				},
				"folder": {
					"name": "FULL LOAD - PERSONIO API EMPLOYEES"
				},
				"annotations": [],
				"lastPublishTime": "2025-05-12T06:43:26Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Personio_API_Data')]",
				"[concat(variables('factoryId'), '/datasets/JSON_PersonioAPI')]",
				"[concat(variables('factoryId'), '/dataflows/DF 100 STG Personio api data')]",
				"[concat(variables('factoryId'), '/datasets/RestResource_StandardApi')]",
				"[concat(variables('factoryId'), '/datasets/JSON_standard_Api')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/150 STG SPA')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "DF_SPA",
						"description": "Dataflow to fulfill table SPA\n",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF 150 STG Personio api data",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"source2": {},
									"badchurns": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "FULL LOAD - PERSONIO API EMPLOYEES"
				},
				"annotations": [],
				"lastPublishTime": "2025-01-08T10:20:45Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/DF 150 STG Personio api data')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/175 STG SPAE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "DF SPAE",
						"description": "Dataflow to fulfill table SPAE\n",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF 175 STG Personio api data",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "FULL LOAD - PERSONIO API EMPLOYEES"
				},
				"annotations": [],
				"lastPublishTime": "2025-01-08T10:20:45Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/DF 175 STG Personio api data')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200 STG SAE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Transform in Load Period Format",
						"description": "Wird durch AZURE FUNCTIONS ersetzt!",
						"type": "DatabricksNotebook",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": "/Users/jasper.vonpetersdorff-campen@timetoact.de/Transform API Data in Load Period Format"
						},
						"linkedServiceName": {
							"referenceName": "AzureDatabricks HR Reporting",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Add dynamic Age",
						"type": "ExecuteDataFlow",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "Add Age Calculation",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "Add Non Personio Employees",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Azure Function1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "Add_NonPersonio_Employees",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"MinloadPeriod": {},
									"CompanyTranslation": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "Clean incomplete periods",
						"description": "Ist im AZURE FUNCTION Code implementiert",
						"type": "ExecuteDataFlow",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [
							{
								"activity": "Transform in Load Period Format",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dataflow1",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"STGSAE": {},
									"MINLOADPERSONIO": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "Add Api Data",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Add Non Personio Employees",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [200_STG].[SEM_EMPLOYEES_MERGED]\n",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "SAE_ID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "SEM_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_SID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_SID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_VALID_FROM",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "SEM_VALID_FROM",
											"type": "Date",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SAE_VALID_TO",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "SEM_VALID_TO",
											"type": "Date",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SAE_COST_CENTRE",
											"type": "Double",
											"physicalType": "float"
										},
										"sink": {
											"name": "SEM_COST_CENTRE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_cost_center_name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_COST_CENTER_NAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_cost_center_weight",
											"type": "Double",
											"physicalType": "float"
										},
										"sink": {
											"name": "SEM_COST_CENTER_WEIGHT",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SAE_DEPARTMENT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_DEPARTMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_FIRST_ENTRY_DATE",
											"type": "Date",
											"physicalType": "date"
										},
										"sink": {
											"name": "SEM_FIRST_ENTRY_DATE",
											"type": "Date",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SAE_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD",
											"type": "Date",
											"physicalType": "date"
										},
										"sink": {
											"name": "SEM_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD",
											"type": "Date",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SAE_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD",
											"type": "Date",
											"physicalType": "date"
										},
										"sink": {
											"name": "SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD",
											"type": "Date",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SAE_HIRED_AS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_HIRED_AS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_EMPLOYEE_GROUPS_BY_FUNCTION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_EMPLOYEE_GROUPS_BY_FUNCTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_MAILADDRESS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_MAILADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_FTE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_FTE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_GENDER",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_GENDER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_POSITION",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_POSITION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_COMPANY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_COMPANY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_EXIT_TYPE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_EXIT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_WEEKLY_HOURS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_WEEKLY_HOURS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_upload_date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "SEM_UPLOAD_DATE",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "SAE_FIRSTNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_FIRSTNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_LASTNAME",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_LASTNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_PLACE_OF_BUSINESS",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_PLACE_OF_BUSINESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_DEGREE_OF_SEVERE_DISABILITY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_DEGREE_OF_SEVERE_DISABILITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_DATE_OF_BIRTH",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_DATE_OF_BIRTH",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_BAD_CHURN",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_BAD_CHURN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_LOAD_PERIOD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_LOAD_PERIOD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "SAE_AGE",
											"type": "Double",
											"physicalType": "float"
										},
										"sink": {
											"name": "SEM_AGE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SAE_TENURE",
											"type": "Double",
											"physicalType": "float"
										},
										"sink": {
											"name": "SEM_TENURE",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SAE_COMPANY_KEY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SEM_COMPANY_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "200_STG_SAE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "200_STG_SEM",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Add Excel Data",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Add Api Data",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SEM_ID",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COST_CENTRE",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "SEM_COST_CENTRE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DEPARTMENT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SEM_DEPARTMENT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIRST_ENTRY_DATE",
											"type": "Date",
											"physicalType": "date"
										},
										"sink": {
											"name": "SEM_FIRST_ENTRY_DATE",
											"type": "Date",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD",
											"type": "Date",
											"physicalType": "date"
										},
										"sink": {
											"name": "SEM_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD",
											"type": "Date",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD",
											"type": "Date",
											"physicalType": "date"
										},
										"sink": {
											"name": "SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD",
											"type": "Date",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "HIRED_AS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SEM_HIRED_AS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EMPLOYEE_GROUPS_BY_FUNCTION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SEM_EMPLOYEE_GROUPS_BY_FUNCTION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "MAILADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SEM_MAILADDRESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FTE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 27
										},
										"sink": {
											"name": "SEM_FTE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "GENDER",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SEM_GENDER",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "POSITION",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SEM_POSITION",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SEM_COMPANY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "EXIT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SEM_EXIT_TYPE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WEEKLY_HOURS",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 27
										},
										"sink": {
											"name": "SEM_WEEKLY_HOURS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "FIRSTNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SEM_FIRSTNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LASTNAME",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SEM_LASTNAME",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PLACE_OF_BUSINESS",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SEM_PLACE_OF_BUSINESS",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DEGREE_OF_SEVERE_DISABILITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SEM_DEGREE_OF_SEVERE_DISABILITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BAD_CHURN",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SEM_BAD_CHURN",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "LOAD_PERIOD",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SEM_LOAD_PERIOD",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "AGE",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 27
										},
										"sink": {
											"name": "SEM_AGE",
											"type": "Int32",
											"physicalType": "int"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "200_STG_SEE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "200_STG_SEM",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Azure Function1",
						"type": "AzureFunctionActivity",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"functionName": "run-script-emp",
							"headers": {},
							"method": "GET"
						},
						"linkedServiceName": {
							"referenceName": "temd",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"token": {
						"type": "String"
					}
				},
				"folder": {
					"name": "FULL LOAD - PERSONIO API EMPLOYEES"
				},
				"annotations": [],
				"lastPublishTime": "2025-10-21T09:22:41Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDatabricks HR Reporting')]",
				"[concat(variables('factoryId'), '/dataflows/Add Age Calculation')]",
				"[concat(variables('factoryId'), '/dataflows/Add_NonPersonio_Employees')]",
				"[concat(variables('factoryId'), '/dataflows/dataflow1')]",
				"[concat(variables('factoryId'), '/datasets/200_STG_SAE')]",
				"[concat(variables('factoryId'), '/datasets/200_STG_SEM')]",
				"[concat(variables('factoryId'), '/datasets/200_STG_SEE')]",
				"[concat(variables('factoryId'), '/linkedServices/temd')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_COMPANIES')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy Companies",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [200_STG].[D_COMPANIES]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "GES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "GES",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "GES_BEZ",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "GES_BEZ",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "PNLSHEET",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PNLSHEET",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "GES_MAPPING_CRM",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "GES_MAPPING_CRM",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "COMPANY_BU",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COMPANY_BU",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "GES_MAPPING_CRM_SHORT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "GES_MAPPING_CRM_SHORT",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "GES_LUCANET",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "GES_LUCANET",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "BRAND_ID",
											"type": "String",
											"physicalType": "nchar"
										},
										"sink": {
											"name": "BRAND_ID",
											"type": "String",
											"physicalType": "String"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FinRepCompanies",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "200_Companies",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "200_STG"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-13T06:25:43Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/FinRepCompanies')]",
				"[concat(variables('factoryId'), '/datasets/200_Companies')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_COMPANIES_TRANSLATIONS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy company translations",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [200_STG].[D_COMPANY_TRANSLATION]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Gesellschaft",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "COMPANY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Kürzel",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "COMPANY_KEY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "gültig bis",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "VALID_FROM",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "gültig ab",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "VALID_TO",
											"type": "Int32",
											"physicalType": "int"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "CompanyMapping",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "200_CompanyTranslation",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "200_STG"
				},
				"annotations": [],
				"lastPublishTime": "2025-11-03T14:29:19Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/CompanyMapping')]",
				"[concat(variables('factoryId'), '/datasets/200_CompanyTranslation')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_FINANCIAL_DATA')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy Financial Data",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [200_STG].[F_FINANCIAL_DATA]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "GES",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "GES",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "KTO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "KTO",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "JAHR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "JAHR",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MONAT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "MONAT",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PERIODE",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PERIODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SALDO",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 18
										},
										"sink": {
											"name": "VALUE_ACT",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "BUDGET",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 18
										},
										"sink": {
											"name": "VALUE_BUDGET",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 18
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FINREP_FINREPORT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "200_Financial_Data",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "200_STG"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-19T10:26:16Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/FINREP_FINREPORT')]",
				"[concat(variables('factoryId'), '/datasets/200_Financial_Data')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_FINANCIAL_DATA_LUCANET')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy Data",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [200_STG].[F_FINANCIAL_DATA]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "OrganisationElementName",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "GES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ReportElementID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KTO",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PeriodID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PERIODE",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Value",
											"type": "Double",
											"physicalType": "float"
										},
										"sink": {
											"name": "VALUE",
											"type": "Double",
											"physicalType": "float"
										}
									},
									{
										"source": {
											"name": "DataLevelID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "VERSION",
											"type": "Int64",
											"physicalType": "bigint"
										}
									},
									{
										"source": {
											"name": "AdjustmentLevelName",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "KONSEBENE",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "LucanetSQL_Data",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "200_Financial_Data",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy Account",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [200_STG].[D_FINANCIAL_ACCOUNTS]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "WorkspaceID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "WorkspaceID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "ReportElementID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ReportElementID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "AccountName",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountName",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "SourceAccountID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "SourceAccountID",
											"type": "Int64",
											"physicalType": "Int64"
										}
									},
									{
										"source": {
											"name": "ChildIndex",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "ChildIndex",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "PeriodType",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PeriodType",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "BalanceType",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "BalanceType",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "TransactionTypeCategoryID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "TransactionTypeCategoryID",
											"type": "Int64",
											"physicalType": "Int64"
										}
									},
									{
										"source": {
											"name": "IsFormula",
											"type": "Int16",
											"physicalType": "smallint"
										},
										"sink": {
											"name": "IsFormula",
											"type": "Int16",
											"physicalType": "Int16"
										}
									},
									{
										"source": {
											"name": "IsTotalLine",
											"type": "Int16",
											"physicalType": "smallint"
										},
										"sink": {
											"name": "IsTotalLine",
											"type": "Int16",
											"physicalType": "Int16"
										}
									},
									{
										"source": {
											"name": "IsTimeSeries",
											"type": "Int16",
											"physicalType": "smallint"
										},
										"sink": {
											"name": "IsTimeSeries",
											"type": "Int16",
											"physicalType": "Int16"
										}
									},
									{
										"source": {
											"name": "IsSeparatorLine",
											"type": "Int16",
											"physicalType": "smallint"
										},
										"sink": {
											"name": "IsSeparatorLine",
											"type": "Int16",
											"physicalType": "Int16"
										}
									},
									{
										"source": {
											"name": "GeneralLedgerAccount",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "GeneralLedgerAccount",
											"type": "Int64",
											"physicalType": "Int64"
										}
									},
									{
										"source": {
											"name": "PermittedUsersForAccount",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PermittedUsersForAccount",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "AccountLevel1ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountLevel1ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "AccountLevel1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountLevel1",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "AccountLevel1CI",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AccountLevel1CI",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "AccountLevel2ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountLevel2ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "AccountLevel2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountLevel2",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "AccountLevel2CI",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AccountLevel2CI",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "AccountLevel3ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountLevel3ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "AccountLevel3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountLevel3",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "AccountLevel3CI",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AccountLevel3CI",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "AccountLevel4ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountLevel4ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "AccountLevel4",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountLevel4",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "AccountLevel4CI",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AccountLevel4CI",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "AccountLevel5ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountLevel5ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "AccountLevel5",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountLevel5",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "AccountLevel5CI",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AccountLevel5CI",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "AccountLevel6ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountLevel6ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "AccountLevel6",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountLevel6",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "AccountLevel6CI",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AccountLevel6CI",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "AccountLevel7ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountLevel7ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "AccountLevel7",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountLevel7",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "AccountLevel7CI",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "AccountLevel7CI",
											"type": "Int32",
											"physicalType": "Int32"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "AzureSQL_Account",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSqlAccount",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy Companies",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [200_STG].[D_COMPANY_BU]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "AccountingOrConsolidationArea",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "AccountingOrConsolidationArea",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "OrganisationElementID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "OrganisationElementID",
											"type": "Int64",
											"physicalType": "Int64"
										}
									},
									{
										"source": {
											"name": "OrganisationElementName",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OrganisationElementName",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "OrganisationElementChildIndex",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OrganisationElementChildIndex",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "SourceType",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "SourceType",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "ReportingEntityID",
											"type": "Int64",
											"physicalType": "bigint"
										},
										"sink": {
											"name": "ReportingEntityID",
											"type": "Int64",
											"physicalType": "Int64"
										}
									},
									{
										"source": {
											"name": "DefaultTransactionCurrency",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DefaultTransactionCurrency",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "PermittedUsersForElement",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "PermittedUsersForElement",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "OrganisationLevel1ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OrganisationLevel1ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "OrganisationLevel1",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OrganisationLevel1",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "OrganisationLevel1CI",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OrganisationLevel1CI",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "OrganisationLevel2ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OrganisationLevel2ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "OrganisationLevel2",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OrganisationLevel2",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "OrganisationLevel2CI",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OrganisationLevel2CI",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "OrganisationLevel3ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OrganisationLevel3ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "OrganisationLevel3",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OrganisationLevel3",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "OrganisationLevel3CI",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OrganisationLevel3CI",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "OrganisationLevel4ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OrganisationLevel4ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "OrganisationLevel4",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OrganisationLevel4",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "OrganisationLevel4CI",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OrganisationLevel4CI",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "OrganisationLevel5ID",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OrganisationLevel5ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "OrganisationLevel5",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "OrganisationLevel5",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "OrganisationLevel5CI",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "OrganisationLevel5CI",
											"type": "Int32",
											"physicalType": "Int32"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "AzureSqlLucanetCompanies",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSqlCompanyBU",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "200_STG"
				},
				"annotations": [],
				"lastPublishTime": "2023-07-19T10:26:16Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/LucanetSQL_Data')]",
				"[concat(variables('factoryId'), '/datasets/200_Financial_Data')]",
				"[concat(variables('factoryId'), '/datasets/AzureSQL_Account')]",
				"[concat(variables('factoryId'), '/datasets/AzureSqlAccount')]",
				"[concat(variables('factoryId'), '/datasets/AzureSqlLucanetCompanies')]",
				"[concat(variables('factoryId'), '/datasets/AzureSqlCompanyBU')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_FINANCIAL_DATA_LUCANET_XLS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "200_FINANCIAL_DATA_LUCANET_XLSX",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "200_FINANCIAL_DATA_LUCANET_XLSX",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"XLSX": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "200_STG"
				},
				"annotations": [],
				"lastPublishTime": "2023-06-30T09:30:55Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/200_FINANCIAL_DATA_LUCANET_XLSX')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_PERSONELL_BUDGET')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "200_PERSONELL_BUDGET",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "200_PERSONELL_BUDGET",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"CSV": {},
									"personellbudget": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "200_STG"
				},
				"annotations": [],
				"lastPublishTime": "2024-06-07T14:34:27Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/200_PERSONELL_BUDGET')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_PERSONIO_DATA')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "200_PERSONIO_DATA",
						"description": "",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "200_PERSONIO_DATA",
								"type": "DataFlowReference",
								"parameters": {
									"PYear": {
										"value": "'@{pipeline().parameters.Jahr}'",
										"type": "Expression"
									},
									"PMonth": {
										"value": "'@{pipeline().parameters.Monat}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"PersonioASCII": {},
									"source1": {},
									"Personio": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Jahr": {
						"type": "string",
						"defaultValue": "2023"
					},
					"Monat": {
						"type": "string",
						"defaultValue": "03"
					}
				},
				"folder": {
					"name": "200_STG"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-18T12:17:14Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/200_PERSONIO_DATA')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_PERSONIO_DATA_bis_202301')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "200_PERSONIO_DATA_bis_202301",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "200_PERSONIO_DATA_bis_202301",
								"type": "DataFlowReference",
								"parameters": {
									"PYear": {
										"value": "'@{pipeline().parameters.Jahr}'",
										"type": "Expression"
									},
									"PMonth": {
										"value": "'@{pipeline().parameters.Monat}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"PersonioASCII": {},
									"Personio": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"parameters": {
					"Jahr": {
						"type": "string",
						"defaultValue": "2023"
					},
					"Monat": {
						"type": "string",
						"defaultValue": "03"
					}
				},
				"folder": {
					"name": "200_STG"
				},
				"annotations": [],
				"lastPublishTime": "2023-05-03T14:42:54Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/200_PERSONIO_DATA_bis_202301')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_Personio_Data_2022')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "200_PERSONIO_DATA_bis_202301",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_PERSONIO_DATA_bis_202301",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Jahr": "2022",
								"Monat": "01"
							}
						}
					},
					{
						"name": "200_PERSONIO_DATA_bis_202301_2",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_PERSONIO_DATA_bis_202301",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Jahr": "2022",
								"Monat": "02"
							}
						}
					},
					{
						"name": "200_PERSONIO_DATA_bis_202301_3",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_PERSONIO_DATA_bis_202301",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Jahr": "2022",
								"Monat": "03"
							}
						}
					},
					{
						"name": "200_PERSONIO_DATA_bis_202301_4",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_PERSONIO_DATA_bis_202301",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Jahr": "2022",
								"Monat": "04"
							}
						}
					},
					{
						"name": "200_PERSONIO_DATA_bis_202301_5",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_PERSONIO_DATA_bis_202301",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Jahr": "2022",
								"Monat": "05"
							}
						}
					},
					{
						"name": "200_PERSONIO_DATA_bis_202301_6",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_PERSONIO_DATA_bis_202301",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Jahr": "2022",
								"Monat": "06"
							}
						}
					},
					{
						"name": "200_PERSONIO_DATA_bis_202301_7",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_PERSONIO_DATA_bis_202301",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Jahr": "2022",
								"Monat": "07"
							}
						}
					},
					{
						"name": "200_PERSONIO_DATA_bis_202301_8",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_PERSONIO_DATA_bis_202301",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Jahr": "2022",
								"Monat": "08"
							}
						}
					},
					{
						"name": "200_PERSONIO_DATA_bis_202301_9",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_PERSONIO_DATA_bis_202301",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Jahr": "2022",
								"Monat": "09"
							}
						}
					},
					{
						"name": "200_PERSONIO_DATA_bis_202301_10",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_PERSONIO_DATA_bis_202301",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Jahr": "2022",
								"Monat": "10"
							}
						}
					},
					{
						"name": "200_PERSONIO_DATA_bis_202301_11",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_PERSONIO_DATA_bis_202301",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Jahr": "2022",
								"Monat": "11"
							}
						}
					},
					{
						"name": "200_PERSONIO_DATA_bis_202301_12",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_PERSONIO_DATA_bis_202301",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Jahr": "2022",
								"Monat": "12"
							}
						}
					},
					{
						"name": "200_PERSONIO_DATA_bis_202301_13",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_PERSONIO_DATA_bis_202301",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Jahr": "2023",
								"Monat": "01"
							}
						}
					},
					{
						"name": "200_PERSONIO_DATA",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_PERSONIO_DATA",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Jahr": "2023",
								"Monat": "02"
							}
						}
					},
					{
						"name": "200_PERSONIO_DATA_2",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_PERSONIO_DATA",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Jahr": "2023",
								"Monat": "03"
							}
						}
					},
					{
						"name": "200_PERSONIO_DATA_3",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_PERSONIO_DATA",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Jahr": "2023",
								"Monat": "04"
							}
						}
					},
					{
						"name": "400_PERSONELL_DATA",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "200_PERSONIO_DATA_bis_202301_13",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "200_PERSONIO_DATA",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "200_PERSONIO_DATA_2",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "200_PERSONIO_DATA_3",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "200_PERSONIO_DATA_bis_202301_12",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "200_PERSONIO_DATA_bis_202301_11",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "200_PERSONIO_DATA_bis_202301_10",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "200_PERSONIO_DATA_bis_202301_9",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "200_PERSONIO_DATA_bis_202301_8",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "200_PERSONIO_DATA_bis_202301_7",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "200_PERSONIO_DATA_bis_202301",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "200_PERSONIO_DATA_bis_202301_2",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "200_PERSONIO_DATA_bis_202301_3",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "200_PERSONIO_DATA_bis_202301_4",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "200_PERSONIO_DATA_bis_202301_5",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "200_PERSONIO_DATA_bis_202301_6",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "200_PERSONIO_DATA1",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "200_PERSONIO_DATA2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "400_PERSONELL_DATA",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "200_PERSONIO_DATA1",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_PERSONIO_DATA",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Jahr": "2023",
								"Monat": "05"
							}
						}
					},
					{
						"name": "200_PERSONIO_DATA2",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_PERSONIO_DATA",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"Jahr": "2023",
								"Monat": "06"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2023-07-24T08:51:51Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/200_PERSONIO_DATA_bis_202301')]",
				"[concat(variables('factoryId'), '/pipelines/200_PERSONIO_DATA')]",
				"[concat(variables('factoryId'), '/pipelines/400_PERSONELL_DATA')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_TRANSLATIONS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "200_TRANSLATIONS",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [200_STG].[TRANSLATIONS]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Bereich",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Bereich",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "Deutsch",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Deutsch",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "Deutsch_kurz",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Deutsch_kurz",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "Englisch",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Englisch",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "für PowerBi ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "für PowerBi ",
											"type": "String",
											"physicalType": "String"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Excel_Translations",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "200_TRANSLATIONS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "200_STG"
				},
				"annotations": [],
				"lastPublishTime": "2023-05-11T07:43:58Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Excel_Translations')]",
				"[concat(variables('factoryId'), '/datasets/200_TRANSLATIONS')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_COMPANIES')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data Companies",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [400_DWH].[D_COMPANIES]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "GES",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "GES",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "GES_BEZ",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "GES_BEZ",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "GES_MAPPING_CRM",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "GES_MAPPING_CRM",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "COMPANY_BU",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "COMPANY_BU",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "GES_MAPPING_CRM_SHORT",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "GES_MAPPING_CRM_SHORT",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "GES_LUCANET",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "GES_LUCANET",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "BRAND_ID",
											"type": "String",
											"physicalType": "nchar"
										},
										"sink": {
											"name": "BRAND_ID",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "GES_SUBGROUP",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "GES_SUBGROUP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "GES_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "GES_LEGAL_ENTITY",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "200_Companies",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "400_Companies",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "400_DWH"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-24T12:03:12Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/200_Companies')]",
				"[concat(variables('factoryId'), '/datasets/400_Companies')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_DWH_FAP_PERSONELL_REPORT')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Script1",
						"type": "Script",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [
							{
								"activity": "400_DWH FAP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "HR_REPORT_DB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "truncate table [400_DWH].[ACT_PERIOD] \n\nINSERT INTO [400_DWH].[ACT_PERIOD] ( [ACTPERIOD], [ACTPERIOD_DATE] )\nSELECT MAX(  load_period ) as [ACTPERIOD], EOMONTH( concat(left(max(load_period), 4), '/', right(max(LOAD_PERIOD), 2), '/01')) as [ACTPERIOD_DATE]\n  FROM [200_STG].[F_PERSONIO_DATA]"
								}
							],
							"scriptBlockExecutionTimeout": "02:00:00"
						}
					},
					{
						"name": "400_DWH FAP",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "400_PERSONELL_DATA_PYTHON",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"PersonioBasis": {},
									"PERIODE": {},
									"Uebersetzung": {},
									"Uebersetzung2": {},
									"Companytranslations": {},
									"source1": {},
									"PersonellData": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "FULL LOAD - PERSONIO API EMPLOYEES"
				},
				"annotations": [],
				"lastPublishTime": "2025-06-30T08:49:30Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]",
				"[concat(variables('factoryId'), '/dataflows/400_PERSONELL_DATA_PYTHON')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_FINANCIAL_DATA')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "400_FINANCIAL_DATA",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "400_FINANCIAL_DATA",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"quelle": {},
									"periode": {},
									"CompanyTranslation": {},
									"Kto": {},
									"CompanyBU": {},
									"sink2": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "400_DWH"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-12T14:41:59Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/400_FINANCIAL_DATA')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_PERSONELL_BUDGET')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "400_PERSONELL_BUDGET",
						"type": "ExecuteDataFlow",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "400_PERSONELL_BUDGET",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"Budget200": {},
									"Ges": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "400_PERSONELL_BUDGET_pivot",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Script1_Delete400",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "400_PERSONELL_BUDGET_pivot",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"Budget100": {},
									"Ges": {},
									"Translation": {},
									"source9": {},
									"CompanyMapping": {},
									"sink2": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "400_PERSONELL_BUDGET_unpivot",
						"type": "ExecuteDataFlow",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "400_PERSONELL_BUDGET_unpivot",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"Budget200TMP": {},
									"Ges": {},
									"sink2": {},
									"sink3": {},
									"sink4": {},
									"sink5": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "Script1_Delete400",
						"type": "Script",
						"state": "Inactive",
						"onInactiveMarkAs": "Succeeded",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "HR_REPORT_DB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "truncate table [400_DWH].[F_PERSONELL_BUDGET]"
								}
							],
							"scriptBlockExecutionTimeout": "02:00:00"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "400_DWH"
				},
				"annotations": [],
				"lastPublishTime": "2024-06-07T08:56:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/400_PERSONELL_BUDGET')]",
				"[concat(variables('factoryId'), '/dataflows/400_PERSONELL_BUDGET_pivot')]",
				"[concat(variables('factoryId'), '/dataflows/400_PERSONELL_BUDGET_unpivot')]",
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_PERSONELL_DATA')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "400_PERSONELL_DATA",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "400_PERSONELL_DATA",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"PersonioBasis": {},
									"PERIODE": {},
									"Uebersetzung": {},
									"Uebersetzung2": {},
									"Companytranslations": {},
									"source1": {},
									"PersonellData": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "Script1",
						"type": "Script",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "HR_REPORT_DB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "truncate table [400_DWH].[ACT_PERIOD] \n\nINSERT INTO [400_DWH].[ACT_PERIOD] ( [ACTPERIOD], [ACTPERIOD_DATE] )\nSELECT MAX(  load_period ) as [ACTPERIOD], EOMONTH( concat(left(max(load_period), 4), '/', right(max(LOAD_PERIOD), 2), '/01')) as [ACTPERIOD_DATE]\n  FROM [200_STG].[F_PERSONIO_DATA]"
								}
							],
							"scriptBlockExecutionTimeout": "02:00:00"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "400_DWH"
				},
				"annotations": [],
				"lastPublishTime": "2025-01-02T13:12:10Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/400_PERSONELL_DATA')]",
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_TRANSLATIONS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "400_TRANSLATIONS",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "400_TRANSLATIONS",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"quelleUebersetzungen": {},
									"zielUEbersetzungen": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "400_DWH"
				},
				"annotations": [],
				"lastPublishTime": "2023-05-10T09:13:20Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/400_TRANSLATIONS')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Import Lucanet')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "200_FINANCIAL_DATA_LUCANET",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_FINANCIAL_DATA_LUCANET",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "400_FINANCIAL_DATA",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "200_FINANCIAL_DATA_LUCANET",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "400_FINANCIAL_DATA",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2023-08-15T13:42:05Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/200_FINANCIAL_DATA_LUCANET')]",
				"[concat(variables('factoryId'), '/pipelines/400_FINANCIAL_DATA')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Import_single_Month')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ForEach1",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Get Metadata1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Get Metadata1').output.childItems",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "200_PERSONIO_DATA",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Set variable Jahr",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Set variable Monat",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "200_PERSONIO_DATA",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"Jahr": {
												"value": "@variables('VJahr')",
												"type": "Expression"
											},
											"Monat": {
												"value": "@variables('VMonat')",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "400_PERSONELL_DATA",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "200_PERSONIO_DATA",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "400_PERSONELL_DATA",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {}
									}
								},
								{
									"name": "Set variable Jahr",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "VJahr",
										"value": {
											"value": "@substring(item().name, 5, 4)",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set variable Monat",
									"type": "SetVariable",
									"dependsOn": [],
									"policy": {
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"variableName": "VMonat",
										"value": {
											"value": "@substring(item().name, 10, 2)",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "Get Metadata1",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "PersonioASCII",
								"type": "DatasetReference",
								"parameters": {}
							},
							"fieldList": [
								"childItems",
								"itemName"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"VJahr": {
						"type": "String"
					},
					"VMonat": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2024-04-30T09:53:06Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/PersonioASCII')]",
				"[concat(variables('factoryId'), '/pipelines/200_PERSONIO_DATA')]",
				"[concat(variables('factoryId'), '/pipelines/400_PERSONELL_DATA')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/STG PERS API_copy1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get Bearer",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"method": "POST",
							"headers": {
								"Content-Type": "application/json"
							},
							"url": "https://api.personio.de/v1/auth?client_id=OTI2MjA2NjgyODIzMThkYzMwYWVlMGUw&client_secret=MTQ3ZGIzNDlmMTMzNmQwZTI4ZWVlMDVkN2U4MjZhYzkwODYw",
							"body": "\""
						}
					},
					{
						"name": "Set Token",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Get Bearer",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "BEARERTOKEN",
							"value": {
								"value": "@concat('Bearer ', activity('Get Bearer').output.data.token)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Copy JSON to Blob",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Set Token",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"additionalHeaders": {
									"Authorization": {
										"value": "@variables('BEARERTOKEN')",
										"type": "Expression"
									}
								},
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "JsonSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "JsonWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "Personio_API_Data",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "JSON_PersonioAPI",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Data flow1",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Copy JSON to Blob",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF 100 STG Personio api data",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"variables": {
					"BEARERTOKEN": {
						"type": "String"
					}
				},
				"folder": {
					"name": "FULL LOAD - PERSONIO API EMPLOYEES"
				},
				"annotations": [],
				"lastPublishTime": "2025-01-08T09:24:30Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Personio_API_Data')]",
				"[concat(variables('factoryId'), '/datasets/JSON_PersonioAPI')]",
				"[concat(variables('factoryId'), '/dataflows/DF 100 STG Personio api data')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Test_FEB2024')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "400_PERSONELL_DATA_from_FEB24",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "400_PERSONELL_DATA_from_FEB24",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"PersonioBasis": {},
									"PERIODE": {},
									"Uebersetzung": {},
									"Uebersetzung2": {},
									"Companytranslations": {},
									"PersonellData": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2024-03-13T08:05:31Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/400_PERSONELL_DATA_from_FEB24')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/temp')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "200_TRANSLATIONS",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "200_TRANSLATIONS",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "400_TRANSLATIONS",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "200_TRANSLATIONS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "400_TRANSLATIONS",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "400_PERSONELL_DATA",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "400_TRANSLATIONS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "400_PERSONELL_DATA",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2023-05-15T14:11:48Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/200_TRANSLATIONS')]",
				"[concat(variables('factoryId'), '/pipelines/400_TRANSLATIONS')]",
				"[concat(variables('factoryId'), '/pipelines/400_PERSONELL_DATA')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/100_STG_PERS_BUDGET_24')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "100_STG",
					"table": "PERS_BUDGET_24"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/100_STG_SRAE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Datasets - PERSONIO API DATA"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "employee_id",
						"type": "int",
						"precision": 10
					},
					{
						"name": "attribute_id",
						"type": "nvarchar"
					},
					{
						"name": "cost_center_id",
						"type": "int",
						"precision": 10
					},
					{
						"name": "cost_center_name",
						"type": "nvarchar"
					},
					{
						"name": "cost_center_weight",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "data_type",
						"type": "nvarchar"
					},
					{
						"name": "effective_date",
						"type": "date"
					},
					{
						"name": "entity_id",
						"type": "int",
						"precision": 10
					},
					{
						"name": "value",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "100_STG",
					"table": "SRAE_raw_api_employees"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/150_STG_SPA')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Datasets - PERSONIO API DATA"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "150_STG",
					"table": "SPA_PERSONIO_API_EMPLOYEES"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/175_STG_SPAE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Datasets - PERSONIO API DATA"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "175_STG",
					"table": "SPAE_PERSONIO_API_EMPLOYEES"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_Companies')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "GES",
						"type": "nvarchar"
					},
					{
						"name": "GES_BEZ",
						"type": "nvarchar"
					},
					{
						"name": "PNLSHEET",
						"type": "nvarchar"
					},
					{
						"name": "GES_MAPPING_CRM",
						"type": "nvarchar"
					},
					{
						"name": "COMPANY_BU",
						"type": "nvarchar"
					},
					{
						"name": "GES_MAPPING_CRM_SHORT",
						"type": "nvarchar"
					},
					{
						"name": "GES_LUCANET",
						"type": "nvarchar"
					},
					{
						"name": "BRAND_ID",
						"type": "nchar"
					}
				],
				"typeProperties": {
					"schema": "200_STG",
					"table": "D_COMPANIES"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_CompanyTranslation')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "COMPANY",
						"type": "nvarchar"
					},
					{
						"name": "COMPANY_KEY",
						"type": "nvarchar"
					},
					{
						"name": "VALID_TO",
						"type": "int",
						"precision": 10
					},
					{
						"name": "VALID_FROM",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "200_STG",
					"table": "D_COMPANY_TRANSLATION"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_Financial_Data')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "GES",
						"type": "nvarchar"
					},
					{
						"name": "KTO",
						"type": "nvarchar"
					},
					{
						"name": "PERIODE",
						"type": "varchar"
					},
					{
						"name": "VALUE",
						"type": "float",
						"precision": 15
					},
					{
						"name": "VERSION",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "KONSEBENE",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "200_STG",
					"table": "F_FINANCIAL_DATA"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_KTO')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "WorkspaceID",
						"type": "nvarchar"
					},
					{
						"name": "ReportElementID",
						"type": "nvarchar"
					},
					{
						"name": "AccountName",
						"type": "nvarchar"
					},
					{
						"name": "SourceAccountID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "ChildIndex",
						"type": "int",
						"precision": 10
					},
					{
						"name": "PeriodType",
						"type": "nvarchar"
					},
					{
						"name": "BalanceType",
						"type": "nvarchar"
					},
					{
						"name": "TransactionTypeCategoryID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "IsFormula",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "IsTotalLine",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "IsTimeSeries",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "IsSeparatorLine",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "GeneralLedgerAccount",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "PermittedUsersForAccount",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel1ID",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel1",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel1CI",
						"type": "int",
						"precision": 10
					},
					{
						"name": "AccountLevel2ID",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel2",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel2CI",
						"type": "int",
						"precision": 10
					},
					{
						"name": "AccountLevel3ID",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel3",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel3CI",
						"type": "int",
						"precision": 10
					},
					{
						"name": "AccountLevel4ID",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel4",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel4CI",
						"type": "int",
						"precision": 10
					},
					{
						"name": "AccountLevel5ID",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel5",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel5CI",
						"type": "int",
						"precision": 10
					},
					{
						"name": "AccountLevel6ID",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel6",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel6CI",
						"type": "int",
						"precision": 10
					},
					{
						"name": "AccountLevel7ID",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel7",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel7CI",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "200_STG",
					"table": "D_FINANCIAL_ACCOUNTS"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_PERSONELL_BUDGET_TMP')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "COMPANY",
						"type": "nvarchar"
					},
					{
						"name": "FUNCTION",
						"type": "nvarchar"
					},
					{
						"name": "PERIOD",
						"type": "nvarchar"
					},
					{
						"name": "Churn",
						"type": "decimal",
						"precision": 16,
						"scale": 2
					},
					{
						"name": "Endbestand",
						"type": "decimal",
						"precision": 16,
						"scale": 2
					},
					{
						"name": "New-Joiner",
						"type": "decimal",
						"precision": 16,
						"scale": 2
					},
					{
						"name": "AB",
						"type": "decimal",
						"precision": 16,
						"scale": 2
					}
				],
				"typeProperties": {
					"schema": "200_STG",
					"table": "F_PERSONELL_BUDGET_TMP"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_Personell_Budget')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "COMPANY",
						"type": "nvarchar"
					},
					{
						"name": "KPI",
						"type": "nvarchar"
					},
					{
						"name": "FUNCTION",
						"type": "nvarchar"
					},
					{
						"name": "PERIOD",
						"type": "nvarchar"
					},
					{
						"name": "BUDGET_VALUE",
						"type": "decimal",
						"precision": 10,
						"scale": 0
					}
				],
				"typeProperties": {
					"schema": "200_STG",
					"table": "F_PERSONELL_BUDGET"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_Personio_Data')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "STATUS",
						"type": "varchar"
					},
					{
						"name": "ID",
						"type": "varchar"
					},
					{
						"name": "MAILADDRESS",
						"type": "varchar"
					},
					{
						"name": "FIRSTNAME",
						"type": "varchar"
					},
					{
						"name": "LASTNAME",
						"type": "varchar"
					},
					{
						"name": "DEPARTMENT",
						"type": "varchar"
					},
					{
						"name": "AGE",
						"type": "decimal",
						"precision": 27,
						"scale": 4
					},
					{
						"name": "HIRED_AS",
						"type": "varchar"
					},
					{
						"name": "HIRE_DATE",
						"type": "date"
					},
					{
						"name": "EMPLOYMENT_TYPE",
						"type": "varchar"
					},
					{
						"name": "EMPLOYEE_GROUPS_BY_FUNCTION",
						"type": "varchar"
					},
					{
						"name": "EXIT_TYPE",
						"type": "varchar"
					},
					{
						"name": "EXIT_TYPE_2",
						"type": "varchar"
					},
					{
						"name": "LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD",
						"type": "date"
					},
					{
						"name": "PLACE_OF_BUSINESS",
						"type": "varchar"
					},
					{
						"name": "LENGTH_OF_EMPLOYMENT_IN_YEARS",
						"type": "decimal",
						"precision": 27,
						"scale": 4
					},
					{
						"name": "ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD",
						"type": "date"
					},
					{
						"name": "END_OF_EMPLOYMENT",
						"type": "date"
					},
					{
						"name": "FIRST_ENTRY_DATE",
						"type": "date"
					},
					{
						"name": "FTE",
						"type": "decimal",
						"precision": 27,
						"scale": 4
					},
					{
						"name": "GENDER",
						"type": "varchar"
					},
					{
						"name": "COMPANY",
						"type": "varchar"
					},
					{
						"name": "DEGREE_OF_SEVERE_DISABILITY",
						"type": "varchar"
					},
					{
						"name": "COST_CENTRE",
						"type": "varchar"
					},
					{
						"name": "TERMINATION_DATE",
						"type": "date"
					},
					{
						"name": "REASON_FOR_TERMINATION",
						"type": "varchar"
					},
					{
						"name": "NUMBER_OF_EMPLOYEES_STATUS_ACTIVE_AND_TIME_OFF",
						"type": "decimal",
						"precision": 27,
						"scale": 4
					},
					{
						"name": "DATEV_PERSONNEL_NUMBER",
						"type": "varchar"
					},
					{
						"name": "POSITION",
						"type": "varchar"
					},
					{
						"name": "WEEKLY_HOURS",
						"type": "decimal",
						"precision": 27,
						"scale": 4
					},
					{
						"name": "LOAD_PERIOD",
						"type": "varchar"
					},
					{
						"name": "LOAD_TIME",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "BAD_CHURN",
						"type": "varchar"
					},
					{
						"name": "ACCIDENT_AT_WORK",
						"type": "varchar"
					},
					{
						"name": "WORKRELATED_DEATH",
						"type": "varchar"
					},
					{
						"name": "COMPANY_KEY",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "200_STG",
					"table": "F_PERSONIO_DATA"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_STG_SAE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Datasets - PERSONIO API DATA"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "200_STG",
					"table": "SAE_API_EMPLOYEES"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_STG_SEE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "200_STG",
					"table": "SEE_EXCELEMPLOYEE"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_STG_SEM')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "SEM_ID",
						"type": "nvarchar"
					},
					{
						"name": "SEM_SID",
						"type": "nvarchar"
					},
					{
						"name": "SEM_VALID_FROM",
						"type": "date"
					},
					{
						"name": "SEM_VALID_TO",
						"type": "date"
					},
					{
						"name": "SEM_COST_CENTRE",
						"type": "nvarchar"
					},
					{
						"name": "SEM_COST_CENTER_NAME",
						"type": "nvarchar"
					},
					{
						"name": "SEM_COST_CENTER_WEIGHT",
						"type": "int",
						"precision": 10
					},
					{
						"name": "SEM_DEPARTMENT",
						"type": "nvarchar"
					},
					{
						"name": "SEM_FIRST_ENTRY_DATE",
						"type": "date"
					},
					{
						"name": "SEM_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD",
						"type": "date"
					},
					{
						"name": "SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD",
						"type": "date"
					},
					{
						"name": "SEM_HIRED_AS",
						"type": "nvarchar"
					},
					{
						"name": "SEM_EMPLOYEE_GROUPS_BY_FUNCTION",
						"type": "nvarchar"
					},
					{
						"name": "SEM_MAILADDRESS",
						"type": "nvarchar"
					},
					{
						"name": "SEM_FTE",
						"type": "nvarchar"
					},
					{
						"name": "SEM_GENDER",
						"type": "nvarchar"
					},
					{
						"name": "SEM_POSITION",
						"type": "nvarchar"
					},
					{
						"name": "SEM_COMPANY",
						"type": "nvarchar"
					},
					{
						"name": "SEM_EXIT_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "SEM_WEEKLY_HOURS",
						"type": "nvarchar"
					},
					{
						"name": "SEM_UPLOAD_DATE",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "SEM_FIRSTNAME",
						"type": "nvarchar"
					},
					{
						"name": "SEM_LASTNAME",
						"type": "nvarchar"
					},
					{
						"name": "SEM_PLACE_OF_BUSINESS",
						"type": "nvarchar"
					},
					{
						"name": "SEM_DEGREE_OF_SEVERE_DISABILITY",
						"type": "nvarchar"
					},
					{
						"name": "SEM_DATE_OF_BIRTH",
						"type": "nvarchar"
					},
					{
						"name": "SEM_BAD_CHURN",
						"type": "nvarchar"
					},
					{
						"name": "SEM_LOAD_PERIOD",
						"type": "nvarchar"
					},
					{
						"name": "SEM_AGE",
						"type": "int",
						"precision": 10
					},
					{
						"name": "SEM_TENURE",
						"type": "int",
						"precision": 10
					},
					{
						"name": "SEM_START_ACCIDENT_DATE",
						"type": "nvarchar"
					},
					{
						"name": "SEM_COMPANY_KEY",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "200_STG",
					"table": "SEM_EMPLOYEES_MERGED"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_STG_SML')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "200_STG",
					"table": "SML_MINLOADPERSONIO"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_TRANSLATIONS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "Bereich",
						"type": "nvarchar"
					},
					{
						"name": "Deutsch",
						"type": "nvarchar"
					},
					{
						"name": "Deutsch_kurz",
						"type": "nvarchar"
					},
					{
						"name": "Englisch",
						"type": "nvarchar"
					},
					{
						"name": "für PowerBi ",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "200_STG",
					"table": "TRANSLATIONS"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_Companies')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "GES",
						"type": "nvarchar"
					},
					{
						"name": "GES_BEZ",
						"type": "nvarchar"
					},
					{
						"name": "GES_MAPPING_CRM",
						"type": "nvarchar"
					},
					{
						"name": "COMPANY_BU",
						"type": "nvarchar"
					},
					{
						"name": "GES_MAPPING_CRM_SHORT",
						"type": "nvarchar"
					},
					{
						"name": "GES_LUCANET",
						"type": "nvarchar"
					},
					{
						"name": "BRAND_ID",
						"type": "nchar"
					}
				],
				"typeProperties": {
					"schema": "400_DWH",
					"table": "D_COMPANIES"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_DWH_FAP')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Datasets - PERSONIO API DATA"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "400_DWH",
					"table": "FAP_PERSONELL_REPORT"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_Financial_Report')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "FR_PERIOD",
						"type": "varchar"
					},
					{
						"name": "FR_YEAR",
						"type": "varchar"
					},
					{
						"name": "FR_MONTH",
						"type": "varchar"
					},
					{
						"name": "FR_COMPANY",
						"type": "varchar"
					},
					{
						"name": "FR_BU",
						"type": "varchar"
					},
					{
						"name": "FR_ACCOUNT",
						"type": "varchar"
					},
					{
						"name": "FR_VALUE_ACT",
						"type": "decimal",
						"precision": 27,
						"scale": 4
					},
					{
						"name": "FR_VALUE_BUDGET",
						"type": "decimal",
						"precision": 27,
						"scale": 4
					},
					{
						"name": "FR_PERIODID",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "400_DWH",
					"table": "F_FINANCIAL_REPORT"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_PERSONELL_DATA')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "FPR_PERIOD",
						"type": "varchar"
					},
					{
						"name": "FPR_PERIOD_ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "FPR_YEAR",
						"type": "varchar"
					},
					{
						"name": "FPR_MONTH",
						"type": "varchar"
					},
					{
						"name": "FPR_GENDER",
						"type": "varchar"
					},
					{
						"name": "FPR_COMPANY",
						"type": "varchar"
					},
					{
						"name": "FPR_PLANT",
						"type": "varchar"
					},
					{
						"name": "FPR_BU",
						"type": "varchar"
					},
					{
						"name": "FPR_POSITION",
						"type": "varchar"
					},
					{
						"name": "FPR_PERMANENT_EMPLOYEE",
						"type": "varchar"
					},
					{
						"name": "FPR_DISABILITY",
						"type": "varchar"
					},
					{
						"name": "FPR_FUNCTION",
						"type": "varchar"
					},
					{
						"name": "FPR_OPERATIVE",
						"type": "varchar"
					},
					{
						"name": "FPR_AGE",
						"type": "int",
						"precision": 10
					},
					{
						"name": "FPR_TENURE",
						"type": "int",
						"precision": 10
					},
					{
						"name": "FPR_COSTCENTRE",
						"type": "varchar"
					},
					{
						"name": "FPR_HC_EMPLOYEES_START_PERIOD",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_HC_EMPLOYEES_END_PERIOD",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_HC_NEW_HIRES",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_HC_LEAVERS",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_FTE_EMPLOYEES_START_PERIOD",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_FTE_EMPLOYEES_END_PERIOD",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_FTE_NEW_HIRES",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_FTE_LEAVERS",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_HC_CHURN",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_BAD_CHURN",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_PERMANENT_EMPLOYEES_FLAG",
						"type": "bit"
					},
					{
						"name": "FPR_WORK_REL_INURIES",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_WORK_REL_FATALITIES",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_DISABLED_EMPLOYEES_HC",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_DISABLED_EMPLOYEES_FTE",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_PERIOD_DATE",
						"type": "date"
					},
					{
						"name": "FPR_EXIT_TYPE",
						"type": "varchar"
					},
					{
						"name": "FPR_HC_EMPLOYEES_START_PERIOD_INCL_GROUPCHANGE",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_FTE_EMPLOYEES_START_PERIOD_INCL_GROUPCHANGE",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_HC_NEW_HIRES_GROUPCHANGE",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_HC_LEAVERS_GROUPCHANGE",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_FTE_NEW_HIRES_GROUPCHANGE",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_FTE_LEAVERS_GROUPCHANGE",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_GROUPCHANGE",
						"type": "bit"
					},
					{
						"name": "FPR_HC_EMPLOYEES_END_PERIOD_INCL_GROUPCHANGE",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "FPR_FTE_EMPLOYEES_END_PERIOD_INCL_GROUPCHANGE",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "400_DWH",
					"table": "F_PERSONELL_REPORT"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_Personell_Budget')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "COMPANY",
						"type": "nvarchar"
					},
					{
						"name": "KPI",
						"type": "nvarchar"
					},
					{
						"name": "FUNCTION",
						"type": "nvarchar"
					},
					{
						"name": "PERIOD",
						"type": "nvarchar"
					},
					{
						"name": "BUDGET_HC",
						"type": "decimal",
						"precision": 27,
						"scale": 4
					},
					{
						"name": "BUDGET_FTE",
						"type": "decimal",
						"precision": 27,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "400_DWH",
					"table": "F_PERSONELL_BUDGET"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_TRANSLATION')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "DATAAREA",
						"type": "nvarchar"
					},
					{
						"name": "SRC_VALUE",
						"type": "nvarchar"
					},
					{
						"name": "TRANSLATION",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "400_DWH",
					"table": "TRANSLATIONS"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSQL_Account')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureSqlDatabaseLucanet",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "WorkspaceID",
						"type": "nvarchar"
					},
					{
						"name": "ReportElementID",
						"type": "nvarchar"
					},
					{
						"name": "AccountName",
						"type": "nvarchar"
					},
					{
						"name": "SourceAccountID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "ChildIndex",
						"type": "int",
						"precision": 10
					},
					{
						"name": "PeriodType",
						"type": "nvarchar"
					},
					{
						"name": "BalanceType",
						"type": "nvarchar"
					},
					{
						"name": "TransactionTypeCategoryID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "IsFormula",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "IsTotalLine",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "IsTimeSeries",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "IsSeparatorLine",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "GeneralLedgerAccount",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "PermittedUsersForAccount",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel1ID",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel1",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel1CI",
						"type": "int",
						"precision": 10
					},
					{
						"name": "AccountLevel2ID",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel2",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel2CI",
						"type": "int",
						"precision": 10
					},
					{
						"name": "AccountLevel3ID",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel3",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel3CI",
						"type": "int",
						"precision": 10
					},
					{
						"name": "AccountLevel4ID",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel4",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel4CI",
						"type": "int",
						"precision": 10
					},
					{
						"name": "AccountLevel5ID",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel5",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel5CI",
						"type": "int",
						"precision": 10
					},
					{
						"name": "AccountLevel6ID",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel6",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel6CI",
						"type": "int",
						"precision": 10
					},
					{
						"name": "AccountLevel7ID",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel7",
						"type": "nvarchar"
					},
					{
						"name": "AccountLevel7CI",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "AccountStructure"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureSqlDatabaseLucanet')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSqlAccount')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "200_STG",
					"table": "D_FINANCIAL_ACCOUNTS"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSqlCompanyBU')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "200_STG",
					"table": "D_COMPANY_BU"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSqlLucanetCompanies')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureSqlDatabaseLucanet",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "AccountingOrConsolidationArea",
						"type": "nvarchar"
					},
					{
						"name": "OrganisationElementID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "OrganisationElementName",
						"type": "nvarchar"
					},
					{
						"name": "OrganisationElementChildIndex",
						"type": "int",
						"precision": 10
					},
					{
						"name": "SourceType",
						"type": "nvarchar"
					},
					{
						"name": "ReportingEntityID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "DefaultTransactionCurrency",
						"type": "nvarchar"
					},
					{
						"name": "PermittedUsersForElement",
						"type": "nvarchar"
					},
					{
						"name": "OrganisationLevel1ID",
						"type": "nvarchar"
					},
					{
						"name": "OrganisationLevel1",
						"type": "nvarchar"
					},
					{
						"name": "OrganisationLevel1CI",
						"type": "int",
						"precision": 10
					},
					{
						"name": "OrganisationLevel2ID",
						"type": "nvarchar"
					},
					{
						"name": "OrganisationLevel2",
						"type": "nvarchar"
					},
					{
						"name": "OrganisationLevel2CI",
						"type": "int",
						"precision": 10
					},
					{
						"name": "OrganisationLevel3ID",
						"type": "nvarchar"
					},
					{
						"name": "OrganisationLevel3",
						"type": "nvarchar"
					},
					{
						"name": "OrganisationLevel3CI",
						"type": "int",
						"precision": 10
					},
					{
						"name": "OrganisationLevel4ID",
						"type": "nvarchar"
					},
					{
						"name": "OrganisationLevel4",
						"type": "nvarchar"
					},
					{
						"name": "OrganisationLevel4CI",
						"type": "int",
						"precision": 10
					},
					{
						"name": "OrganisationLevel5ID",
						"type": "nvarchar"
					},
					{
						"name": "OrganisationLevel5",
						"type": "nvarchar"
					},
					{
						"name": "OrganisationLevel5CI",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "OrganisationStructure"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureSqlDatabaseLucanet')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSqlTEMPDB')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "TEMPDB"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSqlTable1')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "TEST",
					"table": "FEB_PERSONELL_REPORT"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSqlTable3')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSqlTable4')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "employee_id",
						"type": "int",
						"precision": 10
					},
					{
						"name": "attribute_id",
						"type": "nvarchar"
					},
					{
						"name": "cost_center_id",
						"type": "int",
						"precision": 10
					},
					{
						"name": "cost_center_name",
						"type": "nvarchar"
					},
					{
						"name": "cost_center_weight",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "data_type",
						"type": "nvarchar"
					},
					{
						"name": "effective_date",
						"type": "date"
					},
					{
						"name": "entity_id",
						"type": "int",
						"precision": 10
					},
					{
						"name": "value",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "200_STG",
					"table": "Personio_api_data"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSqlTable5')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "150_STG",
					"table": "PERSONIO_API"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSqlTable6')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "150_STG",
					"table": "PERSONIO_API"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSqlTable9')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "200_STG",
					"table": "BUDGET2024"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Budget_CSV')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureHRBlobStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "HR-Planung 2023_Daten.csv",
						"folderPath": "Planung",
						"container": "hrreporting"
					},
					"columnDelimiter": ";",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "Gesellschaft",
						"type": "String"
					},
					{
						"name": "Kennzahl",
						"type": "String"
					},
					{
						"name": "Funktionsgruppe",
						"type": "String"
					},
					{
						"name": "202301",
						"type": "String"
					},
					{
						"name": "202302",
						"type": "String"
					},
					{
						"name": "202303",
						"type": "String"
					},
					{
						"name": "202304",
						"type": "String"
					},
					{
						"name": "202305",
						"type": "String"
					},
					{
						"name": "202306",
						"type": "String"
					},
					{
						"name": "202307",
						"type": "String"
					},
					{
						"name": "202308",
						"type": "String"
					},
					{
						"name": "202309",
						"type": "String"
					},
					{
						"name": "202310",
						"type": "String"
					},
					{
						"name": "202311",
						"type": "String"
					},
					{
						"name": "202312",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureHRBlobStorage')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CSV_BUDGET_NET_NEW_HIRES24')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureHRBlobStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "HR - Netto Neueinstellungen 2024.csv",
						"folderPath": "Planung",
						"container": "hrreporting"
					},
					"columnDelimiter": ";",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "Gesellschaft;Kennzahl;Funktionsgruppe;01.01.2024;01.02.2024;01.03.2024;01.04.2024;01.05.2024;01.06.2024;01.07.2024;01.08.2024;01.09.2024;01.10.2024;01.11.2024;01.12.2024",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureHRBlobStorage')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CompanyMapping')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureHRBlobStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Excel",
				"typeProperties": {
					"sheetName": "Tabelle1",
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "CompanyMapping.xlsx",
						"folderPath": "Übersetzungen",
						"container": "hrreporting"
					},
					"firstRowAsHeader": true
				},
				"schema": [
					{
						"name": "Gesellschaft",
						"type": "String"
					},
					{
						"name": "Kürzel",
						"type": "String"
					},
					{
						"name": "gültig bis",
						"type": "String"
					},
					{
						"name": "gültig ab",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureHRBlobStorage')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/D_PERIOD')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "HR_REPORT_DB",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "DP_PERIOD_ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DP_PERIOD",
						"type": "varchar"
					},
					{
						"name": "DP_START_DATE",
						"type": "date"
					},
					{
						"name": "DP_END_DATE",
						"type": "date"
					}
				],
				"typeProperties": {
					"schema": "400_DWH",
					"table": "D_PERIOD"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/HR_REPORT_DB')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DelimitedText1')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureHRBlobStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "HR - Netto Neueinstellungen 2023.csv",
						"folderPath": "Planung",
						"container": "hrreporting"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "Gesellschaft;Kennzahl;Funktionsgruppe;01.01.2024;01.02.2024;01.03.2024;01.04.2024;01.05.2024;01.06.2024;01.07.2024;01.08.2024;01.09.2024;01.10.2024;01.11.2024;01.12.2024",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureHRBlobStorage')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DelimitedText2')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureHRBlobStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "Test Data",
						"folderPath": "Personio",
						"container": "hrreporting"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureHRBlobStorage')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Excel_Translations')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureHRBlobStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Excel",
				"typeProperties": {
					"sheetName": "Tabelle1",
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "Jobfunctions HR Reporting.xlsx",
						"folderPath": "Übersetzungen",
						"container": "hrreporting"
					},
					"firstRowAsHeader": true
				},
				"schema": [
					{
						"name": "Bereich",
						"type": "String"
					},
					{
						"name": "Deutsch",
						"type": "String"
					},
					{
						"name": "Deutsch",
						"type": "String"
					},
					{
						"name": "Englisch",
						"type": "String"
					},
					{
						"name": "für PowerBi ",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureHRBlobStorage')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/FINREP_FINREPORT')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Azure_FinReport",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "GES",
						"type": "varchar"
					},
					{
						"name": "KTO",
						"type": "varchar"
					},
					{
						"name": "JAHR",
						"type": "varchar"
					},
					{
						"name": "MONAT",
						"type": "varchar"
					},
					{
						"name": "PERIODE",
						"type": "varchar"
					},
					{
						"name": "SALDO",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "SALDO_YTD",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "BUDGET",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "BUDGET_YTD",
						"type": "decimal",
						"precision": 18,
						"scale": 4
					},
					{
						"name": "KTO_ID",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "F_FINREPORT"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Azure_FinReport')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/FinRepCompanies')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Azure_FinReport",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "GES",
						"type": "nvarchar"
					},
					{
						"name": "GES_BEZ",
						"type": "nvarchar"
					},
					{
						"name": "PNLSHEET",
						"type": "nvarchar"
					},
					{
						"name": "GES_MAPPING_CRM",
						"type": "nvarchar"
					},
					{
						"name": "COMPANY_BU",
						"type": "nvarchar"
					},
					{
						"name": "GES_MAPPING_CRM_SHORT",
						"type": "nvarchar"
					},
					{
						"name": "GES_LUCANET",
						"type": "nvarchar"
					},
					{
						"name": "BRAND_ID",
						"type": "nchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "D_GES"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Azure_FinReport')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/FinancialDataLucanetXLSX')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureHRBlobStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Excel",
				"typeProperties": {
					"sheetName": "Subsidiaries Overview per month",
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "Financial Reporting Data_LN.xlsx",
						"folderPath": "Financials",
						"container": "hrreporting"
					},
					"range": "D8:AC500",
					"firstRowAsHeader": true
				},
				"schema": [
					{
						"name": "Gesellschaft",
						"type": "String"
					},
					{
						"name": "Konto",
						"type": "String"
					},
					{
						"name": "2022-01-31",
						"type": "String"
					},
					{
						"name": "2022-02-28",
						"type": "String"
					},
					{
						"name": "2022-03-31",
						"type": "String"
					},
					{
						"name": "2022-04-30",
						"type": "String"
					},
					{
						"name": "2022-05-31",
						"type": "String"
					},
					{
						"name": "2022-06-30",
						"type": "String"
					},
					{
						"name": "2022-07-31",
						"type": "String"
					},
					{
						"name": "2022-08-31",
						"type": "String"
					},
					{
						"name": "2022-09-30",
						"type": "String"
					},
					{
						"name": "2022-10-31",
						"type": "String"
					},
					{
						"name": "2022-11-30",
						"type": "String"
					},
					{
						"name": "2022-12-31",
						"type": "String"
					},
					{
						"name": "2023-01-31",
						"type": "String"
					},
					{
						"name": "2023-02-28",
						"type": "String"
					},
					{
						"name": "2023-03-31",
						"type": "String"
					},
					{
						"name": "2023-04-30",
						"type": "String"
					},
					{
						"name": "2023-05-31",
						"type": "String"
					},
					{
						"name": "2023-06-30",
						"type": "String"
					},
					{
						"name": "2023-07-31",
						"type": "String"
					},
					{
						"name": "2023-08-31",
						"type": "String"
					},
					{
						"name": "2023-09-30",
						"type": "String"
					},
					{
						"name": "2023-10-31",
						"type": "String"
					},
					{
						"name": "2023-11-30",
						"type": "String"
					},
					{
						"name": "2023-12-31",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureHRBlobStorage')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/JSON_PersonioAPI')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureHRBlobStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "JSON_PERSONIOAPI",
						"folderPath": "Personio",
						"container": "hrreporting"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureHRBlobStorage')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/JSON_standard_Api')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureHRBlobStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "JSON_STANDARDAPI",
						"folderPath": "Personio",
						"container": "hrreporting"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureHRBlobStorage')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Json1')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureHRBlobStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "JSON_PERSONIOAPI",
						"folderPath": "Personio",
						"container": "hrreporting"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"success": {
							"type": "boolean"
						},
						"metadata": {
							"type": "object",
							"properties": {
								"total_elements": {
									"type": "integer"
								},
								"current_page": {
									"type": "integer"
								},
								"total_pages": {
									"type": "integer"
								}
							}
						},
						"offset": {
							"type": "integer"
						},
						"limit": {
							"type": "integer"
						},
						"data": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"type": {
										"type": "string"
									},
									"attributes": {
										"type": "object",
										"properties": {
											"id": {
												"type": "string"
											},
											"name": {
												"type": "string"
											},
											"description": {
												"type": "string"
											},
											"author_first_name": {
												"type": "string"
											},
											"author_last_name": {
												"type": "string"
											},
											"type": {
												"type": "string"
											},
											"status": {
												"type": "string"
											},
											"start_date": {
												"type": "string"
											},
											"end_date": {
												"type": "string"
											},
											"created_at": {
												"type": "string"
											},
											"updated_at": {
												"type": "string"
											},
											"data_refreshed_at": {
												"type": "string"
											},
											"columns": {
												"type": "array",
												"items": {
													"type": "string"
												}
											},
											"filters": {
												"type": "array"
											},
											"period_type": {
												"type": "string"
											},
											"items": {
												"type": "array",
												"items": {
													"type": "object",
													"properties": {
														"employee_id": {
															"type": "integer"
														},
														"historical_attributes": {
															"type": "array",
															"items": {
																"type": "object",
																"properties": {
																	"attribute_id": {
																		"type": "string"
																	},
																	"data_type": {
																		"type": "string"
																	},
																	"effective_date": {
																		"type": "string"
																	},
																	"employee_id": {
																		"type": "integer"
																	},
																	"value": {
																		"type": "string"
																	}
																}
															}
														}
													}
												}
											},
											"archival_status": {
												"type": "string"
											},
											"archived_at": {
												"type": "null"
											}
										}
									}
								}
							}
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureHRBlobStorage')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Json2')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureHRBlobStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "JSON_PERSONIOAPI",
						"folderPath": "Personio",
						"container": "hrreporting"
					}
				},
				"schema": {
					"type": "object",
					"properties": {
						"success": {
							"type": "boolean"
						},
						"metadata": {
							"type": "object",
							"properties": {
								"total_elements": {
									"type": "integer"
								},
								"current_page": {
									"type": "integer"
								},
								"total_pages": {
									"type": "integer"
								}
							}
						},
						"offset": {
							"type": "integer"
						},
						"limit": {
							"type": "integer"
						},
						"data": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"type": {
										"type": "string"
									},
									"attributes": {
										"type": "object",
										"properties": {
											"id": {
												"type": "string"
											},
											"name": {
												"type": "string"
											},
											"description": {
												"type": "string"
											},
											"author_first_name": {
												"type": "string"
											},
											"author_last_name": {
												"type": "string"
											},
											"type": {
												"type": "string"
											},
											"status": {
												"type": "string"
											},
											"start_date": {
												"type": "string"
											},
											"end_date": {
												"type": "string"
											},
											"created_at": {
												"type": "string"
											},
											"updated_at": {
												"type": "string"
											},
											"data_refreshed_at": {
												"type": "string"
											},
											"columns": {
												"type": "array",
												"items": {
													"type": "string"
												}
											},
											"filters": {
												"type": "array"
											},
											"period_type": {
												"type": "string"
											},
											"items": {
												"type": "array",
												"items": {
													"type": "object",
													"properties": {
														"employee_id": {
															"type": "integer"
														},
														"historical_attributes": {
															"type": "array",
															"items": {
																"type": "object",
																"properties": {
																	"attribute_id": {
																		"type": "string"
																	},
																	"data_type": {
																		"type": "string"
																	},
																	"effective_date": {
																		"type": "string"
																	},
																	"employee_id": {
																		"type": "integer"
																	},
																	"value": {
																		"type": "string"
																	}
																}
															}
														}
													}
												}
											},
											"archival_status": {
												"type": "string"
											},
											"archived_at": {
												"type": "null"
											}
										}
									}
								}
							}
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureHRBlobStorage')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/LucanetSQL_Data')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureSqlDatabaseLucanet",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "DataLevelID",
						"type": "bigint",
						"precision": 19
					},
					{
						"name": "DataLevelName",
						"type": "nvarchar"
					},
					{
						"name": "DataLevelType",
						"type": "nvarchar"
					},
					{
						"name": "PeriodFrom",
						"type": "nvarchar"
					},
					{
						"name": "PeriodTo",
						"type": "nvarchar"
					},
					{
						"name": "IsClosed",
						"type": "smallint",
						"precision": 5
					},
					{
						"name": "IsArchived",
						"type": "smallint",
						"precision": 5
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "Facts"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureSqlDatabaseLucanet')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Merge_Employees')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureHRBlobStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Excel",
				"typeProperties": {
					"sheetName": "Tabelle1",
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "Merged_Employees.xlsx",
						"folderPath": "Übersetzungen",
						"container": "hrreporting"
					},
					"firstRowAsHeader": true
				},
				"schema": [
					{
						"name": "LOAD_PERIOD",
						"type": "String"
					},
					{
						"name": "ID",
						"type": "String"
					},
					{
						"name": "EXIT_TYPE",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureHRBlobStorage')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PersonioASCII')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureHRBlobStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": "Personio/aktueller_Monat",
						"container": "hrreporting"
					},
					"columnDelimiter": ";",
					"encodingName": "UTF-8",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "Status",
						"type": "String"
					},
					{
						"name": "ID",
						"type": "String"
					},
					{
						"name": "E-Mail",
						"type": "String"
					},
					{
						"name": "Nachname (bürgerlich)",
						"type": "String"
					},
					{
						"name": "Vorname (bürgerlich)",
						"type": "String"
					},
					{
						"name": "Abteilung",
						"type": "String"
					},
					{
						"name": "Alter",
						"type": "String"
					},
					{
						"name": "Angestellt als",
						"type": "String"
					},
					{
						"name": "Anstelldatum",
						"type": "String"
					},
					{
						"name": "Anstellungsart",
						"type": "String"
					},
					{
						"name": "Mitarbeitergruppen nach Funktion",
						"type": "String"
					},
					{
						"name": "Austrittsart11",
						"type": "String"
					},
					{
						"name": "Austrittsart12",
						"type": "String"
					},
					{
						"name": "Austrittsdatum (aktueller Beschäftigungszeitraum)",
						"type": "String"
					},
					{
						"name": "Betriebsstätte",
						"type": "String"
					},
					{
						"name": "Betriebszugehörigkeit (in Jahren)",
						"type": "String"
					},
					{
						"name": "Eintrittsdatum (aktueller Beschäftigungszeitraum)",
						"type": "String"
					},
					{
						"name": "Ende des Arbeitsverhältnisses",
						"type": "String"
					},
					{
						"name": "Ersteintrittsdatum",
						"type": "String"
					},
					{
						"name": "FTE",
						"type": "String"
					},
					{
						"name": "Geschlecht",
						"type": "String"
					},
					{
						"name": "Gesellschaft",
						"type": "String"
					},
					{
						"name": "Grad der Behinderung",
						"type": "String"
					},
					{
						"name": "Kostenstelle",
						"type": "String"
					},
					{
						"name": "Kündigung (Datum)",
						"type": "String"
					},
					{
						"name": "Kündigungsgrund",
						"type": "String"
					},
					{
						"name": "Mitarbeitendenzahl (Status „Aktiv“ und „Auszeit“)",
						"type": "String"
					},
					{
						"name": "DATEV Personalnummer",
						"type": "String"
					},
					{
						"name": "Position",
						"type": "String"
					},
					{
						"name": "Wochenstunden",
						"type": "String"
					},
					{
						"name": "Bad Churn",
						"type": "String"
					},
					{
						"name": "Arbeits- und Wegeunfall / Work and Commute-related Accidents – genommen (Tage)",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureHRBlobStorage')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PersonioASCII_bis_202301')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureHRBlobStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "Data_2022_08.csv",
						"folderPath": "Personio/Schnittstelle_vor_Personio",
						"container": "hrreporting"
					},
					"columnDelimiter": ";",
					"encodingName": "UTF-8",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "Status",
						"type": "String"
					},
					{
						"name": "ID",
						"type": "String"
					},
					{
						"name": "E-Mail",
						"type": "String"
					},
					{
						"name": "Name",
						"type": "String"
					},
					{
						"name": " Vorname",
						"type": "String"
					},
					{
						"name": "Abteilung",
						"type": "String"
					},
					{
						"name": "Alter",
						"type": "String"
					},
					{
						"name": "Mitarbeitergruppen nach Anstellungsart",
						"type": "String"
					},
					{
						"name": "Anstellungsdatum",
						"type": "String"
					},
					{
						"name": "Anstellungsart",
						"type": "String"
					},
					{
						"name": "Mitarbeitergruppen nach Funktion",
						"type": "String"
					},
					{
						"name": "Austrittsart11",
						"type": "String"
					},
					{
						"name": "Austrittsart12",
						"type": "String"
					},
					{
						"name": "Austrittsdatum (aktueller Beschäftigungszeitraum)",
						"type": "String"
					},
					{
						"name": "Betriebsstätte",
						"type": "String"
					},
					{
						"name": "Betriebszugehörigkeit (in Jahren)",
						"type": "String"
					},
					{
						"name": "Eintrittsdatum (aktueller Beschäftigungszeitraum)",
						"type": "String"
					},
					{
						"name": "Ende des Arbeitsverhältnisses",
						"type": "String"
					},
					{
						"name": "Ersteintrittsdatum",
						"type": "String"
					},
					{
						"name": "FTE",
						"type": "String"
					},
					{
						"name": "Geschlecht",
						"type": "String"
					},
					{
						"name": "Gesellschaft",
						"type": "String"
					},
					{
						"name": "Grad der Schwerbehinderung",
						"type": "String"
					},
					{
						"name": "Kostenstelle",
						"type": "String"
					},
					{
						"name": "Kündigung (Datum)",
						"type": "String"
					},
					{
						"name": "Kündigungsgrund",
						"type": "String"
					},
					{
						"name": "Mitarbeiterzahl (Status „Aktiv“ und „Auszeit“)",
						"type": "String"
					},
					{
						"name": "DATEV Personalnummer",
						"type": "String"
					},
					{
						"name": "Position",
						"type": "String"
					},
					{
						"name": "Wochenstunden",
						"type": "String"
					},
					{
						"name": "Bad Churn",
						"type": "String"
					},
					{
						"name": "Arbeitsunfall",
						"type": "String"
					},
					{
						"name": "Arbeitsbedingter Todesfall",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureHRBlobStorage')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Personio_API_Data')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Personio Rest API",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Personio Rest API')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/RestResource_StandardApi')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "RestService_StandardApi",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/RestService_StandardApi')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SharepointCSV')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Sharepoint",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "HttpServerLocation",
						"relativeUrl": "/Data_2023_06.csv"
					},
					"columnDelimiter": ";",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Sharepoint')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureDatabricks HR Reporting')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureDatabricks",
				"typeProperties": {
					"domain": "https://adb-1391973356148503.3.azuredatabricks.net",
					"accessToken": {
						"type": "SecureString",
						"value": "[parameters('AzureDatabricks HR Reporting_accessToken')]"
					},
					"newClusterNodeType": "Standard_DS3_v2",
					"newClusterNumOfWorker": "1",
					"newClusterVersion": "10.4.x-scala2.12",
					"clusterOption": "Fixed",
					"newClusterInitScripts": []
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureHRBlobStorage')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('AzureHRBlobStorage_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSqlDatabaseLucanet')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('AzureSqlDatabaseLucanet_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Azure_FinReport')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('Azure_FinReport_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/HR_REPORT_DB')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('HR_REPORT_DB_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Personio Rest API')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('Personio Rest API_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/RestService_StandardApi')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('RestService_StandardApi_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Sharepoint')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "HttpServer",
				"typeProperties": {
					"url": "[parameters('Sharepoint_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Basic",
					"userName": "[parameters('Sharepoint_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('Sharepoint_password')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/temd')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureFunction",
				"typeProperties": {
					"functionAppUrl": "[parameters('temd_properties_typeProperties_functionAppUrl')]",
					"authentication": "Anonymous",
					"functionKey": {
						"type": "SecureString",
						"value": "[parameters('temd_functionKey')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/1xday')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "100 STG - 400 DWH FULL LOAD",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2025-10-21T07:30:00",
						"timeZone": "W. Europe Standard Time",
						"schedule": {
							"minutes": [
								0
							],
							"hours": [
								6
							]
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/100 STG - 400 DWH FULL LOAD')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/LucanetTrigger')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Import Lucanet",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Month",
						"interval": 1,
						"startTime": "2023-08-15T13:39:00Z",
						"timeZone": "UTC",
						"schedule": {
							"minutes": [
								0
							],
							"hours": [
								9,
								15
							],
							"monthDays": [
								29,
								30,
								31,
								28,
								27,
								26,
								25,
								24,
								23
							]
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/Import Lucanet')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/trigger2')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Import Lucanet",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Month",
						"interval": 1,
						"startTime": "2023-08-18T15:06:00Z",
						"timeZone": "UTC",
						"schedule": {
							"minutes": [
								0
							],
							"hours": [
								12
							],
							"monthDays": [
								1,
								2,
								3,
								4,
								23,
								24
							]
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/Import Lucanet')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_FINANCIAL_DATA_LUCANET_XLSX')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "FinancialDataLucanetXLSX",
								"type": "DatasetReference"
							},
							"name": "XLSX"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "200_Financial_Data",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "unpivot1"
						},
						{
							"name": "filter1"
						},
						{
							"name": "derivedColumn1"
						},
						{
							"name": "UpsertInsert"
						}
					],
					"scriptLines": [
						"source(output(",
						"          Gesellschaft as string,",
						"          Konto as string,",
						"          {2022-01-31} as double,",
						"          {2022-02-28} as double,",
						"          {2022-03-31} as double,",
						"          {2022-04-30} as double,",
						"          {2022-05-31} as double,",
						"          {2022-06-30} as double,",
						"          {2022-07-31} as double,",
						"          {2022-08-31} as double,",
						"          {2022-09-30} as double,",
						"          {2022-10-31} as double,",
						"          {2022-11-30} as double,",
						"          {2022-12-31} as double,",
						"          {2023-01-31} as double,",
						"          {2023-02-28} as double,",
						"          {2023-03-31} as double,",
						"          {2023-04-30} as double,",
						"          {2023-05-31} as double,",
						"          {2023-06-30} as double,",
						"          {2023-07-31} as double,",
						"          {2023-08-31} as double,",
						"          {2023-09-30} as double,",
						"          {2023-10-31} as double,",
						"          {2023-11-30} as double,",
						"          {2023-12-31} as double",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false) ~> XLSX",
						"XLSX unpivot(output(",
						"          PERIODE as string,",
						"          WERT as double",
						"     ),",
						"     ungroupBy(Gesellschaft,",
						"          Konto),",
						"     lateral: true,",
						"     ignoreNullPivots: false) ~> unpivot1",
						"unpivot1 filter(!isNull(Gesellschaft)) ~> filter1",
						"filter1 derive(Jahr = left(PERIODE, 4),",
						"          Monat = substring(PERIODE, 6, 2),",
						"          Perio = concat(left(PERIODE, 4), substring(PERIODE, 6, 2))) ~> derivedColumn1",
						"derivedColumn1 alterRow(upsertIf(true())) ~> UpsertInsert",
						"UpsertInsert sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          GES as string,",
						"          KTO as string,",
						"          PERIODE as string,",
						"          VALUE as double,",
						"          VERSION as long,",
						"          KONSEBENE as string",
						"     ),",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:false,",
						"     upsertable:true,",
						"     keys:['GES','KTO','PERIODE'],",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          GES = Gesellschaft,",
						"          KTO = Konto,",
						"          PERIODE = Perio,",
						"          VALUE = WERT",
						"     )) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/FinancialDataLucanetXLSX')]",
				"[concat(variables('factoryId'), '/datasets/200_Financial_Data')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_PERSONELL_BUDGET')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "CSV_BUDGET_NET_NEW_HIRES24",
								"type": "DatasetReference"
							},
							"name": "CSV"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "100_STG_PERS_BUDGET_24",
								"type": "DatasetReference"
							},
							"name": "personellbudget"
						}
					],
					"transformations": [
						{
							"name": "FilterLeerzeile"
						},
						{
							"name": "unpivotPerioden"
						},
						{
							"name": "derivedColumn2"
						},
						{
							"name": "derivedColumn3"
						}
					],
					"scriptLines": [
						"source(output(",
						"          Gesellschaft as string,",
						"          Kennzahl as string,",
						"          Funktionsgruppe as string,",
						"          {01.01.2024} as string,",
						"          {01.02.2024} as string,",
						"          {01.03.2024} as string,",
						"          {01.04.2024} as string,",
						"          {01.05.2024} as string,",
						"          {01.06.2024} as string,",
						"          {01.07.2024} as string,",
						"          {01.08.2024} as string,",
						"          {01.09.2024} as string,",
						"          {01.10.2024} as string,",
						"          {01.11.2024} as string,",
						"          {01.12.2024} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     preferredFractionalType: 'decimal') ~> CSV",
						"CSV filter(Gesellschaft != \"\") ~> FilterLeerzeile",
						"FilterLeerzeile unpivot(output(",
						"          Periode as string,",
						"          Wert as string",
						"     ),",
						"     ungroupBy(Gesellschaft,",
						"          Kennzahl,",
						"          Funktionsgruppe),",
						"     lateral: false,",
						"     ignoreNullPivots: false) ~> unpivotPerioden",
						"unpivotPerioden derive(WertN = replace(Wert, ',', '.')) ~> derivedColumn2",
						"derivedColumn2 derive(WertN2 = toDecimal(WertN)) ~> derivedColumn3",
						"derivedColumn3 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          COMPANY = Gesellschaft,",
						"          KPI = Kennzahl,",
						"          FUNCTION = Funktionsgruppe,",
						"          PERIOD = Periode,",
						"          BUDGET = WertN2",
						"     )) ~> personellbudget"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/CSV_BUDGET_NET_NEW_HIRES24')]",
				"[concat(variables('factoryId'), '/datasets/100_STG_PERS_BUDGET_24')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_PERSONIO_DATA')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "PersonioASCII",
								"type": "DatasetReference"
							},
							"name": "PersonioASCII",
							"description": "Daten aus PersonioASCII importieren"
						},
						{
							"dataset": {
								"referenceName": "200_CompanyTranslation",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "200_Personio_Data",
								"type": "DatasetReference"
							},
							"name": "Personio"
						}
					],
					"transformations": [
						{
							"name": "LOADDatum"
						},
						{
							"name": "filter1"
						},
						{
							"name": "abgSp"
						},
						{
							"name": "cast1"
						},
						{
							"name": "join1"
						}
					],
					"scriptLines": [
						"parameters{",
						"     PYear as string ('2025'),",
						"     PMonth as string ('05')",
						"}",
						"source(output(",
						"          Status as string,",
						"          ID as integer,",
						"          {E-Mail} as string,",
						"          {Nachname (bürgerlich)} as string,",
						"          {Vorname (bürgerlich)} as string,",
						"          Abteilung as string,",
						"          Alter as string,",
						"          {Angestellt als} as string,",
						"          Anstelldatum as string,",
						"          Anstellungsart as string,",
						"          {Mitarbeitergruppen nach Funktion} as string,",
						"          Austrittsart11 as string,",
						"          Austrittsart12 as string,",
						"          {Austrittsdatum (aktueller Beschäftigungszeitraum)} as string,",
						"          {Betriebsstätte} as string,",
						"          {Betriebszugehörigkeit (in Jahren)} as string,",
						"          {Eintrittsdatum (aktueller Beschäftigungszeitraum)} as string,",
						"          {Ende des Arbeitsverhältnisses} as string,",
						"          Ersteintrittsdatum as string,",
						"          FTE as string,",
						"          Geschlecht as string,",
						"          Gesellschaft as string,",
						"          {Grad der Behinderung} as string,",
						"          Kostenstelle as string,",
						"          {Kündigung (Datum)} as string,",
						"          {Kündigungsgrund} as string,",
						"          {Mitarbeitendenzahl (Status „Aktiv“ und „Auszeit“)} as string,",
						"          {DATEV Personalnummer} as string,",
						"          Position as string,",
						"          Wochenstunden as string,",
						"          {Bad Churn} as string,",
						"          {Arbeits- und Wegeunfall / Work and Commute-related Accidents – genommen (Tage)} as string,",
						"          {_c32} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     wildcardPaths:[(concat('Personio/aktueller_Monat/Data_', $PYear, '_', $PMonth, '.csv'))]) ~> PersonioASCII",
						"source(output(",
						"          COMPANY as string,",
						"          COMPANY_KEY as string,",
						"          VALID_TO as integer,",
						"          VALID_FROM as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source1",
						"cast1 derive(LoadDatum = currentTimestamp(),",
						"          LoadPeriode = concat($PYear, $PMonth),",
						"          Betriebszuge = toInteger({Betriebszugehörigkeit (in Jahren)})) ~> LOADDatum",
						"PersonioASCII filter(!isNull(Gesellschaft)) ~> filter1",
						"LOADDatum derive(vFTE = toDecimal(FTE, 27, 4, '#,##', 'de'),",
						"          Anstellungsdauer = toDecimal(Betriebszuge),",
						"          AktiveMA = toDecimal( {Mitarbeitendenzahl (Status „Aktiv“ und „Auszeit“)}, 27, 4, '#,##', 'de'),",
						"          WochenStd = toDecimal(Wochenstunden, 27, 4, '#,##', 'de'),",
						"          ArbUnf = iif(toInteger({Arbeits- und Wegeunfall / Work and Commute-related Accidents – genommen (Tage)}) > 0, 'Ja', toString(null())),",
						"          ABTodesfall = iif(Austrittsart11 == 'Arbeitsbedingter Todesfall', 'Ja', toString(null())),",
						"          Tenure_calculated = toInteger(round(minus(LoadDatum, toTimestamp(Ersteintrittsdatum, \"dd.MM.yyyy\")) / 1000 / 60 / 60 / 24 / 365.25, 0, 2))) ~> abgSp",
						"filter1 cast(output(",
						"          Alter as decimal(10,0) '000,000,000.000',",
						"          {Betriebszugehörigkeit (in Jahren)} as decimal(10,0) '000,000,000.000'",
						"     ),",
						"     errors: true) ~> cast1",
						"abgSp, source1 join(Gesellschaft == COMPANY,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join1",
						"join1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          STATUS as string,",
						"          ID as string,",
						"          MAILADDRESS as string,",
						"          FIRSTNAME as string,",
						"          LASTNAME as string,",
						"          DEPARTMENT as string,",
						"          AGE as decimal(27,4),",
						"          HIRED_AS as string,",
						"          HIRE_DATE as date,",
						"          EMPLOYMENT_TYPE as string,",
						"          EMPLOYEE_GROUPS_BY_FUNCTION as string,",
						"          EXIT_TYPE as string,",
						"          EXIT_TYPE_2 as string,",
						"          LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD as date,",
						"          PLACE_OF_BUSINESS as string,",
						"          LENGTH_OF_EMPLOYMENT_IN_YEARS as decimal(27,4),",
						"          ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD as date,",
						"          END_OF_EMPLOYMENT as date,",
						"          FIRST_ENTRY_DATE as date,",
						"          FTE as decimal(27,4),",
						"          GENDER as string,",
						"          COMPANY as string,",
						"          DEGREE_OF_SEVERE_DISABILITY as string,",
						"          COST_CENTRE as string,",
						"          TERMINATION_DATE as date,",
						"          REASON_FOR_TERMINATION as string,",
						"          NUMBER_OF_EMPLOYEES_STATUS_ACTIVE_AND_TIME_OFF as decimal(27,4),",
						"          DATEV_PERSONNEL_NUMBER as string,",
						"          POSITION as string,",
						"          WEEKLY_HOURS as decimal(27,4),",
						"          LOAD_PERIOD as string,",
						"          LOAD_TIME as timestamp,",
						"          BAD_CHURN as string,",
						"          ACCIDENT_AT_WORK as string,",
						"          WORKRELATED_DEATH as string,",
						"          COMPANY_KEY as string",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     preSQLs:[(concat('delete from [200_STG].[F_PERSONIO_DATA] WHERE [LOAD_PERIOD] = ', $PYear, $PMonth))],",
						"     dateFormat:'dd.MM.yyyy',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          STATUS = Status,",
						"          ID,",
						"          MAILADDRESS = {E-Mail},",
						"          FIRSTNAME = {Vorname (bürgerlich)},",
						"          LASTNAME = {Nachname (bürgerlich)},",
						"          DEPARTMENT = Abteilung,",
						"          AGE = Alter,",
						"          HIRED_AS = {Angestellt als},",
						"          HIRE_DATE = Anstelldatum,",
						"          EMPLOYMENT_TYPE = Anstellungsart,",
						"          EMPLOYEE_GROUPS_BY_FUNCTION = {Mitarbeitergruppen nach Funktion},",
						"          EXIT_TYPE = Austrittsart11,",
						"          EXIT_TYPE_2 = Austrittsart12,",
						"          LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD = {Austrittsdatum (aktueller Beschäftigungszeitraum)},",
						"          PLACE_OF_BUSINESS = {Betriebsstätte},",
						"          LENGTH_OF_EMPLOYMENT_IN_YEARS = Tenure_calculated,",
						"          ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD = {Eintrittsdatum (aktueller Beschäftigungszeitraum)},",
						"          END_OF_EMPLOYMENT = {Ende des Arbeitsverhältnisses},",
						"          FIRST_ENTRY_DATE = Ersteintrittsdatum,",
						"          FTE = vFTE,",
						"          GENDER = Geschlecht,",
						"          COMPANY = Gesellschaft,",
						"          DEGREE_OF_SEVERE_DISABILITY = {Grad der Behinderung},",
						"          COST_CENTRE = Kostenstelle,",
						"          TERMINATION_DATE = {Kündigung (Datum)},",
						"          REASON_FOR_TERMINATION = {Kündigungsgrund},",
						"          NUMBER_OF_EMPLOYEES_STATUS_ACTIVE_AND_TIME_OFF = AktiveMA,",
						"          DATEV_PERSONNEL_NUMBER = {DATEV Personalnummer},",
						"          POSITION = Position,",
						"          WEEKLY_HOURS = WochenStd,",
						"          LOAD_PERIOD = LoadPeriode,",
						"          LOAD_TIME = LoadDatum,",
						"          BAD_CHURN = {Bad Churn},",
						"          ACCIDENT_AT_WORK = ArbUnf,",
						"          WORKRELATED_DEATH = ABTodesfall,",
						"          COMPANY_KEY",
						"     )) ~> Personio"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/PersonioASCII')]",
				"[concat(variables('factoryId'), '/datasets/200_CompanyTranslation')]",
				"[concat(variables('factoryId'), '/datasets/200_Personio_Data')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/200_PERSONIO_DATA_bis_202301')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "PersonioASCII_bis_202301",
								"type": "DatasetReference"
							},
							"name": "PersonioASCII",
							"description": "Daten aus PersonioASCII importieren"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "200_Personio_Data",
								"type": "DatasetReference"
							},
							"name": "Personio"
						}
					],
					"transformations": [
						{
							"name": "LOADDatum"
						},
						{
							"name": "filter1"
						},
						{
							"name": "abgSp"
						},
						{
							"name": "cast1"
						}
					],
					"scriptLines": [
						"parameters{",
						"     PYear as string ('2023'),",
						"     PMonth as string ('04')",
						"}",
						"source(output(",
						"          Status as string,",
						"          ID as string,",
						"          {E-Mail} as string,",
						"          Name as string,",
						"          { Vorname} as string,",
						"          Abteilung as string,",
						"          Alter as string,",
						"          {Mitarbeitergruppen nach Anstellungsart} as string,",
						"          Anstellungsdatum as string,",
						"          Anstellungsart as string,",
						"          {Mitarbeitergruppen nach Funktion} as string,",
						"          Austrittsart11 as string,",
						"          Austrittsart12 as string,",
						"          {Austrittsdatum (aktueller Beschäftigungszeitraum)} as string,",
						"          {Betriebsstätte} as string,",
						"          {Betriebszugehörigkeit (in Jahren)} as string,",
						"          {Eintrittsdatum (aktueller Beschäftigungszeitraum)} as string,",
						"          {Ende des Arbeitsverhältnisses} as string,",
						"          Ersteintrittsdatum as string,",
						"          FTE as string,",
						"          Geschlecht as string,",
						"          Gesellschaft as string,",
						"          {Grad der Schwerbehinderung} as string,",
						"          Kostenstelle as string,",
						"          {Kündigung (Datum)} as string,",
						"          {Kündigungsgrund} as string,",
						"          {Mitarbeiterzahl (Status „Aktiv“ und „Auszeit“)} as string,",
						"          {DATEV Personalnummer} as string,",
						"          Position as string,",
						"          Wochenstunden as string,",
						"          {Bad Churn} as string,",
						"          Arbeitsunfall as string,",
						"          {Arbeitsbedingter Todesfall} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     wildcardPaths:[(concat('Personio/Schnittstelle_vor_Personio/Data_', $PYear, '_', $PMonth, '.csv'))]) ~> PersonioASCII",
						"cast1 derive(LoadDatum = currentTimestamp(),",
						"          LoadPeriode = concat($PYear, $PMonth),",
						"          Betriebszuge = toInteger({Betriebszugehörigkeit (in Jahren)})) ~> LOADDatum",
						"PersonioASCII filter(!isNull(Gesellschaft)) ~> filter1",
						"LOADDatum derive(vFTE = toDecimal(FTE, 27, 4, '#,##', 'de'),",
						"          Anstellungsdauer = toDecimal(Betriebszuge),",
						"          AktiveMA = toDecimal({Mitarbeiterzahl (Status „Aktiv“ und „Auszeit“)}, 27, 4, '#,##', 'de'),",
						"          WochenStd = toDecimal(Wochenstunden, 27, 4, '#,##', 'de')) ~> abgSp",
						"filter1 cast(output(",
						"          Alter as decimal(10,0) '000,000,000.000',",
						"          {Betriebszugehörigkeit (in Jahren)} as decimal(10,0) '000,000,000.000'",
						"     ),",
						"     errors: true) ~> cast1",
						"abgSp sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          STATUS as string,",
						"          ID as string,",
						"          MAILADDRESS as string,",
						"          FIRSTNAME as string,",
						"          LASTNAME as string,",
						"          DEPARTMENT as string,",
						"          AGE as decimal(27,4),",
						"          HIRED_AS as string,",
						"          HIRE_DATE as date,",
						"          EMPLOYMENT_TYPE as string,",
						"          EMPLOYEE_GROUPS_BY_FUNCTION as string,",
						"          EXIT_TYPE as string,",
						"          EXIT_TYPE_2 as string,",
						"          LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD as date,",
						"          PLACE_OF_BUSINESS as string,",
						"          LENGTH_OF_EMPLOYMENT_IN_YEARS as decimal(27,4),",
						"          ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD as date,",
						"          END_OF_EMPLOYMENT as date,",
						"          FIRST_ENTRY_DATE as date,",
						"          FTE as decimal(27,4),",
						"          GENDER as string,",
						"          COMPANY as string,",
						"          DEGREE_OF_SEVERE_DISABILITY as string,",
						"          COST_CENTRE as string,",
						"          TERMINATION_DATE as date,",
						"          REASON_FOR_TERMINATION as string,",
						"          NUMBER_OF_EMPLOYEES_STATUS_ACTIVE_AND_TIME_OFF as decimal(27,4),",
						"          DATEV_PERSONNEL_NUMBER as string,",
						"          POSITION as string,",
						"          WEEKLY_HOURS as decimal(27,4),",
						"          LOAD_PERIOD as string,",
						"          LOAD_TIME as timestamp,",
						"          BAD_CHURN as string,",
						"          ACCIDENT_AT_WORK as string,",
						"          WORKRELATED_DEATH as string,",
						"          COMPANY_KEY as string",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     preSQLs:[(concat('delete from [200_STG].[F_PERSONIO_DATA] WHERE [LOAD_PERIOD] = ', $PYear, $PMonth))],",
						"     dateFormat:'dd.MM.yyyy',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          STATUS = Status,",
						"          ID,",
						"          MAILADDRESS = {E-Mail},",
						"          FIRSTNAME = { Vorname},",
						"          LASTNAME = Name,",
						"          DEPARTMENT = Abteilung,",
						"          AGE = Alter,",
						"          HIRED_AS = {Mitarbeitergruppen nach Anstellungsart},",
						"          HIRE_DATE = Anstellungsdatum,",
						"          EMPLOYMENT_TYPE = Anstellungsart,",
						"          EMPLOYEE_GROUPS_BY_FUNCTION = {Mitarbeitergruppen nach Funktion},",
						"          EXIT_TYPE = Austrittsart11,",
						"          EXIT_TYPE_2 = Austrittsart12,",
						"          LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD = {Austrittsdatum (aktueller Beschäftigungszeitraum)},",
						"          PLACE_OF_BUSINESS = {Betriebsstätte},",
						"          LENGTH_OF_EMPLOYMENT_IN_YEARS = Anstellungsdauer,",
						"          ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD = {Eintrittsdatum (aktueller Beschäftigungszeitraum)},",
						"          END_OF_EMPLOYMENT = {Ende des Arbeitsverhältnisses},",
						"          FIRST_ENTRY_DATE = Ersteintrittsdatum,",
						"          FTE = vFTE,",
						"          GENDER = Geschlecht,",
						"          COMPANY = Gesellschaft,",
						"          DEGREE_OF_SEVERE_DISABILITY = {Grad der Schwerbehinderung},",
						"          COST_CENTRE = Kostenstelle,",
						"          TERMINATION_DATE = {Kündigung (Datum)},",
						"          REASON_FOR_TERMINATION = {Kündigungsgrund},",
						"          NUMBER_OF_EMPLOYEES_STATUS_ACTIVE_AND_TIME_OFF = AktiveMA,",
						"          DATEV_PERSONNEL_NUMBER = {DATEV Personalnummer},",
						"          POSITION = Position,",
						"          WEEKLY_HOURS = WochenStd,",
						"          LOAD_PERIOD = LoadPeriode,",
						"          LOAD_TIME = LoadDatum,",
						"          BAD_CHURN = {Bad Churn},",
						"          ACCIDENT_AT_WORK = Arbeitsunfall,",
						"          WORKRELATED_DEATH = {Arbeitsbedingter Todesfall}",
						"     )) ~> Personio"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/PersonioASCII_bis_202301')]",
				"[concat(variables('factoryId'), '/datasets/200_Personio_Data')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_FINANCIAL_DATA')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "200_Financial_Data",
								"type": "DatasetReference"
							},
							"name": "quelle"
						},
						{
							"dataset": {
								"referenceName": "D_PERIOD",
								"type": "DatasetReference"
							},
							"name": "periode"
						},
						{
							"dataset": {
								"referenceName": "200_CompanyTranslation",
								"type": "DatasetReference"
							},
							"name": "CompanyTranslation"
						},
						{
							"dataset": {
								"referenceName": "200_KTO",
								"type": "DatasetReference"
							},
							"name": "Kto"
						},
						{
							"dataset": {
								"referenceName": "AzureSqlCompanyBU",
								"type": "DatasetReference"
							},
							"name": "CompanyBU"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "400_Financial_Report",
								"type": "DatasetReference"
							},
							"name": "sink2"
						}
					],
					"transformations": [
						{
							"name": "lookupPeriode"
						},
						{
							"name": "PeriodeGesellschaft"
						},
						{
							"name": "SucheCompanyKey"
						},
						{
							"name": "lookupKto"
						},
						{
							"name": "filter1"
						},
						{
							"name": "lookupCompBU"
						},
						{
							"name": "filter3"
						},
						{
							"name": "derivedColumn1"
						},
						{
							"name": "aggregate2"
						},
						{
							"name": "filter4"
						},
						{
							"name": "filter5"
						},
						{
							"name": "aggregate3"
						},
						{
							"name": "filter6"
						},
						{
							"name": "aggregate4"
						},
						{
							"name": "union1"
						},
						{
							"name": "derivedColumn2"
						},
						{
							"name": "derivedColumn3"
						},
						{
							"name": "derivedColumn4"
						}
					],
					"scriptLines": [
						"source(output(",
						"          GES as string,",
						"          KTO as string,",
						"          PERIODE as string,",
						"          VALUE as double,",
						"          VERSION as long,",
						"          KONSEBENE as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> quelle",
						"source(output(",
						"          DP_PERIOD_ID as integer,",
						"          DP_PERIOD as string,",
						"          DP_START_DATE as date,",
						"          DP_END_DATE as date",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> periode",
						"source(output(",
						"          COMPANY as string,",
						"          COMPANY_KEY as string,",
						"          VALID_TO as integer,",
						"          VALID_FROM as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> CompanyTranslation",
						"source(output(",
						"          WorkspaceID as string,",
						"          ReportElementID as string,",
						"          AccountName as string,",
						"          SourceAccountID as long,",
						"          ChildIndex as integer,",
						"          PeriodType as string,",
						"          BalanceType as string,",
						"          TransactionTypeCategoryID as long,",
						"          IsFormula as integer,",
						"          IsTotalLine as integer,",
						"          IsTimeSeries as integer,",
						"          IsSeparatorLine as integer,",
						"          GeneralLedgerAccount as long,",
						"          PermittedUsersForAccount as string,",
						"          AccountLevel1ID as string,",
						"          AccountLevel1 as string,",
						"          AccountLevel1CI as integer,",
						"          AccountLevel2ID as string,",
						"          AccountLevel2 as string,",
						"          AccountLevel2CI as integer,",
						"          AccountLevel3ID as string,",
						"          AccountLevel3 as string,",
						"          AccountLevel3CI as integer,",
						"          AccountLevel4ID as string,",
						"          AccountLevel4 as string,",
						"          AccountLevel4CI as integer,",
						"          AccountLevel5ID as string,",
						"          AccountLevel5 as string,",
						"          AccountLevel5CI as integer,",
						"          AccountLevel6ID as string,",
						"          AccountLevel6 as string,",
						"          AccountLevel6CI as integer,",
						"          AccountLevel7ID as string,",
						"          AccountLevel7 as string,",
						"          AccountLevel7CI as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Kto",
						"source(output(",
						"          AccountingOrConsolidationArea as string,",
						"          OrganisationElementID as long,",
						"          OrganisationElementName as string,",
						"          OrganisationElementChildIndex as integer,",
						"          SourceType as string,",
						"          ReportingEntityID as long,",
						"          DefaultTransactionCurrency as string,",
						"          PermittedUsersForElement as string,",
						"          OrganisationLevel1ID as string,",
						"          OrganisationLevel1 as string,",
						"          OrganisationLevel1CI as integer,",
						"          OrganisationLevel2ID as string,",
						"          OrganisationLevel2 as string,",
						"          OrganisationLevel2CI as integer,",
						"          OrganisationLevel3ID as string,",
						"          OrganisationLevel3 as string,",
						"          OrganisationLevel3CI as integer,",
						"          OrganisationLevel4ID as string,",
						"          OrganisationLevel4 as string,",
						"          OrganisationLevel4CI as integer,",
						"          OrganisationLevel5ID as string,",
						"          OrganisationLevel5 as string,",
						"          OrganisationLevel5CI as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> CompanyBU",
						"PeriodeGesellschaft, periode lookup(Periode6 == DP_PERIOD,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupPeriode",
						"filter3 derive(Periode6 = concat(left(PERIODE, 4), right(PERIODE, 2)),",
						"          Gesellschaft = iif ( equals(KONSEBENE, 'Einzelabschluss HB2 adj.'), AccountingOrConsolidationArea, 'ATG' ),",
						"          PeriodeNum = toInteger(concat(left(PERIODE, 4), right(PERIODE, 2)))) ~> PeriodeGesellschaft",
						"lookupPeriode, CompanyTranslation lookup(Gesellschaft == COMPANY",
						"     && PeriodeNum >= VALID_FROM",
						"     && PeriodeNum <= VALID_TO,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'right')~> SucheCompanyKey",
						"quelle, Kto lookup(KTO == ReportElementID,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupKto",
						"lookupKto filter(equals(KTO, '2462345') || equals(KTO, '2462254') || equals(AccountLevel3ID, '2462256')  || equals(AccountLevel4ID, '2462257') || equals(AccountLevel5ID, '2462442_REF_2461463') || equals(AccountLevel4ID, '2462259')) ~> filter1",
						"filter1, CompanyBU lookup(GES == OrganisationElementName,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupCompBU",
						"lookupCompBU filter(( equals(KONSEBENE, 'Einzelabschluss HB2 adj.') && !equals(OrganisationElementID, 2477920) ) || ( equals(OrganisationElementID, 2477920) && equals(KONSEBENE, 'Konzern') )) ~> filter3",
						"SucheCompanyKey derive(Ges = iif(isNull(COMPANY_KEY), Gesellschaft, COMPANY_KEY),",
						"          BU = iif ( equals(KONSEBENE, 'Einzelabschluss HB2 adj.'), iif( equals(SourceType, 'CostCenter'), OrganisationElementName, toString(null())), toString(null()) ),",
						"          Actuals = iif(equals(VERSION, 1201), VALUE, toDouble(null())),",
						"          Budget = iif(equals(VERSION, 2479958) || equals(VERSION, 2535825) || equals(VERSION, 2680301), VALUE, toDouble(null())),",
						"          Periode6 = concat(left(PERIODE, 4), right(PERIODE, 2))) ~> derivedColumn1",
						"filter4 aggregate(groupBy(derivedColumn1@Ges,",
						"          Konto,",
						"          Periode6,",
						"          BU,",
						"          KONSEBENE,",
						"          DP_PERIOD_ID),",
						"     ActValue = sum(Actuals),",
						"          BudValue = sum(Budget)) ~> aggregate2",
						"derivedColumn4 filter(KontoFilter == 1) ~> filter4",
						"derivedColumn3 filter(KontoFilter == 2) ~> filter5",
						"filter5 aggregate(groupBy(derivedColumn1@Ges,",
						"          Konto,",
						"          Periode6,",
						"          BU,",
						"          KONSEBENE,",
						"          DP_PERIOD_ID),",
						"     ActValue = sum(Actuals),",
						"          BudValue = sum(Budget)) ~> aggregate3",
						"derivedColumn2 filter(KontoFilter == 3) ~> filter6",
						"filter6 aggregate(groupBy(derivedColumn1@Ges,",
						"          Konto,",
						"          Periode6,",
						"          BU,",
						"          KONSEBENE,",
						"          DP_PERIOD_ID),",
						"     ActValue = sum(Actuals),",
						"          BudValue = sum(Budget)) ~> aggregate4",
						"aggregate2, aggregate3, aggregate4 union(byName: true)~> union1",
						"derivedColumn1 derive(Konto = case( equals(AccountLevel3ID, '2462256') , AccountLevel3\r",
						"    , 'kein Konto'\r",
						"),",
						"          KontoFilter = case( equals(AccountLevel3ID, '2462256') , 3\r",
						"    , 0\r",
						")) ~> derivedColumn2",
						"derivedColumn1 derive(Konto = case( equals(KTO, '2462345') || equals(KTO, '2462254'), AccountName\r",
						"    , 'kein Konto'\r",
						"),",
						"          KontoFilter = case( equals(KTO, '2462345') || equals(KTO, '2462254'), 2\r",
						"    , 0\r",
						")) ~> derivedColumn3",
						"derivedColumn1 derive(Konto = case(equals(AccountLevel4ID, '2462257') || equals(AccountLevel5ID, '2462442_REF_2461463') || equals(AccountLevel4ID, '2462259') , 'Salary expenses'\r",
						"    , 'kein Konto'\r",
						"),",
						"          KontoFilter = case(equals(AccountLevel4ID, '2462257') || equals(AccountLevel5ID, '2462442_REF_2461463') || equals(AccountLevel4ID, '2462259') , 1\r",
						"    , 0\r",
						")) ~> derivedColumn4",
						"union1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          FR_PERIOD as string,",
						"          FR_YEAR as string,",
						"          FR_MONTH as string,",
						"          FR_COMPANY as string,",
						"          FR_BU as string,",
						"          FR_ACCOUNT as string,",
						"          FR_VALUE_ACT as decimal(27,4),",
						"          FR_VALUE_BUDGET as decimal(27,4),",
						"          FR_PERIODID as integer",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     preSQLs:['truncate table [400_DWH].[F_FINANCIAL_REPORT]'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          FR_PERIOD = Periode6,",
						"          FR_YEAR = KONSEBENE,",
						"          FR_COMPANY = Ges,",
						"          FR_BU = BU,",
						"          FR_ACCOUNT = Konto,",
						"          FR_VALUE_ACT = ActValue,",
						"          FR_VALUE_BUDGET = BudValue,",
						"          FR_PERIODID = DP_PERIOD_ID",
						"     )) ~> sink2"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/200_Financial_Data')]",
				"[concat(variables('factoryId'), '/datasets/D_PERIOD')]",
				"[concat(variables('factoryId'), '/datasets/200_CompanyTranslation')]",
				"[concat(variables('factoryId'), '/datasets/200_KTO')]",
				"[concat(variables('factoryId'), '/datasets/AzureSqlCompanyBU')]",
				"[concat(variables('factoryId'), '/datasets/400_Financial_Report')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_FINANCIAL_DATA_copy1')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "200_Financial_Data",
								"type": "DatasetReference"
							},
							"name": "quelle"
						},
						{
							"dataset": {
								"referenceName": "D_PERIOD",
								"type": "DatasetReference"
							},
							"name": "periode"
						},
						{
							"dataset": {
								"referenceName": "200_CompanyTranslation",
								"type": "DatasetReference"
							},
							"name": "CompanyTranslation"
						},
						{
							"dataset": {
								"referenceName": "200_KTO",
								"type": "DatasetReference"
							},
							"name": "Kto"
						},
						{
							"dataset": {
								"referenceName": "AzureSqlCompanyBU",
								"type": "DatasetReference"
							},
							"name": "CompanyBU"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "400_Financial_Report",
								"type": "DatasetReference"
							},
							"name": "finrep"
						}
					],
					"transformations": [
						{
							"name": "lookupPeriode"
						},
						{
							"name": "KontoErmitteln"
						},
						{
							"name": "SucheCompanyKey"
						},
						{
							"name": "lookupKto"
						},
						{
							"name": "filter1"
						},
						{
							"name": "aggregate1"
						},
						{
							"name": "lookupCompBU"
						},
						{
							"name": "filter3"
						},
						{
							"name": "derivedColumn1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          GES as string,",
						"          KTO as string,",
						"          PERIODE as string,",
						"          VALUE as double,",
						"          VERSION as long,",
						"          KONSEBENE as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> quelle",
						"source(output(",
						"          DP_PERIOD_ID as integer,",
						"          DP_PERIOD as string,",
						"          DP_START_DATE as date,",
						"          DP_END_DATE as date",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> periode",
						"source(output(",
						"          COMPANY as string,",
						"          COMPANY_KEY as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> CompanyTranslation",
						"source(output(",
						"          WorkspaceID as string,",
						"          ReportElementID as string,",
						"          AccountName as string,",
						"          SourceAccountID as long,",
						"          ChildIndex as integer,",
						"          PeriodType as string,",
						"          BalanceType as string,",
						"          TransactionTypeCategoryID as long,",
						"          IsFormula as integer,",
						"          IsTotalLine as integer,",
						"          IsTimeSeries as integer,",
						"          IsSeparatorLine as integer,",
						"          GeneralLedgerAccount as long,",
						"          PermittedUsersForAccount as string,",
						"          AccountLevel1ID as string,",
						"          AccountLevel1 as string,",
						"          AccountLevel1CI as integer,",
						"          AccountLevel2ID as string,",
						"          AccountLevel2 as string,",
						"          AccountLevel2CI as integer,",
						"          AccountLevel3ID as string,",
						"          AccountLevel3 as string,",
						"          AccountLevel3CI as integer,",
						"          AccountLevel4ID as string,",
						"          AccountLevel4 as string,",
						"          AccountLevel4CI as integer,",
						"          AccountLevel5ID as string,",
						"          AccountLevel5 as string,",
						"          AccountLevel5CI as integer,",
						"          AccountLevel6ID as string,",
						"          AccountLevel6 as string,",
						"          AccountLevel6CI as integer,",
						"          AccountLevel7ID as string,",
						"          AccountLevel7 as string,",
						"          AccountLevel7CI as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Kto",
						"source(output(",
						"          AccountingOrConsolidationArea as string,",
						"          OrganisationElementID as long,",
						"          OrganisationElementName as string,",
						"          OrganisationElementChildIndex as integer,",
						"          SourceType as string,",
						"          ReportingEntityID as long,",
						"          DefaultTransactionCurrency as string,",
						"          PermittedUsersForElement as string,",
						"          OrganisationLevel1ID as string,",
						"          OrganisationLevel1 as string,",
						"          OrganisationLevel1CI as integer,",
						"          OrganisationLevel2ID as string,",
						"          OrganisationLevel2 as string,",
						"          OrganisationLevel2CI as integer,",
						"          OrganisationLevel3ID as string,",
						"          OrganisationLevel3 as string,",
						"          OrganisationLevel3CI as integer,",
						"          OrganisationLevel4ID as string,",
						"          OrganisationLevel4 as string,",
						"          OrganisationLevel4CI as integer,",
						"          OrganisationLevel5ID as string,",
						"          OrganisationLevel5 as string,",
						"          OrganisationLevel5CI as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> CompanyBU",
						"aggregate1, periode lookup(Periode6 == DP_PERIOD,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupPeriode",
						"filter3 derive(Konto = case(equals(AccountLevel4ID, '2462257') || equals(AccountLevel5ID, '2462442_REF_2461463') || equals(AccountLevel4ID, '2462259') , 'Salary expenses'\r",
						"    , equals(KTO, '2462345') || equals(KTO, '2462254'), AccountName\r",
						"    , equals(AccountLevel3ID, '2462256') , AccountLevel3\r",
						"    , 'kein Konto'\r",
						"),",
						"          Gesellschaft = iif ( equals(KONSEBENE, 'Einzelabschluss HB2 adj.'), AccountingOrConsolidationArea, 'ATG' ),",
						"          BU = iif ( equals(KONSEBENE, 'Einzelabschluss HB2 adj.'), iif( equals(SourceType, 'CostCenter'), OrganisationElementName, toString(null())), toString(null()) ),",
						"          Actuals = iif(equals(VERSION, 1201), VALUE, toDouble(null())),",
						"          Budget = iif(equals(VERSION, 2479958), VALUE, toDouble(null())),",
						"          Periode6 = concat(left(PERIODE, 4), right(PERIODE, 2))) ~> KontoErmitteln",
						"lookupPeriode, CompanyTranslation lookup(Gesellschaft == COMPANY,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> SucheCompanyKey",
						"quelle, Kto lookup(KTO == ReportElementID,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupKto",
						"lookupKto filter(equals(KTO, '2462345') || equals(KTO, '2462254') || equals(AccountLevel3ID, '2462256')  || equals(AccountLevel4ID, '2462257') || equals(AccountLevel5ID, '2462442_REF_2461463') || equals(AccountLevel4ID, '2462259')) ~> filter1",
						"KontoErmitteln aggregate(groupBy(Gesellschaft,",
						"          KTO,",
						"          Periode6,",
						"          BU,",
						"          KONSEBENE),",
						"     ActVal = sum(Actuals),",
						"          BudVal = sum(Budget)) ~> aggregate1",
						"filter1, CompanyBU lookup(GES == OrganisationElementName,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupCompBU",
						"lookupCompBU filter(( equals(KONSEBENE, 'Einzelabschluss HB2 adj.') && !equals(OrganisationElementID, 2477920) ) || ( equals(OrganisationElementID, 2477920) && equals(KONSEBENE, 'Konzern') )) ~> filter3",
						"SucheCompanyKey derive(Ges = iif(isNull(COMPANY_KEY), Gesellschaft, COMPANY_KEY)) ~> derivedColumn1",
						"derivedColumn1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          FR_PERIOD as string,",
						"          FR_YEAR as string,",
						"          FR_MONTH as string,",
						"          FR_COMPANY as string,",
						"          FR_BU as string,",
						"          FR_ACCOUNT as string,",
						"          FR_VALUE_ACT as decimal(27,4),",
						"          FR_VALUE_BUDGET as decimal(27,4),",
						"          FR_PERIODID as integer",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     preSQLs:['truncate table [400_DWH].[F_FINANCIAL_REPORT]'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          FR_PERIOD = Periode6,",
						"          FR_COMPANY = Ges,",
						"          FR_ACCOUNT = KTO,",
						"          FR_VALUE_ACT = ActVal,",
						"          FR_VALUE_BUDGET = BudVal,",
						"          FR_PERIODID = DP_PERIOD_ID,",
						"          FR_BU = BU,",
						"          FR_YEAR = KONSEBENE",
						"     )) ~> finrep"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/200_Financial_Data')]",
				"[concat(variables('factoryId'), '/datasets/D_PERIOD')]",
				"[concat(variables('factoryId'), '/datasets/200_CompanyTranslation')]",
				"[concat(variables('factoryId'), '/datasets/200_KTO')]",
				"[concat(variables('factoryId'), '/datasets/AzureSqlCompanyBU')]",
				"[concat(variables('factoryId'), '/datasets/400_Financial_Report')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_FINANCIAL_DATA_copy2')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "200_Financial_Data",
								"type": "DatasetReference"
							},
							"name": "quelle"
						},
						{
							"dataset": {
								"referenceName": "D_PERIOD",
								"type": "DatasetReference"
							},
							"name": "periode"
						},
						{
							"dataset": {
								"referenceName": "200_CompanyTranslation",
								"type": "DatasetReference"
							},
							"name": "CompanyTranslation"
						},
						{
							"dataset": {
								"referenceName": "200_KTO",
								"type": "DatasetReference"
							},
							"name": "Kto"
						},
						{
							"dataset": {
								"referenceName": "AzureSqlCompanyBU",
								"type": "DatasetReference"
							},
							"name": "CompanyBU"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "400_Financial_Report",
								"type": "DatasetReference"
							},
							"name": "finrep"
						},
						{
							"dataset": {
								"referenceName": "400_Financial_Report",
								"type": "DatasetReference"
							},
							"name": "sink1"
						},
						{
							"dataset": {
								"referenceName": "400_Financial_Report",
								"type": "DatasetReference"
							},
							"name": "sink2"
						}
					],
					"transformations": [
						{
							"name": "lookupPeriode"
						},
						{
							"name": "PeriodeGesellschaft"
						},
						{
							"name": "SucheCompanyKey"
						},
						{
							"name": "lookupKto"
						},
						{
							"name": "filter1"
						},
						{
							"name": "lookupCompBU"
						},
						{
							"name": "filter3"
						},
						{
							"name": "derivedColumn1"
						},
						{
							"name": "aggregate2"
						},
						{
							"name": "filter4"
						},
						{
							"name": "filter5"
						},
						{
							"name": "aggregate3"
						},
						{
							"name": "filter6"
						},
						{
							"name": "aggregate4"
						}
					],
					"scriptLines": [
						"source(output(",
						"          GES as string,",
						"          KTO as string,",
						"          PERIODE as string,",
						"          VALUE as double,",
						"          VERSION as long,",
						"          KONSEBENE as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> quelle",
						"source(output(",
						"          DP_PERIOD_ID as integer,",
						"          DP_PERIOD as string,",
						"          DP_START_DATE as date,",
						"          DP_END_DATE as date",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> periode",
						"source(output(",
						"          COMPANY as string,",
						"          COMPANY_KEY as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> CompanyTranslation",
						"source(output(",
						"          WorkspaceID as string,",
						"          ReportElementID as string,",
						"          AccountName as string,",
						"          SourceAccountID as long,",
						"          ChildIndex as integer,",
						"          PeriodType as string,",
						"          BalanceType as string,",
						"          TransactionTypeCategoryID as long,",
						"          IsFormula as integer,",
						"          IsTotalLine as integer,",
						"          IsTimeSeries as integer,",
						"          IsSeparatorLine as integer,",
						"          GeneralLedgerAccount as long,",
						"          PermittedUsersForAccount as string,",
						"          AccountLevel1ID as string,",
						"          AccountLevel1 as string,",
						"          AccountLevel1CI as integer,",
						"          AccountLevel2ID as string,",
						"          AccountLevel2 as string,",
						"          AccountLevel2CI as integer,",
						"          AccountLevel3ID as string,",
						"          AccountLevel3 as string,",
						"          AccountLevel3CI as integer,",
						"          AccountLevel4ID as string,",
						"          AccountLevel4 as string,",
						"          AccountLevel4CI as integer,",
						"          AccountLevel5ID as string,",
						"          AccountLevel5 as string,",
						"          AccountLevel5CI as integer,",
						"          AccountLevel6ID as string,",
						"          AccountLevel6 as string,",
						"          AccountLevel6CI as integer,",
						"          AccountLevel7ID as string,",
						"          AccountLevel7 as string,",
						"          AccountLevel7CI as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Kto",
						"source(output(",
						"          AccountingOrConsolidationArea as string,",
						"          OrganisationElementID as long,",
						"          OrganisationElementName as string,",
						"          OrganisationElementChildIndex as integer,",
						"          SourceType as string,",
						"          ReportingEntityID as long,",
						"          DefaultTransactionCurrency as string,",
						"          PermittedUsersForElement as string,",
						"          OrganisationLevel1ID as string,",
						"          OrganisationLevel1 as string,",
						"          OrganisationLevel1CI as integer,",
						"          OrganisationLevel2ID as string,",
						"          OrganisationLevel2 as string,",
						"          OrganisationLevel2CI as integer,",
						"          OrganisationLevel3ID as string,",
						"          OrganisationLevel3 as string,",
						"          OrganisationLevel3CI as integer,",
						"          OrganisationLevel4ID as string,",
						"          OrganisationLevel4 as string,",
						"          OrganisationLevel4CI as integer,",
						"          OrganisationLevel5ID as string,",
						"          OrganisationLevel5 as string,",
						"          OrganisationLevel5CI as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> CompanyBU",
						"PeriodeGesellschaft, periode lookup(Periode6 == DP_PERIOD,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupPeriode",
						"filter3 derive(Periode6 = concat(left(PERIODE, 4), right(PERIODE, 2)),",
						"          Gesellschaft = iif ( equals(KONSEBENE, 'Einzelabschluss HB2 adj.'), AccountingOrConsolidationArea, 'ATG' )) ~> PeriodeGesellschaft",
						"lookupPeriode, CompanyTranslation lookup(Gesellschaft == COMPANY,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> SucheCompanyKey",
						"quelle, Kto lookup(KTO == ReportElementID,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupKto",
						"lookupKto filter(equals(KTO, '2462345') || equals(KTO, '2462254') || equals(AccountLevel3ID, '2462256')  || equals(AccountLevel4ID, '2462257') || equals(AccountLevel5ID, '2462442_REF_2461463') || equals(AccountLevel4ID, '2462259')) ~> filter1",
						"filter1, CompanyBU lookup(GES == OrganisationElementName,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupCompBU",
						"lookupCompBU filter(( equals(KONSEBENE, 'Einzelabschluss HB2 adj.') && !equals(OrganisationElementID, 2477920) ) || ( equals(OrganisationElementID, 2477920) && equals(KONSEBENE, 'Konzern') )) ~> filter3",
						"SucheCompanyKey derive(Ges = iif(isNull(COMPANY_KEY), Gesellschaft, COMPANY_KEY),",
						"          Konto = case(equals(AccountLevel4ID, '2462257') || equals(AccountLevel5ID, '2462442_REF_2461463') || equals(AccountLevel4ID, '2462259') , 'Salary expenses'\r",
						"    , equals(KTO, '2462345') || equals(KTO, '2462254'), AccountName\r",
						"    , equals(AccountLevel3ID, '2462256') , AccountLevel3\r",
						"    , 'kein Konto'\r",
						"),",
						"          FilterKonto = case(equals(AccountLevel4ID, '2462257') || equals(AccountLevel5ID, '2462442_REF_2461463') || equals(AccountLevel4ID, '2462259') , 1\r",
						"    , equals(KTO, '2462345') || equals(KTO, '2462254'), 2\r",
						"    , equals(AccountLevel3ID, '2462256') , 3\r",
						"    , 0\r",
						"),",
						"          BU = iif ( equals(KONSEBENE, 'Einzelabschluss HB2 adj.'), iif( equals(SourceType, 'CostCenter'), OrganisationElementName, toString(null())), toString(null()) ),",
						"          Actuals = iif(equals(VERSION, 1201), VALUE, toDouble(null())),",
						"          Budget = iif(equals(VERSION, 2479958), VALUE, toDouble(null())),",
						"          Periode6 = concat(left(PERIODE, 4), right(PERIODE, 2))) ~> derivedColumn1",
						"filter4 aggregate(groupBy(derivedColumn1@Ges,",
						"          Konto,",
						"          Periode6,",
						"          BU,",
						"          KONSEBENE,",
						"          DP_PERIOD_ID),",
						"     ActVal = sum(Actuals),",
						"          BudVal = sum(Budget)) ~> aggregate2",
						"derivedColumn1 filter(FilterKonto == 1) ~> filter4",
						"derivedColumn1 filter(FilterKonto == 2) ~> filter5",
						"filter5 aggregate(groupBy(derivedColumn1@Ges,",
						"          Konto,",
						"          Periode6,",
						"          BU,",
						"          KONSEBENE,",
						"          DP_PERIOD_ID),",
						"     ActValue = sum(Actuals),",
						"          BudValue = sum(Budget)) ~> aggregate3",
						"derivedColumn1 filter(FilterKonto == 3) ~> filter6",
						"filter6 aggregate(groupBy(derivedColumn1@Ges,",
						"          Konto,",
						"          Periode6,",
						"          BU,",
						"          KONSEBENE,",
						"          DP_PERIOD_ID),",
						"     ActValue = sum(Actuals),",
						"          BudValue = sum(Budget)) ~> aggregate4",
						"aggregate2 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          FR_PERIOD as string,",
						"          FR_YEAR as string,",
						"          FR_MONTH as string,",
						"          FR_COMPANY as string,",
						"          FR_BU as string,",
						"          FR_ACCOUNT as string,",
						"          FR_VALUE_ACT as decimal(27,4),",
						"          FR_VALUE_BUDGET as decimal(27,4),",
						"          FR_PERIODID as integer",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          FR_PERIOD = Periode6,",
						"          FR_COMPANY = Ges,",
						"          FR_ACCOUNT = Konto,",
						"          FR_VALUE_ACT = ActVal,",
						"          FR_VALUE_BUDGET = BudVal,",
						"          FR_PERIODID = DP_PERIOD_ID,",
						"          FR_BU = BU,",
						"          FR_YEAR = KONSEBENE",
						"     )) ~> finrep",
						"aggregate3 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          FR_PERIOD as string,",
						"          FR_YEAR as string,",
						"          FR_MONTH as string,",
						"          FR_COMPANY as string,",
						"          FR_BU as string,",
						"          FR_ACCOUNT as string,",
						"          FR_VALUE_ACT as decimal(27,4),",
						"          FR_VALUE_BUDGET as decimal(27,4),",
						"          FR_PERIODID as integer",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          FR_PERIOD = Periode6,",
						"          FR_YEAR = KONSEBENE,",
						"          FR_COMPANY = Ges,",
						"          FR_BU = BU,",
						"          FR_ACCOUNT = Konto,",
						"          FR_VALUE_ACT = ActValue,",
						"          FR_VALUE_BUDGET = BudValue,",
						"          FR_PERIODID = DP_PERIOD_ID",
						"     )) ~> sink1",
						"aggregate4 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          FR_PERIOD as string,",
						"          FR_YEAR as string,",
						"          FR_MONTH as string,",
						"          FR_COMPANY as string,",
						"          FR_BU as string,",
						"          FR_ACCOUNT as string,",
						"          FR_VALUE_ACT as decimal(27,4),",
						"          FR_VALUE_BUDGET as decimal(27,4),",
						"          FR_PERIODID as integer",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          FR_PERIOD = Periode6,",
						"          FR_YEAR = KONSEBENE,",
						"          FR_COMPANY = Ges,",
						"          FR_BU = BU,",
						"          FR_ACCOUNT = Konto,",
						"          FR_VALUE_ACT = ActValue,",
						"          FR_VALUE_BUDGET = BudValue,",
						"          FR_PERIODID = DP_PERIOD_ID",
						"     )) ~> sink2"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/200_Financial_Data')]",
				"[concat(variables('factoryId'), '/datasets/D_PERIOD')]",
				"[concat(variables('factoryId'), '/datasets/200_CompanyTranslation')]",
				"[concat(variables('factoryId'), '/datasets/200_KTO')]",
				"[concat(variables('factoryId'), '/datasets/AzureSqlCompanyBU')]",
				"[concat(variables('factoryId'), '/datasets/400_Financial_Report')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_PERSONELL_BUDGET')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "200_Personell_Budget",
								"type": "DatasetReference"
							},
							"name": "Budget200"
						},
						{
							"dataset": {
								"referenceName": "200_CompanyTranslation",
								"type": "DatasetReference"
							},
							"name": "Ges"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "400_Personell_Budget",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "lookupGes"
						}
					],
					"scriptLines": [
						"source(output(",
						"          COMPANY as string,",
						"          KPI as string,",
						"          FUNCTION as string,",
						"          PERIOD as string,",
						"          BUDGET_VALUE as decimal(10,0)",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Budget200",
						"source(output(",
						"          COMPANY as string,",
						"          COMPANY_KEY as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Ges",
						"Budget200, Ges lookup(Budget200@COMPANY == Ges@COMPANY,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupGes",
						"lookupGes sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          COMPANY as string,",
						"          KPI as string,",
						"          FUNCTION as string,",
						"          PERIOD as string,",
						"          BUDGET_HC as decimal(27,4),",
						"          BUDGET_FTE as decimal(27,4)",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     truncate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          COMPANY = Budget200@COMPANY,",
						"          KPI,",
						"          FUNCTION,",
						"          PERIOD,",
						"          BUDGET_FTE = BUDGET_VALUE",
						"     )) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/200_Personell_Budget')]",
				"[concat(variables('factoryId'), '/datasets/200_CompanyTranslation')]",
				"[concat(variables('factoryId'), '/datasets/400_Personell_Budget')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_PERSONELL_BUDGET_AB')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "400_PERSONELL_DATA",
								"type": "DatasetReference"
							},
							"name": "AB"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "400_Personell_Budget",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "KPIAB"
						},
						{
							"name": "filter1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          FPR_PERIOD as string,",
						"          FPR_COMPANY as string,",
						"          FPR_FUNCTION as string,",
						"          Anfangsbestand as decimal(38,4)",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT [FPR_PERIOD]\\n      ,[FPR_COMPANY]\\n      ,[FPR_FUNCTION]\\n      ,sum([FPR_FTE_EMPLOYEES_START_PERIOD]) as Anfangsbestand\\n  FROM [400_DWH].[F_PERSONELL_REPORT]\\n  group by FPR_PERIOD, FPR_COMPANY, FPR_FUNCTION',",
						"     format: 'query') ~> AB",
						"filter1 derive(KPI = \"AB\") ~> KPIAB",
						"AB filter(right(FPR_PERIOD, 2) ==\"01\") ~> filter1",
						"KPIAB sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          COMPANY as string,",
						"          KPI as string,",
						"          FUNCTION as string,",
						"          PERIOD as string,",
						"          BUDGET_HC as decimal(27,4),",
						"          BUDGET_FTE as decimal(27,4)",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          COMPANY = FPR_COMPANY,",
						"          KPI,",
						"          FUNCTION = FPR_FUNCTION,",
						"          PERIOD = FPR_PERIOD,",
						"          BUDGET_FTE = Anfangsbestand",
						"     )) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/400_PERSONELL_DATA')]",
				"[concat(variables('factoryId'), '/datasets/400_Personell_Budget')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_PERSONELL_BUDGET_pivot')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "100_STG_PERS_BUDGET_24",
								"type": "DatasetReference"
							},
							"name": "Budget100"
						},
						{
							"dataset": {
								"referenceName": "200_CompanyTranslation",
								"type": "DatasetReference"
							},
							"name": "Ges"
						},
						{
							"dataset": {
								"referenceName": "400_TRANSLATION",
								"type": "DatasetReference"
							},
							"name": "Translation"
						},
						{
							"dataset": {
								"referenceName": "400_PERSONELL_DATA",
								"type": "DatasetReference"
							},
							"name": "source9"
						},
						{
							"dataset": {
								"referenceName": "CompanyMapping",
								"type": "DatasetReference"
							},
							"name": "CompanyMapping"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "AzureSqlTable9",
								"type": "DatasetReference"
							},
							"name": "sink2"
						}
					],
					"transformations": [
						{
							"name": "pivot1"
						},
						{
							"name": "aggregate1"
						},
						{
							"name": "join1"
						},
						{
							"name": "window1"
						},
						{
							"name": "derivedColumn1"
						},
						{
							"name": "ABhinzufuegen"
						},
						{
							"name": "MapDrifted1",
							"description": "Hiermit wird für jede abweichende Spalte eine explizite Zuordnung erstellt."
						},
						{
							"name": "join2"
						}
					],
					"scriptLines": [
						"source(output(",
						"          COMPANY as string,",
						"          KPI as string,",
						"          FUNCTION as string,",
						"          PERIOD as string,",
						"          BUDGET as decimal(10,2)",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Budget100",
						"source(output(",
						"          COMPANY as string,",
						"          COMPANY_KEY as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Ges",
						"source(output(",
						"          DATAAREA as string,",
						"          SRC_VALUE as string,",
						"          TRANSLATION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT DISTINCT [DATAAREA]\\n      ,[SRC_VALUE]\\n      ,[TRANSLATION]\\n  FROM [400_DWH].[TRANSLATIONS]',",
						"     format: 'query') ~> Translation",
						"source(output(",
						"          FPR_PERIOD as string,",
						"          FPR_COMPANY as string,",
						"          FPR_FUNCTION as string,",
						"          FPR_FTE_EMPLOYEES_END_PERIOD_INCL_GROUPCHANGE as decimal(18,4)",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT [FPR_PERIOD]\\n      ,[FPR_COMPANY]\\n      ,[FPR_FUNCTION]\\n      ,[FPR_FTE_EMPLOYEES_END_PERIOD_INCL_GROUPCHANGE]\\nFROM [400_DWH].[F_PERSONELL_REPORT]\\nWHERE [FPR_PERIOD] = \\'202312\\'',",
						"     format: 'query') ~> source9",
						"source(output(",
						"          Gesellschaft as string,",
						"          {Kürzel} as string,",
						"          {gültig bis} as string,",
						"          {gültig ab} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false) ~> CompanyMapping",
						"Budget100 pivot(groupBy(COMPANY,",
						"          FUNCTION,",
						"          PERIOD),",
						"     pivotBy(KPI),",
						"     {} = sum(BUDGET),",
						"     columnNaming: '$N$V',",
						"     lateral: true) ~> pivot1",
						"source9 aggregate(groupBy(FPR_COMPANY,",
						"          FPR_FUNCTION),",
						"     EB_FTE_SUM = sum(FPR_FTE_EMPLOYEES_END_PERIOD_INCL_GROUPCHANGE)) ~> aggregate1",
						"aggregate1, join2 join(FPR_COMPANY == COMPANY",
						"     && FPR_FUNCTION == TRANSLATION,",
						"     joinType:'outer',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join1",
						"join1 window(over(COMPANY,",
						"          FUNCTION),",
						"     asc(PERIOD, true),",
						"     CumSum_NetHires = sum({Netto Neueinstellungen})) ~> window1",
						"window1 derive({EB Budget} = {EB_FTE_SUM}+{CumSum_NetHires}) ~> derivedColumn1",
						"derivedColumn1 window(over(FPR_COMPANY,",
						"          FPR_FUNCTION),",
						"     asc(PERIOD, true),",
						"     {AB Budget} = iif(isNull(lag({EB Budget}, 1)), {EB_FTE_SUM}, lag({EB Budget}, 1))) ~> ABhinzufuegen",
						"pivot1 derive({Netto Neueinstellungen} = toDecimal(byName('Netto Neueinstellungen'))) ~> MapDrifted1",
						"MapDrifted1, Translation join(FUNCTION == SRC_VALUE,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join2",
						"ABhinzufuegen sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     truncate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          PERIOD,",
						"          COMPANY,",
						"          FUNCTION = TRANSLATION,",
						"          EB_FTE_SUM_DEZ23 = EB_FTE_SUM,",
						"          NET_NEW_HIRES = {Netto Neueinstellungen},",
						"          CumSum_NetHires,",
						"          {EB Budget},",
						"          {AB Budget}",
						"     )) ~> sink2"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/100_STG_PERS_BUDGET_24')]",
				"[concat(variables('factoryId'), '/datasets/200_CompanyTranslation')]",
				"[concat(variables('factoryId'), '/datasets/400_TRANSLATION')]",
				"[concat(variables('factoryId'), '/datasets/400_PERSONELL_DATA')]",
				"[concat(variables('factoryId'), '/datasets/CompanyMapping')]",
				"[concat(variables('factoryId'), '/datasets/AzureSqlTable9')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_PERSONELL_BUDGET_unpivot')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "200_PERSONELL_BUDGET_TMP",
								"type": "DatasetReference"
							},
							"name": "Budget200TMP"
						},
						{
							"dataset": {
								"referenceName": "200_CompanyTranslation",
								"type": "DatasetReference"
							},
							"name": "Ges"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "400_Personell_Budget",
								"type": "DatasetReference"
							},
							"name": "sink2"
						},
						{
							"dataset": {
								"referenceName": "400_Personell_Budget",
								"type": "DatasetReference"
							},
							"name": "sink3"
						},
						{
							"dataset": {
								"referenceName": "400_Personell_Budget",
								"type": "DatasetReference"
							},
							"name": "sink4"
						},
						{
							"dataset": {
								"referenceName": "400_Personell_Budget",
								"type": "DatasetReference"
							},
							"name": "sink5"
						}
					],
					"transformations": [
						{
							"name": "derivedColumn1"
						},
						{
							"name": "derivedColumn2"
						},
						{
							"name": "derivedColumn3"
						},
						{
							"name": "derivedColumn4"
						},
						{
							"name": "filter1"
						},
						{
							"name": "filter2"
						},
						{
							"name": "filter3"
						},
						{
							"name": "filter4"
						}
					],
					"scriptLines": [
						"source(output(",
						"          COMPANY as string,",
						"          FUNCTION as string,",
						"          PERIOD as string,",
						"          Churn as decimal(16,2),",
						"          Endbestand as decimal(16,2),",
						"          {New-Joiner} as decimal(16,2),",
						"          AB as decimal(16,2)",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Budget200TMP",
						"source(output(",
						"          COMPANY as string,",
						"          COMPANY_KEY as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Ges",
						"Budget200TMP derive(KPI = \"Churn\") ~> derivedColumn1",
						"Budget200TMP derive(KPI = \"Endbestand\") ~> derivedColumn2",
						"Budget200TMP derive(KPI = \"New-Joiner\") ~> derivedColumn3",
						"Budget200TMP derive(KPI = \"AB\") ~> derivedColumn4",
						"derivedColumn4 filter(AB != toDecimal(0)) ~> filter1",
						"derivedColumn3 filter({New-Joiner} != toDecimal(0)) ~> filter2",
						"derivedColumn2 filter(Endbestand != toDecimal(0)) ~> filter3",
						"derivedColumn1 filter(Churn != toDecimal(0)) ~> filter4",
						"filter4 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          COMPANY as string,",
						"          KPI as string,",
						"          FUNCTION as string,",
						"          PERIOD as string,",
						"          BUDGET_HC as decimal(27,4),",
						"          BUDGET_FTE as decimal(27,4)",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          COMPANY,",
						"          FUNCTION,",
						"          PERIOD,",
						"          KPI,",
						"          BUDGET_FTE = Churn",
						"     )) ~> sink2",
						"filter3 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          COMPANY as string,",
						"          KPI as string,",
						"          FUNCTION as string,",
						"          PERIOD as string,",
						"          BUDGET_HC as decimal(27,4),",
						"          BUDGET_FTE as decimal(27,4)",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          COMPANY,",
						"          KPI,",
						"          FUNCTION,",
						"          PERIOD,",
						"          BUDGET_FTE = Endbestand",
						"     )) ~> sink3",
						"filter2 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          COMPANY as string,",
						"          KPI as string,",
						"          FUNCTION as string,",
						"          PERIOD as string,",
						"          BUDGET_HC as decimal(27,4),",
						"          BUDGET_FTE as decimal(27,4)",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          COMPANY,",
						"          KPI,",
						"          FUNCTION,",
						"          PERIOD,",
						"          BUDGET_FTE = {New-Joiner}",
						"     )) ~> sink4",
						"filter1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          COMPANY as string,",
						"          KPI as string,",
						"          FUNCTION as string,",
						"          PERIOD as string,",
						"          BUDGET_HC as decimal(27,4),",
						"          BUDGET_FTE as decimal(27,4)",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          COMPANY,",
						"          KPI,",
						"          FUNCTION,",
						"          PERIOD,",
						"          BUDGET_FTE = AB",
						"     )) ~> sink5"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/200_PERSONELL_BUDGET_TMP')]",
				"[concat(variables('factoryId'), '/datasets/200_CompanyTranslation')]",
				"[concat(variables('factoryId'), '/datasets/400_Personell_Budget')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_PERSONELL_DATA')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "200_Personio_Data",
								"type": "DatasetReference"
							},
							"name": "PersonioBasis"
						},
						{
							"dataset": {
								"referenceName": "D_PERIOD",
								"type": "DatasetReference"
							},
							"name": "PERIODE"
						},
						{
							"dataset": {
								"referenceName": "400_TRANSLATION",
								"type": "DatasetReference"
							},
							"name": "Uebersetzung"
						},
						{
							"dataset": {
								"referenceName": "400_TRANSLATION",
								"type": "DatasetReference"
							},
							"name": "Uebersetzung2"
						},
						{
							"dataset": {
								"referenceName": "200_CompanyTranslation",
								"type": "DatasetReference"
							},
							"name": "Companytranslations"
						},
						{
							"dataset": {
								"referenceName": "Merge_Employees",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "400_PERSONELL_DATA",
								"type": "DatasetReference"
							},
							"name": "PersonellData"
						}
					],
					"transformations": [
						{
							"name": "BerechnungenVorab"
						},
						{
							"name": "Aggregation"
						},
						{
							"name": "BerechnungenNachAggregat"
						},
						{
							"name": "BerechnungenVorabTeil2"
						},
						{
							"name": "SuchePeriode"
						},
						{
							"name": "BerechnungenNachAggregationTeil2"
						},
						{
							"name": "AktiveMA"
						},
						{
							"name": "GroupChange"
						},
						{
							"name": "LookUebersetzung"
						},
						{
							"name": "lookGender"
						},
						{
							"name": "lookAnstArt"
						},
						{
							"name": "lookExitType"
						},
						{
							"name": "filter0"
						},
						{
							"name": "SucheGesKurz"
						},
						{
							"name": "join1"
						},
						{
							"name": "derivedColumn1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          STATUS as string,",
						"          ID as string,",
						"          MAILADDRESS as string,",
						"          FIRSTNAME as string,",
						"          LASTNAME as string,",
						"          DEPARTMENT as string,",
						"          AGE as decimal(27,4),",
						"          HIRED_AS as string,",
						"          HIRE_DATE as date,",
						"          EMPLOYMENT_TYPE as string,",
						"          EMPLOYEE_GROUPS_BY_FUNCTION as string,",
						"          EXIT_TYPE as string,",
						"          EXIT_TYPE_2 as string,",
						"          LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD as date,",
						"          PLACE_OF_BUSINESS as string,",
						"          LENGTH_OF_EMPLOYMENT_IN_YEARS as decimal(27,4),",
						"          ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD as date,",
						"          END_OF_EMPLOYMENT as date,",
						"          FIRST_ENTRY_DATE as date,",
						"          FTE as decimal(27,4),",
						"          GENDER as string,",
						"          COMPANY as string,",
						"          DEGREE_OF_SEVERE_DISABILITY as string,",
						"          COST_CENTRE as string,",
						"          TERMINATION_DATE as date,",
						"          REASON_FOR_TERMINATION as string,",
						"          NUMBER_OF_EMPLOYEES_STATUS_ACTIVE_AND_TIME_OFF as decimal(27,4),",
						"          DATEV_PERSONNEL_NUMBER as string,",
						"          POSITION as string,",
						"          WEEKLY_HOURS as decimal(27,4),",
						"          LOAD_PERIOD as string,",
						"          LOAD_TIME as timestamp,",
						"          BAD_CHURN as string,",
						"          ACCIDENT_AT_WORK as string,",
						"          WORKRELATED_DEATH as string,",
						"          COMPANY_KEY as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> PersonioBasis",
						"source(output(",
						"          DP_PERIOD_ID as integer,",
						"          DP_PERIOD as string,",
						"          DP_START_DATE as date,",
						"          DP_END_DATE as date",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> PERIODE",
						"source(output(",
						"          DATAAREA as string,",
						"          SRC_VALUE as string,",
						"          TRANSLATION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Uebersetzung",
						"source(output(",
						"          DATAAREA as string,",
						"          SRC_VALUE as string,",
						"          TRANSLATION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Uebersetzung2",
						"source(output(",
						"          COMPANY as string,",
						"          COMPANY_KEY as string,",
						"          VALID_TO as integer,",
						"          VALID_FROM as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Companytranslations",
						"source(output(",
						"          LOAD_PERIOD as string,",
						"          ID as string,",
						"          EXIT_TYPE as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false) ~> source1",
						"lookExitType derive(LengthOfEmploymentRounded = iif(isNull(LENGTH_OF_EMPLOYMENT_IN_YEARS), toInteger(0), toInteger(round(LENGTH_OF_EMPLOYMENT_IN_YEARS, 0))),",
						"          AgeRounded = iif( isNull(AGE), toInteger(0), toInteger(round(AGE, 0))),",
						"          Jahr = substring(PersonioBasis@LOAD_PERIOD, 1, 4),",
						"          Monat = substring(PersonioBasis@LOAD_PERIOD, 5, 2),",
						"          HCNewHires = iif(\r",
						"    ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE \r",
						"    && ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE \r",
						"    && GroupChange == false() \r",
						"    && \r",
						"        (\r",
						"                isNull(EXIT_TYPE) \r",
						"            || \r",
						"                EXIT_TYPE != \"Verschmelzung\"\r",
						"            ||\r",
						"                ( EXIT_TYPE == \"Verschmelzung\" && toString(LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD, \"YYYYMM\") == toString(ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD, \"YYYYMM\") )\r",
						"        )\r",
						"    , \r",
						"        toDecimal('1')\r",
						"    , \r",
						"        toDecimal('0') \r",
						"),",
						"          HCNewHiresGroupChange = iif(ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE && ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE && ( EXIT_TYPE != 'Verschmelzung' || isNull(EXIT_TYPE)) , toDecimal('1'), toDecimal('0') ),",
						"          HCLeavers = iif( LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE &&  LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE  && GroupChange == false() && (isNull(EXIT_TYPE) || EXIT_TYPE != \"Verschmelzung\"), toDecimal('1'), toDecimal('0')),",
						"          HCLeaversGroupChange = iif( LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE &&  LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE && ( EXIT_TYPE != 'Verschmelzung' || isNull(EXIT_TYPE) ) , toDecimal('1'), toDecimal('0')),",
						"          Geschlecht = iif(GENDER  == \"\" || isNull(GENDER), \"N/A\", \r",
						"     iif(isNull(Uebersetzung@TRANSLATION), GENDER, Uebersetzung@TRANSLATION)\r",
						"),",
						"          ExitType = iif(isNull(EXIT_TYPE)||EXIT_TYPE == \"\" || EXIT_TYPE == \"0\", \"\", iif( isNull(Uebersetzung2@TRANSLATION), EXIT_TYPE, Uebersetzung2@TRANSLATION ))) ~> BerechnungenVorab",
						"BerechnungenVorabTeil2 aggregate(groupBy(DEPARTMENT,",
						"          AgeRounded,",
						"          HiredAs,",
						"          PLACE_OF_BUSINESS,",
						"          LengthOfEmploymentRounded,",
						"          Geschlecht,",
						"          PersonioBasis@COMPANY_KEY,",
						"          DEGREE_OF_SEVERE_DISABILITY,",
						"          COST_CENTRE,",
						"          PersonioBasis@LOAD_PERIOD,",
						"          DP_PERIOD_ID,",
						"          Jahr,",
						"          Monat,",
						"          EmployeeGroupFunction,",
						"          ExitType,",
						"          GroupChange),",
						"     StartCountEmployees = sum(AktiveMA),",
						"          EndCountEmployeesInclGroupChange = sum(AktiveMAInclGroupChange),",
						"          EndCountFTEInclGroupChange = sum(FTEEmployeesEndInclGroupChange),",
						"          HCNewHires = sum(HCNewHires),",
						"          HCNewHiresGroupChange = sum(HCNewHiresGroupChange),",
						"          HCLeavers = sum(HCLeavers),",
						"          HCLeaversGroupChange = sum(HCLeaversGroupChange),",
						"          FTEEmployeesStart = sum(FTEEmployeesEnd),",
						"          FTENewHires = sum(FTENewHires),",
						"          FTENewHiresGroupChange = sum(FTENewHiresGroupChange),",
						"          FTELeavers = sum(FTELeavers),",
						"          FTELeaversGroupChange = sum(FTELeaversGroupChange),",
						"          HCChurn = sum(HCChurn),",
						"          BadChurn = sum(BadChurn),",
						"          AccidentAtWork = sum(AccidentAtWork),",
						"          WorkRelDeath = sum(WorkRelatedFatalities),",
						"          DisabledHC = sum(DisabledHC),",
						"          DisabledFTE = sum(DisabledFTE)) ~> Aggregation",
						"Aggregation derive(Operative = iif( \r",
						"    locate('EXPERTS', upper(EmployeeGroupFunction), 1) > 0 \r",
						"    || locate('CONSULTANTS', upper(EmployeeGroupFunction), 1) > 0 \r",
						"    || locate('PROFESSIONALS', upper(EmployeeGroupFunction), 1) > 0, \r",
						"    'Operative', \r",
						"    'Non Operative'\r",
						"),",
						"          KST = toString(null()),",
						"          Position = toString(null()),",
						"          HCEmployeesEnd = StartCountEmployees -  HCLeavers + HCNewHires,",
						"          HCEmployeesStartInclGroupChange = EndCountEmployeesInclGroupChange +  HCLeaversGroupChange - HCNewHiresGroupChange) ~> BerechnungenNachAggregat",
						"BerechnungenVorab derive(FTEEmployeesEnd = AktiveMA * FTE,",
						"          FTEEmployeesEndInclGroupChange = AktiveMAInclGroupChange * FTE,",
						"          FTENewHires = HCNewHires * FTE,",
						"          FTENewHiresGroupChange = HCNewHiresGroupChange * FTE,",
						"          FTELeavers = HCLeavers * FTE,",
						"          FTELeaversGroupChange = HCLeaversGroupChange * FTE,",
						"          HCChurn = HCLeavers,",
						"          BadChurn = case(isNull(BAD_CHURN) , toDecimal(0, 18, 4), \r",
						"     BAD_CHURN == \"Nein\", toDecimal(0, 18, 4), \r",
						"     BAD_CHURN == \"No\", toDecimal(0, 18, 4), \r",
						"      BAD_CHURN == \"0\", toDecimal(0, 18, 4), \r",
						"      BAD_CHURN == \"Ja\" && HCLeavers == 1, toDecimal(1, 18, 4),\r",
						"      BAD_CHURN == \"Yes\" && HCLeavers == 1, toDecimal(1, 18, 4),\r",
						"      BAD_CHURN == \"1\" && HCLeavers == 1, toDecimal(1, 18, 4)),",
						"          EmployeeGroupFunction = replace(EMPLOYEE_GROUPS_BY_FUNCTION, \"A¼\", \"ü\"),",
						"          HiredAs = replace(replace(HIRED_AS, \"A¼\", \"ü\"), \"A¤\", \"ä\"),",
						"          DisabledHC = iif(DEGREE_OF_SEVERE_DISABILITY == \"Ja\" || DEGREE_OF_SEVERE_DISABILITY == \"mind. 50%\", AktiveMAInclGroupChange, toDecimal(0, 1, 0)),",
						"          DisabledFTE = iif(DEGREE_OF_SEVERE_DISABILITY == \"Ja\" || DEGREE_OF_SEVERE_DISABILITY == \"mind. 50%\", AktiveMAInclGroupChange * FTE, toDecimal(0, 1, 0)),",
						"          AccidentAtWork = iif(ACCIDENT_AT_WORK == \"Ja\", AktiveMAInclGroupChange, toDecimal(0, 1, 0)),",
						"          WorkRelatedFatalities = iif(WORKRELATED_DEATH == \"Ja\", AktiveMAInclGroupChange, toDecimal(0, 1, 0))) ~> BerechnungenVorabTeil2",
						"filter0, PERIODE lookup(PersonioBasis@LOAD_PERIOD == DP_PERIOD,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> SuchePeriode",
						"lookAnstArt derive(FTEEmployeesEnd = FTEEmployeesStart - FTELeavers + FTENewHires,",
						"          FTEEmployeesStartInclGroupChange = EndCountFTEInclGroupChange + FTELeaversGroupChange - FTENewHiresGroupChange,",
						"          FPR_PERMANENT_EMPLOYEES_FLAG = case(\r",
						"    left(HiredAs, 14) == \"Festangestellt\", true(), \r",
						"    left(HiredAs, 10) == \"Angestellt\", true(), \r",
						"    left(HiredAs, 13) == \"IT-Consultant\", true(),\r",
						"    left(HiredAs, 9) == \"IT-Expert\", true(),\r",
						"    left(HiredAs, 9) == \"Permanent\", true(),\r",
						"    false()\r",
						"),",
						"          PeriodDate = toDate(concat(LOAD_PERIOD, toString( lastDayOfMonth( toDate(concat(LOAD_PERIOD, \"01\"), \"yyyy-MM-dd\" )), \"dd\")), \"yyyy-MM-dd\"),",
						"          HiredAsText = iif( isNull(HiredAs) || HiredAs == \"\", \"no Hired As Information\", iif(isNull(Uebersetzung2@TRANSLATION), HiredAs, Uebersetzung2@TRANSLATION)),",
						"          EmployeeGroupFunctionText = iif( isNull(EmployeeGroupFunction) || EmployeeGroupFunction == \"\", \"no Function Information\", \r",
						"    iif( isNull(Uebersetzung@TRANSLATION),  EmployeeGroupFunction, Uebersetzung@TRANSLATION)\r",
						"    )) ~> BerechnungenNachAggregationTeil2",
						"GroupChange derive(AktiveMA = iif( ( isNull(LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD) || LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE || ( LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE && LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE && GroupChange == true() ) ) && \r",
						"         ( \r",
						"               ( isNull(ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD) || ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD < DP_START_DATE ) \r",
						"               || \r",
						"               ( \r",
						"\r",
						"                    ( \r",
						"                         ( \r",
						"                              EXIT_TYPE == \"Verschmelzung\" \r",
						"                              && \r",
						"                                   (\r",
						"                                        left(toString(LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD), 7) != left(toString(ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD), 7) \r",
						"                                        ||\r",
						"                                        isNull(LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD)\r",
						"                                   )\r",
						"                              \r",
						"                         ) \r",
						"                         || \r",
						"                         (GroupChange == true() && !(ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD < DP_END_DATE && ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD > DP_START_DATE ))\r",
						"                    )  \r",
						"               )  \r",
						"          ) , \r",
						"            toDecimal(1) , \r",
						"            toDecimal(0)\r",
						"   ),",
						"          AktiveMAInclGroupChange = iif( \r",
						"    ( ( isNull(LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD) || LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD > DP_END_DATE ) || ( LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD == DP_END_DATE && EXIT_TYPE == 'Verschmelzung')  ) \r",
						"    && ( isNull(ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD) || ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE ) , \r",
						"        toDecimal(1) , \r",
						"        toDecimal(0)\r",
						")) ~> AktiveMA",
						"SucheGesKurz derive(GroupChange = case(   EXIT_TYPE == \"Gesellschaftswechsel\", true(), \r",
						"        EXIT_TYPE == \"GROUP-Wechsel\", true(), \r",
						"        EXIT_TYPE == \"GROUP-Wechsel Abgang\", true(), \r",
						"        EXIT_TYPE == \"GROUP-Wechsel Zugang\", true(), \r",
						"        EXIT_TYPE == \"subcompany-switch\", true(),\r",
						"    false())) ~> GroupChange",
						"BerechnungenNachAggregat, Uebersetzung lookup(EmployeeGroupFunction == SRC_VALUE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookUebersetzung",
						"AktiveMA, Uebersetzung lookup(GENDER == SRC_VALUE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookGender",
						"LookUebersetzung, Uebersetzung2 lookup(HiredAs == Uebersetzung2@SRC_VALUE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookAnstArt",
						"lookGender, Uebersetzung2 lookup(EXIT_TYPE == Uebersetzung2@SRC_VALUE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookExitType",
						"derivedColumn1 filter(COMPANY != '0') ~> filter0",
						"SuchePeriode, Companytranslations lookup(PersonioBasis@COMPANY == Companytranslations@COMPANY,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'right')~> SucheGesKurz",
						"PersonioBasis, source1 join(PersonioBasis@LOAD_PERIOD == source1@LOAD_PERIOD",
						"     && PersonioBasis@ID == source1@ID,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join1",
						"join1 derive(EXIT_TYPE = iif(isNull(source1@EXIT_TYPE) || source1@EXIT_TYPE == '', PersonioBasis@EXIT_TYPE, source1@EXIT_TYPE),",
						"          LOAD_PERIOD_INT = toInteger(PersonioBasis@LOAD_PERIOD)) ~> derivedColumn1",
						"BerechnungenNachAggregationTeil2 sink(allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     input(",
						"          FPR_PERIOD as string,",
						"          FPR_PERIOD_ID as integer,",
						"          FPR_YEAR as string,",
						"          FPR_MONTH as string,",
						"          FPR_GENDER as string,",
						"          FPR_COMPANY as string,",
						"          FPR_PLANT as string,",
						"          FPR_BU as string,",
						"          FPR_POSITION as string,",
						"          FPR_PERMANENT_EMPLOYEE as string,",
						"          FPR_DISABILITY as string,",
						"          FPR_FUNCTION as string,",
						"          FPR_OPERATIVE as string,",
						"          FPR_AGE as integer,",
						"          FPR_TENURE as integer,",
						"          FPR_COSTCENTRE as string,",
						"          FPR_HC_EMPLOYEES_START_PERIOD as decimal(18,4),",
						"          FPR_HC_EMPLOYEES_END_PERIOD as decimal(18,4),",
						"          FPR_HC_NEW_HIRES as decimal(18,4),",
						"          FPR_HC_LEAVERS as decimal(18,4),",
						"          FPR_FTE_EMPLOYEES_START_PERIOD as decimal(18,4),",
						"          FPR_FTE_EMPLOYEES_END_PERIOD as decimal(18,4),",
						"          FPR_FTE_NEW_HIRES as decimal(18,4),",
						"          FPR_FTE_LEAVERS as decimal(18,4),",
						"          FPR_HC_CHURN as decimal(18,4),",
						"          FPR_BAD_CHURN as decimal(18,4),",
						"          FPR_PERMANENT_EMPLOYEES_FLAG as boolean,",
						"          FPR_WORK_REL_INURIES as decimal(18,4),",
						"          FPR_WORK_REL_FATALITIES as decimal(18,4),",
						"          FPR_DISABLED_EMPLOYEES_HC as decimal(18,4),",
						"          FPR_DISABLED_EMPLOYEES_FTE as decimal(18,4),",
						"          FPR_PERIOD_DATE as date,",
						"          FPR_EXIT_TYPE as string,",
						"          FPR_HC_EMPLOYEES_START_PERIOD_INCL_GROUPCHANGE as decimal(18,4),",
						"          FPR_FTE_EMPLOYEES_START_PERIOD_INCL_GROUPCHANGE as decimal(18,4),",
						"          FPR_HC_NEW_HIRES_GROUPCHANGE as decimal(18,4),",
						"          FPR_HC_LEAVERS_GROUPCHANGE as decimal(18,4),",
						"          FPR_FTE_NEW_HIRES_GROUPCHANGE as decimal(18,4),",
						"          FPR_FTE_LEAVERS_GROUPCHANGE as decimal(18,4),",
						"          FPR_GROUPCHANGE as boolean,",
						"          FPR_HC_EMPLOYEES_END_PERIOD_INCL_GROUPCHANGE as decimal(18,4),",
						"          FPR_FTE_EMPLOYEES_END_PERIOD_INCL_GROUPCHANGE as decimal(18,4)",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     preSQLs:[('truncate table [400_DWH].[F_PERSONELL_REPORT]')],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          FPR_PERIOD = LOAD_PERIOD,",
						"          FPR_PERIOD_ID = DP_PERIOD_ID,",
						"          FPR_COSTCENTRE = KST,",
						"          FPR_POSITION = Position,",
						"          FPR_YEAR = Jahr,",
						"          FPR_MONTH = Monat,",
						"          FPR_GENDER = Geschlecht,",
						"          FPR_COMPANY = COMPANY_KEY,",
						"          FPR_PLANT = PLACE_OF_BUSINESS,",
						"          FPR_BU = DEPARTMENT,",
						"          FPR_PERMANENT_EMPLOYEE = HiredAsText,",
						"          FPR_DISABILITY = DEGREE_OF_SEVERE_DISABILITY,",
						"          FPR_FUNCTION = EmployeeGroupFunctionText,",
						"          FPR_OPERATIVE = Operative,",
						"          FPR_AGE = AgeRounded,",
						"          FPR_TENURE = LengthOfEmploymentRounded,",
						"          FPR_HC_EMPLOYEES_START_PERIOD = StartCountEmployees,",
						"          FPR_HC_EMPLOYEES_END_PERIOD = HCEmployeesEnd,",
						"          FPR_HC_EMPLOYEES_END_PERIOD_INCL_GROUPCHANGE = EndCountEmployeesInclGroupChange,",
						"          FPR_FTE_EMPLOYEES_END_PERIOD_INCL_GROUPCHANGE = EndCountFTEInclGroupChange,",
						"          FPR_HC_NEW_HIRES = HCNewHires,",
						"          FPR_HC_LEAVERS = HCLeavers,",
						"          FPR_FTE_EMPLOYEES_START_PERIOD = FTEEmployeesStart,",
						"          FPR_FTE_EMPLOYEES_END_PERIOD = FTEEmployeesEnd,",
						"          FPR_FTE_NEW_HIRES = FTENewHires,",
						"          FPR_FTE_LEAVERS = FTELeavers,",
						"          FPR_HC_CHURN = HCChurn,",
						"          FPR_BAD_CHURN = BadChurn,",
						"          FPR_PERMANENT_EMPLOYEES_FLAG,",
						"          FPR_WORK_REL_INURIES = AccidentAtWork,",
						"          FPR_WORK_REL_FATALITIES = WorkRelDeath,",
						"          FPR_DISABLED_EMPLOYEES_HC = DisabledHC,",
						"          FPR_DISABLED_EMPLOYEES_FTE = DisabledFTE,",
						"          FPR_PERIOD_DATE = PeriodDate,",
						"          FPR_EXIT_TYPE = ExitType,",
						"          FPR_HC_EMPLOYEES_START_PERIOD_INCL_GROUPCHANGE = HCEmployeesStartInclGroupChange,",
						"          FPR_FTE_EMPLOYEES_START_PERIOD_INCL_GROUPCHANGE = FTEEmployeesStartInclGroupChange,",
						"          FPR_HC_NEW_HIRES_GROUPCHANGE = HCNewHiresGroupChange,",
						"          FPR_HC_LEAVERS_GROUPCHANGE = HCLeaversGroupChange,",
						"          FPR_FTE_NEW_HIRES_GROUPCHANGE = FTENewHiresGroupChange,",
						"          FPR_FTE_LEAVERS_GROUPCHANGE = FTELeaversGroupChange",
						"     )) ~> PersonellData"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/200_Personio_Data')]",
				"[concat(variables('factoryId'), '/datasets/D_PERIOD')]",
				"[concat(variables('factoryId'), '/datasets/400_TRANSLATION')]",
				"[concat(variables('factoryId'), '/datasets/200_CompanyTranslation')]",
				"[concat(variables('factoryId'), '/datasets/Merge_Employees')]",
				"[concat(variables('factoryId'), '/datasets/400_PERSONELL_DATA')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_PERSONELL_DATA_PYTHON')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "200_STG_SEM",
								"type": "DatasetReference"
							},
							"name": "PersonioBasis"
						},
						{
							"dataset": {
								"referenceName": "D_PERIOD",
								"type": "DatasetReference"
							},
							"name": "PERIODE"
						},
						{
							"dataset": {
								"referenceName": "400_TRANSLATION",
								"type": "DatasetReference"
							},
							"name": "Uebersetzung"
						},
						{
							"dataset": {
								"referenceName": "400_TRANSLATION",
								"type": "DatasetReference"
							},
							"name": "Uebersetzung2"
						},
						{
							"dataset": {
								"referenceName": "200_CompanyTranslation",
								"type": "DatasetReference"
							},
							"name": "Companytranslations"
						},
						{
							"dataset": {
								"referenceName": "Merge_Employees",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "400_DWH_FAP",
								"type": "DatasetReference"
							},
							"name": "PersonellData"
						}
					],
					"transformations": [
						{
							"name": "BerechnungenVorab"
						},
						{
							"name": "Aggregation"
						},
						{
							"name": "BerechnungenNachAggregat"
						},
						{
							"name": "BerechnungenVorabTeil2"
						},
						{
							"name": "SuchePeriode"
						},
						{
							"name": "BerechnungenNachAggregationTeil2"
						},
						{
							"name": "AktiveMA"
						},
						{
							"name": "GroupChange"
						},
						{
							"name": "LookUebersetzung"
						},
						{
							"name": "lookGender"
						},
						{
							"name": "lookAnstArt"
						},
						{
							"name": "lookExitType"
						},
						{
							"name": "filter0"
						},
						{
							"name": "SucheGesKurz"
						},
						{
							"name": "join1"
						},
						{
							"name": "derivedColumn1"
						},
						{
							"name": "derivedColumn2"
						}
					],
					"scriptLines": [
						"source(output(",
						"          SEM_ID as string,",
						"          SEM_SID as string,",
						"          SEM_VALID_FROM as date,",
						"          SEM_VALID_TO as date,",
						"          SEM_COST_CENTRE as string,",
						"          SEM_COST_CENTER_NAME as string,",
						"          SEM_COST_CENTER_WEIGHT as integer,",
						"          SEM_DEPARTMENT as string,",
						"          SEM_FIRST_ENTRY_DATE as date,",
						"          SEM_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD as date,",
						"          SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD as date,",
						"          SEM_HIRED_AS as string,",
						"          SEM_EMPLOYEE_GROUPS_BY_FUNCTION as string,",
						"          SEM_MAILADDRESS as string,",
						"          SEM_FTE as string,",
						"          SEM_GENDER as string,",
						"          SEM_POSITION as string,",
						"          SEM_COMPANY as string,",
						"          SEM_EXIT_TYPE as string,",
						"          SEM_WEEKLY_HOURS as string,",
						"          SEM_UPLOAD_DATE as timestamp,",
						"          SEM_FIRSTNAME as string,",
						"          SEM_LASTNAME as string,",
						"          SEM_PLACE_OF_BUSINESS as string,",
						"          SEM_DEGREE_OF_SEVERE_DISABILITY as string,",
						"          SEM_DATE_OF_BIRTH as string,",
						"          SEM_BAD_CHURN as string,",
						"          SEM_LOAD_PERIOD as string,",
						"          SEM_AGE as integer,",
						"          SEM_TENURE as integer,",
						"          SEM_START_ACCIDENT_DATE as string,",
						"          SEM_COMPANY_KEY as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> PersonioBasis",
						"source(output(",
						"          DP_PERIOD_ID as integer,",
						"          DP_PERIOD as string,",
						"          DP_START_DATE as date,",
						"          DP_END_DATE as date",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> PERIODE",
						"source(output(",
						"          DATAAREA as string,",
						"          SRC_VALUE as string,",
						"          TRANSLATION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Uebersetzung",
						"source(output(",
						"          DATAAREA as string,",
						"          SRC_VALUE as string,",
						"          TRANSLATION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Uebersetzung2",
						"source(output(",
						"          COMPANY as string,",
						"          COMPANY_KEY as string,",
						"          VALID_TO as integer,",
						"          VALID_FROM as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Companytranslations",
						"source(output(",
						"          LOAD_PERIOD as string,",
						"          ID as string,",
						"          EXIT_TYPE as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false) ~> source1",
						"lookExitType derive(LengthOfEmploymentRounded = iif(isNull(SEM_TENURE), toInteger(0), toInteger(round(SEM_TENURE, 0))),",
						"          Jahr = substring(SEM_LOAD_PERIOD, 1, 4),",
						"          Monat = substring(SEM_LOAD_PERIOD, 5, 2),",
						"          HCNewHires = iif(    SEM_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE     && SEM_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE     && GroupChange == false()     &&         (                isNull(SEM_EXIT_TYPE)             ||                 SEM_EXIT_TYPE != \"Verschmelzung\"            ||                ( SEM_EXIT_TYPE == \"Verschmelzung\" && toString(SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD, \"YYYYMM\") == toString(SEM_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD, \"YYYYMM\") )        )    ,         toDecimal('1')    ,         toDecimal('0') ),",
						"          HCNewHiresGroupChange = iif(SEM_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE && SEM_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE && ( SEM_EXIT_TYPE != 'Verschmelzung' || isNull(SEM_EXIT_TYPE)) , toDecimal('1'), toDecimal('0') ),",
						"          HCNewHiresOnlyGroupChange = iif(\r",
						"  SEM_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE &&\r",
						"  SEM_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE &&\r",
						"  GroupChange,\r",
						"  toDecimal(1),\r",
						"  toDecimal(0)\r",
						"),",
						"          HCLeavers = iif( SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE &&  SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE  && GroupChange == false() && (isNull(SEM_EXIT_TYPE) || SEM_EXIT_TYPE != \"Verschmelzung\"), toDecimal('1'), toDecimal('0')),",
						"          HCLeaversGroupChange = iif( SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE &&  SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE && ( SEM_EXIT_TYPE != 'Verschmelzung' || isNull(SEM_EXIT_TYPE) ) , toDecimal('1'), toDecimal('0')),",
						"          HCLeaversOnlyGroupChange = iif( SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE &&  SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE &&  GroupChange,  toDecimal(1),  toDecimal(0)),",
						"          Geschlecht = iif(SEM_GENDER  == \"\" || isNull(SEM_GENDER), \"N/A\", \r",
						"     iif(isNull(Uebersetzung@TRANSLATION), SEM_GENDER, Uebersetzung@TRANSLATION)\r",
						"),",
						"          ExitType = iif(isNull(SEM_EXIT_TYPE)||SEM_EXIT_TYPE == \"\" || SEM_EXIT_TYPE == \"0\", \"\", iif( isNull(Uebersetzung2@TRANSLATION), SEM_EXIT_TYPE, Uebersetzung2@TRANSLATION )),",
						"          numeric_fte = toDecimal(SEM_FTE)) ~> BerechnungenVorab",
						"BerechnungenVorabTeil2 aggregate(groupBy(DEPARTMENT = SEM_DEPARTMENT,",
						"          AGE = SEM_AGE,",
						"          HiredAs,",
						"          PLACE_OF_BUSINESS = SEM_PLACE_OF_BUSINESS,",
						"          LengthOfEmploymentRounded,",
						"          Geschlecht,",
						"          COMPANY_KEY,",
						"          DEGREE_OF_SEVERE_DISABILITY = SEM_DEGREE_OF_SEVERE_DISABILITY,",
						"          COST_CENTRE = SEM_COST_CENTRE,",
						"          LOAD_PERIOD = SEM_LOAD_PERIOD,",
						"          DP_PERIOD_ID,",
						"          Jahr,",
						"          Monat,",
						"          EmployeeGroupFunction,",
						"          ExitType,",
						"          GroupChange,",
						"          ID = SEM_ID,",
						"          SID = SEM_SID,",
						"          SEM_MAILADDRESS),",
						"     StartCountEmployees = sum(AktiveMA),",
						"          EndCountEmployeesInclGroupChange = sum(AktiveMAInclGroupChange),",
						"          EndCountFTEInclGroupChange = sum(FTEEmployeesEndInclGroupChange),",
						"          HCNewHires = sum(HCNewHires),",
						"          HCNewHiresGroupChange = sum(HCNewHiresGroupChange),",
						"          HCNewHiresOnlyGroupChange = sum(HCNewHiresOnlyGroupChange),",
						"          HCLeavers = sum(HCLeavers),",
						"          HCLeaversGroupChange = sum(HCLeaversGroupChange),",
						"          HCLeaversOnlyGroupChange = sum(HCLeaversOnlyGroupChange),",
						"          FTEEmployeesStart = sum(FTEEmployeesEnd),",
						"          FTENewHires = sum(FTENewHires),",
						"          FTENewHiresGroupChange = sum(FTENewHiresGroupChange),",
						"          FTENewHiresOnlyGroupChange = sum(FTENewHiresOnlyGroupChange),",
						"          FTELeavers = sum(FTELeavers),",
						"          FTELeaversGroupChange = sum(FTELeaversGroupChange),",
						"          FTELeaversOnlyGroupChange = sum(FTELeaversOnlyGroupChange),",
						"          HCChurn = sum(HCChurn),",
						"          BadChurn = sum(BadChurn),",
						"          AccidentAtWork = sum(AccidentAtWork),",
						"          WorkRelDeath = sum(WorkRelatedFatalities),",
						"          DisabledHC = sum(DisabledHC),",
						"          DisabledFTE = sum(DisabledFTE)) ~> Aggregation",
						"Aggregation derive(Operative = iif( \r",
						"    locate('EXPERTS', upper(EmployeeGroupFunction), 1) > 0 \r",
						"    || locate('CONSULTANTS', upper(EmployeeGroupFunction), 1) > 0 \r",
						"    || locate('PROFESSIONALS', upper(EmployeeGroupFunction), 1) > 0, \r",
						"    'Operative', \r",
						"    'Non Operative'\r",
						"),",
						"          KST = toString(null()),",
						"          Position = toString(null()),",
						"          HCEmployeesEnd = StartCountEmployees -  HCLeavers + HCNewHires,",
						"          HCEmployeesStartInclGroupChange = EndCountEmployeesInclGroupChange +  HCLeaversGroupChange - HCNewHiresGroupChange) ~> BerechnungenNachAggregat",
						"BerechnungenVorab derive(FTEEmployeesEnd = AktiveMA * numeric_fte,",
						"          FTEEmployeesEndInclGroupChange = AktiveMAInclGroupChange * numeric_fte,",
						"          FTENewHires = HCNewHires * numeric_fte,",
						"          FTENewHiresGroupChange = HCNewHiresGroupChange * numeric_fte,",
						"          FTENewHiresOnlyGroupChange = HCNewHiresOnlyGroupChange * numeric_fte,",
						"          FTELeavers = HCLeavers * numeric_fte,",
						"          FTELeaversGroupChange = HCLeaversGroupChange * numeric_fte,",
						"          FTELeaversOnlyGroupChange = HCLeaversOnlyGroupChange * numeric_fte,",
						"          HCChurn = HCLeavers,",
						"          BadChurn = case(isNull(SEM_BAD_CHURN) , toDecimal(0, 18, 4), \r",
						"     SEM_BAD_CHURN == \"Nein\", toDecimal(0, 18, 4), \r",
						"     SEM_BAD_CHURN == \"No\", toDecimal(0, 18, 4), \r",
						"      SEM_BAD_CHURN == \"0\", toDecimal(0, 18, 4), \r",
						"      SEM_BAD_CHURN == \"Ja\" && HCLeavers == 1, toDecimal(1, 18, 4),\r",
						"      SEM_BAD_CHURN == \"Yes\" && HCLeavers == 1, toDecimal(1, 18, 4),\r",
						"      SEM_BAD_CHURN == \"1\" && HCLeavers == 1, toDecimal(1, 18, 4)),",
						"          EmployeeGroupFunction = replace(SEM_EMPLOYEE_GROUPS_BY_FUNCTION, \"A¼\", \"ü\"),",
						"          HiredAs = replace(replace(SEM_HIRED_AS, \"A¼\", \"ü\"), \"A¤\", \"ä\"),",
						"          DisabledHC = iif(\r",
						"    isNull(SEM_DEGREE_OF_SEVERE_DISABILITY)\r",
						"    || trim(lower(SEM_DEGREE_OF_SEVERE_DISABILITY)) == ''\r",
						"    || trim(lower(SEM_DEGREE_OF_SEVERE_DISABILITY)) == '0%'\r",
						"    || trim(lower(SEM_DEGREE_OF_SEVERE_DISABILITY)) == '0'\r",
						"    || trim(lower(SEM_DEGREE_OF_SEVERE_DISABILITY)) == '0.00%'\r",
						"    || trim(lower(SEM_DEGREE_OF_SEVERE_DISABILITY)) == 'nein'\r",
						"    || trim(lower(SEM_DEGREE_OF_SEVERE_DISABILITY)) == 'no'\r",
						"    || trim(lower(SEM_DEGREE_OF_SEVERE_DISABILITY)) == '0 %'\r",
						"    || trim(lower(SEM_DEGREE_OF_SEVERE_DISABILITY)) == '0,00%'\r",
						"    || trim(lower(SEM_DEGREE_OF_SEVERE_DISABILITY)) == 'NULL',\r",
						"    \r",
						"    0,\r",
						"    1\r",
						"),",
						"          DisabledFTE = iif(\r",
						"    isNull(SEM_DEGREE_OF_SEVERE_DISABILITY)\r",
						"    || trim(lower(toString(SEM_DEGREE_OF_SEVERE_DISABILITY))) == ''\r",
						"    || trim(lower(toString(SEM_DEGREE_OF_SEVERE_DISABILITY))) == '0%'\r",
						"    || trim(lower(toString(SEM_DEGREE_OF_SEVERE_DISABILITY))) == '0 %'\r",
						"    || trim(lower(toString(SEM_DEGREE_OF_SEVERE_DISABILITY))) == '0'\r",
						"    || trim(lower(toString(SEM_DEGREE_OF_SEVERE_DISABILITY))) == '0.00%'\r",
						"    || trim(lower(toString(SEM_DEGREE_OF_SEVERE_DISABILITY))) == '0,00%'\r",
						"    || trim(lower(toString(SEM_DEGREE_OF_SEVERE_DISABILITY))) == 'nein'\r",
						"    || trim(lower(toString(SEM_DEGREE_OF_SEVERE_DISABILITY))) == 'no'\r",
						"    || trim(lower(toString(SEM_DEGREE_OF_SEVERE_DISABILITY))) == 'null',\r",
						"    toDecimal(0),\r",
						"    toDecimal(AktiveMA) * toDecimal(numeric_fte)\r",
						"),",
						"          AccidentAtWork = /* iif(start_accident_date <> null(), AktiveMAInclGroupChange, toDecimal(0, 1, 0)) */\r",
						"0,",
						"          WorkRelatedFatalities = /* iif(WORKRELATED_DEATH == \"Ja\", AktiveMAInclGroupChange, toDecimal(0, 1, 0)) */\r",
						"0) ~> BerechnungenVorabTeil2",
						"filter0, PERIODE lookup(SEM_LOAD_PERIOD == DP_PERIOD,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> SuchePeriode",
						"lookAnstArt derive(FTEEmployeesEnd = FTEEmployeesStart - FTELeavers + FTENewHires,",
						"          FTEEmployeesStartInclGroupChange = EndCountFTEInclGroupChange + FTELeaversGroupChange - FTENewHiresGroupChange,",
						"          FPR_PERMANENT_EMPLOYEES_FLAG = case(\r",
						"    left(HiredAs, 14) == \"Festangestellt\", true(), \r",
						"    left(HiredAs, 10) == \"Angestellt\", true(), \r",
						"    left(HiredAs, 13) == \"IT-Consultant\", true(),\r",
						"    left(HiredAs, 9) == \"IT-Expert\", true(),\r",
						"    left(HiredAs, 9) == \"Permanent\", true(),\r",
						"    false()\r",
						"),",
						"          PeriodDate = toDate(concat(LOAD_PERIOD, toString( lastDayOfMonth( toDate(concat(LOAD_PERIOD, \"01\"), \"yyyy-MM-dd\" )), \"dd\")), \"yyyy-MM-dd\"),",
						"          HiredAsText = iif( isNull(HiredAs) || HiredAs == \"\", \"no Hired As Information\", iif(isNull(Uebersetzung2@TRANSLATION), HiredAs, Uebersetzung2@TRANSLATION)),",
						"          EmployeeGroupFunctionText = iif( isNull(EmployeeGroupFunction) || EmployeeGroupFunction == \"\", \"no Function Information\", \r",
						"    iif( isNull(Uebersetzung@TRANSLATION),  EmployeeGroupFunction, Uebersetzung@TRANSLATION)\r",
						"    )) ~> BerechnungenNachAggregationTeil2",
						"GroupChange derive(AktiveMA = iif( ( isNull(SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD) || SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE || ( SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE && SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE && GroupChange == true() ) ) && \r",
						"         ( \r",
						"               ( isNull(SEM_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD) || SEM_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD < DP_START_DATE ) \r",
						"               || \r",
						"               ( \r",
						"\r",
						"                    ( \r",
						"                         ( \r",
						"                              SEM_EXIT_TYPE == \"Verschmelzung\" \r",
						"                              && \r",
						"                                   (\r",
						"                                        left(toString(SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD), 7) != left(toString(SEM_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD), 7) \r",
						"                                        ||\r",
						"                                        isNull(SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD)\r",
						"                                   )\r",
						"                              \r",
						"                         ) \r",
						"                         || \r",
						"                         (GroupChange == true() && !(SEM_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD < DP_END_DATE && SEM_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD > DP_START_DATE ))\r",
						"                    )  \r",
						"               )  \r",
						"          ) , \r",
						"            toDecimal(1) , \r",
						"            toDecimal(0)\r",
						"   ),",
						"          AktiveMAInclGroupChange = iif( \r",
						"    ( ( isNull(SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD) || SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD > DP_END_DATE ) || ( SEM_LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD == DP_END_DATE && SEM_EXIT_TYPE == 'Verschmelzung')  ) \r",
						"    && ( isNull(SEM_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD) || SEM_ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE ) , \r",
						"        toDecimal(1) , \r",
						"        toDecimal(0)\r",
						")) ~> AktiveMA",
						"SucheGesKurz derive(GroupChange = case(   SEM_EXIT_TYPE == \"Gesellschaftswechsel\", true(), \r",
						"        SEM_EXIT_TYPE == \"GROUP-Wechsel\", true(), \r",
						"        SEM_EXIT_TYPE == \"GROUP-Wechsel Abgang\", true(), \r",
						"        SEM_EXIT_TYPE == \"GROUP-Wechsel Zugang\", true(), \r",
						"        SEM_EXIT_TYPE == \"subcompany-switch\", true(),\r",
						"    false())) ~> GroupChange",
						"BerechnungenNachAggregat, Uebersetzung lookup(EmployeeGroupFunction == SRC_VALUE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookUebersetzung",
						"AktiveMA, Uebersetzung lookup(SEM_GENDER == SRC_VALUE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookGender",
						"LookUebersetzung, Uebersetzung2 lookup(HiredAs == Uebersetzung2@SRC_VALUE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookAnstArt",
						"lookGender, Uebersetzung2 lookup(SEM_EXIT_TYPE == Uebersetzung2@SRC_VALUE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookExitType",
						"derivedColumn1 filter(SEM_COMPANY != '0') ~> filter0",
						"SuchePeriode, Companytranslations lookup(SEM_COMPANY == COMPANY",
						"     && SEM_LOAD_PERIOD_INT >= VALID_FROM",
						"     && SEM_LOAD_PERIOD_INT <= VALID_TO,",
						"     multiple: true,",
						"     broadcast: 'right',",
						"     pickup: 'any')~> SucheGesKurz",
						"PersonioBasis, source1 join(SEM_LOAD_PERIOD == LOAD_PERIOD",
						"     && SEM_ID == ID,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join1",
						"join1 derive(SEM_EXIT_TYPE = iif(isNull(EXIT_TYPE) || EXIT_TYPE == '', SEM_EXIT_TYPE, EXIT_TYPE),",
						"          SEM_LOAD_PERIOD_INT = toInteger(SEM_LOAD_PERIOD)) ~> derivedColumn1",
						"Companytranslations derive(VALID_TO = toInteger(VALID_TO),",
						"          VALID_FROM = toInteger(VALID_FROM)) ~> derivedColumn2",
						"BerechnungenNachAggregationTeil2 sink(allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          FPR_PERIOD = LOAD_PERIOD,",
						"          FPR_PERIOD_ID = DP_PERIOD_ID,",
						"          FPR_COSTCENTRE = KST,",
						"          FPR_POSITION = Position,",
						"          FPR_YEAR = Jahr,",
						"          FPR_MONTH = Monat,",
						"          FPR_GENDER = Geschlecht,",
						"          FPR_COMPANY = COMPANY_KEY,",
						"          FPR_PLANT = PLACE_OF_BUSINESS,",
						"          FPR_BU = DEPARTMENT,",
						"          FPR_PERMANENT_EMPLOYEE = HiredAsText,",
						"          FPR_DISABILITY = DEGREE_OF_SEVERE_DISABILITY,",
						"          FPR_FUNCTION = EmployeeGroupFunctionText,",
						"          FPR_OPERATIVE = Operative,",
						"          FPR_AGE = AGE,",
						"          FPR_TENURE = LengthOfEmploymentRounded,",
						"          FPR_HC_EMPLOYEES_START_PERIOD = StartCountEmployees,",
						"          FPR_HC_EMPLOYEES_END_PERIOD = HCEmployeesEnd,",
						"          FPR_HC_EMPLOYEES_END_PERIOD_INCL_GROUPCHANGE = EndCountEmployeesInclGroupChange,",
						"          FPR_FTE_EMPLOYEES_END_PERIOD_INCL_GROUPCHANGE = EndCountFTEInclGroupChange,",
						"          FPR_HC_NEW_HIRES = HCNewHires,",
						"          FPR_HC_LEAVERS = HCLeavers,",
						"          FPR_FTE_EMPLOYEES_START_PERIOD = FTEEmployeesStart,",
						"          FPR_FTE_EMPLOYEES_END_PERIOD = FTEEmployeesEnd,",
						"          FPR_FTE_NEW_HIRES = FTENewHires,",
						"          FPR_FTE_LEAVERS = FTELeavers,",
						"          FPR_HC_CHURN = HCChurn,",
						"          FPR_BAD_CHURN = BadChurn,",
						"          FPR_PERMANENT_EMPLOYEES_FLAG,",
						"          FPR_WORK_REL_INURIES = AccidentAtWork,",
						"          FPR_WORK_REL_FATALITIES = WorkRelDeath,",
						"          FPR_DISABLED_EMPLOYEES_HC = DisabledHC,",
						"          FPR_DISABLED_EMPLOYEES_FTE = DisabledFTE,",
						"          FPR_PERIOD_DATE = PeriodDate,",
						"          FPR_EXIT_TYPE = ExitType,",
						"          FPR_HC_EMPLOYEES_START_PERIOD_INCL_GROUPCHANGE = HCEmployeesStartInclGroupChange,",
						"          FPR_FTE_EMPLOYEES_START_PERIOD_INCL_GROUPCHANGE = FTEEmployeesStartInclGroupChange,",
						"          FPR_HC_NEW_HIRES_GROUPCHANGE = HCNewHiresGroupChange,",
						"          FPR_HC_NEW_HIRES_ONLY_GROUPCHANGE = HCNewHiresOnlyGroupChange,",
						"          FPR_HC_LEAVERS_GROUPCHANGE = HCLeaversGroupChange,",
						"          FPR_HC_LEAVERS_ONLY_GROUPCHANGE = HCLeaversOnlyGroupChange,",
						"          FPR_FTE_NEW_HIRES_GROUPCHANGE = FTENewHiresGroupChange,",
						"          FPR_FTE_NEW_HIRES_ONLY_GROUPCHANGE = FTENewHiresOnlyGroupChange,",
						"          FPR_FTE_LEAVERS_GROUPCHANGE = FTELeaversGroupChange,",
						"          FPR_FTE_LEAVERS_ONLY_GROUPCHANGE = FTELeaversOnlyGroupChange,",
						"          SID,",
						"          ID,",
						"          MAILADDRESS = SEM_MAILADDRESS",
						"     )) ~> PersonellData"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/200_STG_SEM')]",
				"[concat(variables('factoryId'), '/datasets/D_PERIOD')]",
				"[concat(variables('factoryId'), '/datasets/400_TRANSLATION')]",
				"[concat(variables('factoryId'), '/datasets/200_CompanyTranslation')]",
				"[concat(variables('factoryId'), '/datasets/Merge_Employees')]",
				"[concat(variables('factoryId'), '/datasets/400_DWH_FAP')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_PERSONELL_DATA_copy1')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"folder": {
					"name": "backup"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "200_Personio_Data",
								"type": "DatasetReference"
							},
							"name": "PersonioBasis"
						},
						{
							"dataset": {
								"referenceName": "D_PERIOD",
								"type": "DatasetReference"
							},
							"name": "PERIODE"
						},
						{
							"dataset": {
								"referenceName": "400_TRANSLATION",
								"type": "DatasetReference"
							},
							"name": "Uebersetzung"
						},
						{
							"dataset": {
								"referenceName": "400_TRANSLATION",
								"type": "DatasetReference"
							},
							"name": "Uebersetzung2"
						},
						{
							"dataset": {
								"referenceName": "200_CompanyTranslation",
								"type": "DatasetReference"
							},
							"name": "Companytranslations"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "400_PERSONELL_DATA",
								"type": "DatasetReference"
							},
							"name": "PersonellData"
						}
					],
					"transformations": [
						{
							"name": "BerechnungenVorab"
						},
						{
							"name": "Aggregation"
						},
						{
							"name": "BerechnungenNachAggregat"
						},
						{
							"name": "BerechnungenVorabTeil2"
						},
						{
							"name": "SuchePeriode"
						},
						{
							"name": "BerechnungenNachAggregationTeil2"
						},
						{
							"name": "AktiveMA"
						},
						{
							"name": "GroupChange"
						},
						{
							"name": "LookUebersetzung"
						},
						{
							"name": "lookGender"
						},
						{
							"name": "lookAnstArt"
						},
						{
							"name": "lookExitType"
						},
						{
							"name": "filter0"
						},
						{
							"name": "SucheGesKurz"
						}
					],
					"scriptLines": [
						"source(output(",
						"          STATUS as string,",
						"          ID as string,",
						"          MAILADDRESS as string,",
						"          FIRSTNAME as string,",
						"          LASTNAME as string,",
						"          DEPARTMENT as string,",
						"          AGE as decimal(27,4),",
						"          HIRED_AS as string,",
						"          HIRE_DATE as date,",
						"          EMPLOYMENT_TYPE as string,",
						"          EMPLOYEE_GROUPS_BY_FUNCTION as string,",
						"          EXIT_TYPE as string,",
						"          EXIT_TYPE_2 as string,",
						"          LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD as date,",
						"          PLACE_OF_BUSINESS as string,",
						"          LENGTH_OF_EMPLOYMENT_IN_YEARS as decimal(27,4),",
						"          ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD as date,",
						"          END_OF_EMPLOYMENT as date,",
						"          FIRST_ENTRY_DATE as date,",
						"          FTE as decimal(27,4),",
						"          GENDER as string,",
						"          COMPANY as string,",
						"          DEGREE_OF_SEVERE_DISABILITY as string,",
						"          COST_CENTRE as string,",
						"          TERMINATION_DATE as date,",
						"          REASON_FOR_TERMINATION as string,",
						"          NUMBER_OF_EMPLOYEES_STATUS_ACTIVE_AND_TIME_OFF as decimal(27,4),",
						"          DATEV_PERSONNEL_NUMBER as string,",
						"          POSITION as string,",
						"          WEEKLY_HOURS as decimal(27,4),",
						"          LOAD_PERIOD as string,",
						"          LOAD_TIME as timestamp,",
						"          BAD_CHURN as string,",
						"          ACCIDENT_AT_WORK as string,",
						"          WORKRELATED_DEATH as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> PersonioBasis",
						"source(output(",
						"          DP_PERIOD_ID as integer,",
						"          DP_PERIOD as string,",
						"          DP_START_DATE as date,",
						"          DP_END_DATE as date",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> PERIODE",
						"source(output(",
						"          DATAAREA as string,",
						"          SRC_VALUE as string,",
						"          TRANSLATION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Uebersetzung",
						"source(output(",
						"          DATAAREA as string,",
						"          SRC_VALUE as string,",
						"          TRANSLATION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Uebersetzung2",
						"source(output(",
						"          COMPANY as string,",
						"          COMPANY_KEY as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Companytranslations",
						"lookExitType derive(LengthOfEmploymentRounded = toInteger(round(LENGTH_OF_EMPLOYMENT_IN_YEARS, 0)),",
						"          AgeRounded = toInteger(round(AGE, 0)),",
						"          Jahr = substring(LOAD_PERIOD, 1, 4),",
						"          Monat = substring(LOAD_PERIOD, 5, 2),",
						"          HCNewHires = iif(ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE && ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE && GroupChange == false() && (isNull(EXIT_TYPE) || EXIT_TYPE != \"Verschmelzung\"), toDecimal('1'), toDecimal('0') ),",
						"          HCNewHiresGroupChange = iif(ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE && ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE && ( EXIT_TYPE != 'Verschmelzung' || isNull(EXIT_TYPE)) , toDecimal('1'), toDecimal('0') ),",
						"          HCLeavers = iif( LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE &&  LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE  && GroupChange == false() && (isNull(EXIT_TYPE) || EXIT_TYPE != \"Verschmelzung\"), toDecimal('1'), toDecimal('0')),",
						"          HCLeaversGroupChange = iif( LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE &&  LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE && ( EXIT_TYPE != 'Verschmelzung' || isNull(EXIT_TYPE) ) , toDecimal('1'), toDecimal('0')),",
						"          Geschlecht = iif(GENDER  == \"\" || isNull(GENDER), \"N/A\", \r",
						"     iif(isNull(Uebersetzung@TRANSLATION), GENDER, Uebersetzung@TRANSLATION)\r",
						"),",
						"          ExitType = iif(isNull(EXIT_TYPE)||EXIT_TYPE == \"\" || EXIT_TYPE == \"0\", \"\", iif( isNull(Uebersetzung2@TRANSLATION), EXIT_TYPE, Uebersetzung2@TRANSLATION ))) ~> BerechnungenVorab",
						"BerechnungenVorabTeil2 aggregate(groupBy(DEPARTMENT,",
						"          AgeRounded,",
						"          HiredAs,",
						"          PLACE_OF_BUSINESS,",
						"          LengthOfEmploymentRounded,",
						"          Geschlecht,",
						"          COMPANY_KEY,",
						"          DEGREE_OF_SEVERE_DISABILITY,",
						"          COST_CENTRE,",
						"          LOAD_PERIOD,",
						"          DP_PERIOD_ID,",
						"          Jahr,",
						"          Monat,",
						"          EmployeeGroupFunction,",
						"          ExitType,",
						"          GroupChange),",
						"     StartCountEmployees = sum(AktiveMA),",
						"          EndCountEmployeesInclGroupChange = sum(AktiveMAInclGroupChange),",
						"          EndCountFTEInclGroupChange = sum(FTEEmployeesEndInclGroupChange),",
						"          HCNewHires = sum(HCNewHires),",
						"          HCNewHiresGroupChange = sum(HCNewHiresGroupChange),",
						"          HCLeavers = sum(HCLeavers),",
						"          HCLeaversGroupChange = sum(HCLeaversGroupChange),",
						"          FTEEmployeesStart = sum(FTEEmployeesEnd),",
						"          FTENewHires = sum(FTENewHires),",
						"          FTENewHiresGroupChange = sum(FTENewHiresGroupChange),",
						"          FTELeavers = sum(FTELeavers),",
						"          FTELeaversGroupChange = sum(FTELeaversGroupChange),",
						"          HCChurn = sum(HCChurn),",
						"          BadChurn = sum(BadChurn),",
						"          AccidentAtWork = sum(AccidentAtWork),",
						"          WorkRelDeath = sum(WorkRelatedFatalities),",
						"          DisabledHC = sum(DisabledHC),",
						"          DisabledFTE = sum(DisabledFTE)) ~> Aggregation",
						"Aggregation derive(Operative = iif( locate('EXPERTS', upper(EmployeeGroupFunction), 1) > 0 || locate('CONSULTANTS', upper(EmployeeGroupFunction), 1) > 0, 'Operative', 'Non Operative'),",
						"          KST = toString(null()),",
						"          Position = toString(null()),",
						"          HCEmployeesEnd = StartCountEmployees -  HCLeavers + HCNewHires,",
						"          HCEmployeesStartInclGroupChange = EndCountEmployeesInclGroupChange +  HCLeaversGroupChange - HCNewHiresGroupChange) ~> BerechnungenNachAggregat",
						"BerechnungenVorab derive(FTEEmployeesEnd = AktiveMA * FTE,",
						"          FTEEmployeesEndInclGroupChange = AktiveMAInclGroupChange * FTE,",
						"          FTENewHires = HCNewHires * FTE,",
						"          FTENewHiresGroupChange = HCNewHiresGroupChange * FTE,",
						"          FTELeavers = HCLeavers * FTE,",
						"          FTELeaversGroupChange = HCLeaversGroupChange * FTE,",
						"          HCChurn = HCLeavers,",
						"          BadChurn = case(isNull(BAD_CHURN) , toDecimal(0, 18, 4), \r",
						"     BAD_CHURN == \"Nein\", toDecimal(0, 18, 4), \r",
						"     BAD_CHURN == \"No\", toDecimal(0, 18, 4), \r",
						"      BAD_CHURN == \"0\", toDecimal(0, 18, 4), \r",
						"      BAD_CHURN == \"Ja\" && HCLeavers == 1, toDecimal(1, 18, 4),\r",
						"      BAD_CHURN == \"Yes\" && HCLeavers == 1, toDecimal(1, 18, 4),\r",
						"      BAD_CHURN == \"1\" && HCLeavers == 1, toDecimal(1, 18, 4)),",
						"          EmployeeGroupFunction = replace(EMPLOYEE_GROUPS_BY_FUNCTION, \"A¼\", \"ü\"),",
						"          HiredAs = replace(replace(HIRED_AS, \"A¼\", \"ü\"), \"A¤\", \"ä\"),",
						"          DisabledHC = iif(DEGREE_OF_SEVERE_DISABILITY == \"Ja\" || DEGREE_OF_SEVERE_DISABILITY == \"mind. 50%\", AktiveMAInclGroupChange, toDecimal(0, 1, 0)),",
						"          DisabledFTE = iif(DEGREE_OF_SEVERE_DISABILITY == \"Ja\" || DEGREE_OF_SEVERE_DISABILITY == \"mind. 50%\", AktiveMAInclGroupChange * FTE, toDecimal(0, 1, 0)),",
						"          AccidentAtWork = iif(ACCIDENT_AT_WORK == \"Ja\", AktiveMA, toDecimal(0, 1, 0)),",
						"          WorkRelatedFatalities = iif(WORKRELATED_DEATH == \"Ja\", AktiveMA, toDecimal(0, 1, 0))) ~> BerechnungenVorabTeil2",
						"filter0, PERIODE lookup(LOAD_PERIOD == DP_PERIOD,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> SuchePeriode",
						"lookAnstArt derive(FTEEmployeesEnd = FTEEmployeesStart - FTELeavers + FTENewHires,",
						"          FTEEmployeesStartInclGroupChange = EndCountFTEInclGroupChange + FTELeaversGroupChange - FTENewHiresGroupChange,",
						"          FPR_PERMANENT_EMPLOYEES_FLAG = case(\r",
						"    left(HiredAs, 14) == \"Festangestellt\", true(), \r",
						"    left(HiredAs, 10) == \"Angestellt\", true(), \r",
						"    left(HiredAs, 13) == \"IT-Consultant\", true(),\r",
						"    left(HiredAs, 9) == \"IT-Expert\", true(),\r",
						"    false()\r",
						"),",
						"          PeriodDate = toDate(concat(LOAD_PERIOD, toString( lastDayOfMonth( toDate(concat(LOAD_PERIOD, \"01\"), \"yyyy-MM-dd\" )), \"dd\")), \"yyyy-MM-dd\"),",
						"          HiredAsText = iif( isNull(HiredAs) || HiredAs == \"\", \"no Hired As Information\", iif(isNull(Uebersetzung2@TRANSLATION), HiredAs, Uebersetzung2@TRANSLATION)),",
						"          EmployeeGroupFunctionText = iif( isNull(EmployeeGroupFunction) || EmployeeGroupFunction == \"\", \"no Function Information\", \r",
						"    iif( isNull(Uebersetzung@TRANSLATION),  EmployeeGroupFunction, Uebersetzung@TRANSLATION)\r",
						"    )) ~> BerechnungenNachAggregationTeil2",
						"GroupChange derive(AktiveMA = iif( ( isNull(LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD) || LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE ) && \r",
						"    ( ( isNull(ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD) || ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD < DP_START_DATE ) || ( ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD == DP_START_DATE && EXIT_TYPE == \"Verschmelzung\" )  ) , \r",
						"        toDecimal(1) , \r",
						"        toDecimal(0)\r",
						"    ),",
						"          AktiveMAInclGroupChange = iif( \r",
						"    ( ( isNull(LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD) || LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD > DP_END_DATE ) || ( LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD == DP_END_DATE && EXIT_TYPE == 'Verschmelzung')  ) \r",
						"    && ( isNull(ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD) || ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE ) , \r",
						"        toDecimal(1) , \r",
						"        toDecimal(0)\r",
						")) ~> AktiveMA",
						"SucheGesKurz derive(GroupChange = case(   EXIT_TYPE == \"Gesellschaftswechsel\", true(), \r",
						"        EXIT_TYPE == \"GROUP-Wechsel\", true(), \r",
						"        EXIT_TYPE == \"GROUP-Wechsel Abgang\", true(), \r",
						"        EXIT_TYPE == \"GROUP-Wechsel Zugang\", true(), \r",
						"    false())) ~> GroupChange",
						"BerechnungenNachAggregat, Uebersetzung lookup(EmployeeGroupFunction == SRC_VALUE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookUebersetzung",
						"AktiveMA, Uebersetzung lookup(GENDER == SRC_VALUE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookGender",
						"LookUebersetzung, Uebersetzung2 lookup(HiredAs == Uebersetzung2@SRC_VALUE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookAnstArt",
						"lookGender, Uebersetzung2 lookup(EXIT_TYPE == Uebersetzung2@SRC_VALUE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookExitType",
						"PersonioBasis filter(COMPANY != '0') ~> filter0",
						"SuchePeriode, Companytranslations lookup(PersonioBasis@COMPANY == Companytranslations@COMPANY,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> SucheGesKurz",
						"BerechnungenNachAggregationTeil2 sink(allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     input(",
						"          FPR_PERIOD as string,",
						"          FPR_PERIOD_ID as integer,",
						"          FPR_YEAR as string,",
						"          FPR_MONTH as string,",
						"          FPR_GENDER as string,",
						"          FPR_COMPANY as string,",
						"          FPR_PLANT as string,",
						"          FPR_BU as string,",
						"          FPR_POSITION as string,",
						"          FPR_PERMANENT_EMPLOYEE as string,",
						"          FPR_DISABILITY as string,",
						"          FPR_FUNCTION as string,",
						"          FPR_OPERATIVE as string,",
						"          FPR_AGE as integer,",
						"          FPR_TENURE as integer,",
						"          FPR_COSTCENTRE as string,",
						"          FPR_HC_EMPLOYEES_START_PERIOD as decimal(18,4),",
						"          FPR_HC_EMPLOYEES_END_PERIOD as decimal(18,4),",
						"          FPR_HC_NEW_HIRES as decimal(18,4),",
						"          FPR_HC_LEAVERS as decimal(18,4),",
						"          FPR_FTE_EMPLOYEES_START_PERIOD as decimal(18,4),",
						"          FPR_FTE_EMPLOYEES_END_PERIOD as decimal(18,4),",
						"          FPR_FTE_NEW_HIRES as decimal(18,4),",
						"          FPR_FTE_LEAVERS as decimal(18,4),",
						"          FPR_HC_CHURN as decimal(18,4),",
						"          FPR_BAD_CHURN as decimal(18,4),",
						"          FPR_PERMANENT_EMPLOYEES_FLAG as boolean,",
						"          FPR_WORK_REL_INURIES as decimal(18,4),",
						"          FPR_WORK_REL_FATALITIES as decimal(18,4),",
						"          FPR_DISABLED_EMPLOYEES_HC as decimal(18,4),",
						"          FPR_DISABLED_EMPLOYEES_FTE as decimal(18,4),",
						"          FPR_PERIOD_DATE as date,",
						"          FPR_EXIT_TYPE as string,",
						"          FPR_HC_EMPLOYEES_START_PERIOD_INCL_GROUPCHANGE as decimal(18,4),",
						"          FPR_FTE_EMPLOYEES_START_PERIOD_INCL_GROUPCHANGE as decimal(18,4),",
						"          FPR_HC_NEW_HIRES_GROUPCHANGE as decimal(18,4),",
						"          FPR_HC_LEAVERS_GROUPCHANGE as decimal(18,4),",
						"          FPR_FTE_NEW_HIRES_GROUPCHANGE as decimal(18,4),",
						"          FPR_FTE_LEAVERS_GROUPCHANGE as decimal(18,4),",
						"          FPR_GROUPCHANGE as boolean,",
						"          FPR_HC_EMPLOYEES_END_PERIOD_INCL_GROUPCHANGE as decimal(18,4),",
						"          FPR_FTE_EMPLOYEES_END_PERIOD_INCL_GROUPCHANGE as decimal(18,4)",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     preSQLs:[('truncate table [400_DWH].[F_PERSONELL_REPORT]')],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          FPR_PERIOD = LOAD_PERIOD,",
						"          FPR_PERIOD_ID = DP_PERIOD_ID,",
						"          FPR_COSTCENTRE = KST,",
						"          FPR_POSITION = Position,",
						"          FPR_YEAR = Jahr,",
						"          FPR_MONTH = Monat,",
						"          FPR_GENDER = Geschlecht,",
						"          FPR_COMPANY = COMPANY_KEY,",
						"          FPR_PLANT = PLACE_OF_BUSINESS,",
						"          FPR_BU = DEPARTMENT,",
						"          FPR_PERMANENT_EMPLOYEE = HiredAsText,",
						"          FPR_DISABILITY = DEGREE_OF_SEVERE_DISABILITY,",
						"          FPR_FUNCTION = EmployeeGroupFunctionText,",
						"          FPR_OPERATIVE = Operative,",
						"          FPR_AGE = AgeRounded,",
						"          FPR_TENURE = LengthOfEmploymentRounded,",
						"          FPR_HC_EMPLOYEES_START_PERIOD = StartCountEmployees,",
						"          FPR_HC_EMPLOYEES_END_PERIOD = HCEmployeesEnd,",
						"          FPR_HC_EMPLOYEES_END_PERIOD_INCL_GROUPCHANGE = EndCountEmployeesInclGroupChange,",
						"          FPR_FTE_EMPLOYEES_END_PERIOD_INCL_GROUPCHANGE = EndCountFTEInclGroupChange,",
						"          FPR_HC_NEW_HIRES = HCNewHires,",
						"          FPR_HC_LEAVERS = HCLeavers,",
						"          FPR_FTE_EMPLOYEES_START_PERIOD = FTEEmployeesStart,",
						"          FPR_FTE_EMPLOYEES_END_PERIOD = FTEEmployeesEnd,",
						"          FPR_FTE_NEW_HIRES = FTENewHires,",
						"          FPR_FTE_LEAVERS = FTELeavers,",
						"          FPR_HC_CHURN = HCChurn,",
						"          FPR_BAD_CHURN = BadChurn,",
						"          FPR_PERMANENT_EMPLOYEES_FLAG,",
						"          FPR_WORK_REL_INURIES = AccidentAtWork,",
						"          FPR_WORK_REL_FATALITIES = WorkRelDeath,",
						"          FPR_DISABLED_EMPLOYEES_HC = DisabledHC,",
						"          FPR_DISABLED_EMPLOYEES_FTE = DisabledFTE,",
						"          FPR_PERIOD_DATE = PeriodDate,",
						"          FPR_EXIT_TYPE = ExitType,",
						"          FPR_HC_EMPLOYEES_START_PERIOD_INCL_GROUPCHANGE = HCEmployeesStartInclGroupChange,",
						"          FPR_FTE_EMPLOYEES_START_PERIOD_INCL_GROUPCHANGE = FTEEmployeesStartInclGroupChange,",
						"          FPR_HC_NEW_HIRES_GROUPCHANGE = HCNewHiresGroupChange,",
						"          FPR_HC_LEAVERS_GROUPCHANGE = HCLeaversGroupChange,",
						"          FPR_FTE_NEW_HIRES_GROUPCHANGE = FTENewHiresGroupChange,",
						"          FPR_FTE_LEAVERS_GROUPCHANGE = FTELeaversGroupChange",
						"     )) ~> PersonellData"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/200_Personio_Data')]",
				"[concat(variables('factoryId'), '/datasets/D_PERIOD')]",
				"[concat(variables('factoryId'), '/datasets/400_TRANSLATION')]",
				"[concat(variables('factoryId'), '/datasets/200_CompanyTranslation')]",
				"[concat(variables('factoryId'), '/datasets/400_PERSONELL_DATA')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_PERSONELL_DATA_from_FEB24')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "200_Personio_Data",
								"type": "DatasetReference"
							},
							"name": "PersonioBasis"
						},
						{
							"dataset": {
								"referenceName": "D_PERIOD",
								"type": "DatasetReference"
							},
							"name": "PERIODE"
						},
						{
							"dataset": {
								"referenceName": "400_TRANSLATION",
								"type": "DatasetReference"
							},
							"name": "Uebersetzung"
						},
						{
							"dataset": {
								"referenceName": "400_TRANSLATION",
								"type": "DatasetReference"
							},
							"name": "Uebersetzung2"
						},
						{
							"dataset": {
								"referenceName": "200_CompanyTranslation",
								"type": "DatasetReference"
							},
							"name": "Companytranslations"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "AzureSqlTable1",
								"type": "DatasetReference"
							},
							"name": "PersonellData"
						}
					],
					"transformations": [
						{
							"name": "BerechnungenVorab"
						},
						{
							"name": "Aggregation"
						},
						{
							"name": "BerechnungenNachAggregat"
						},
						{
							"name": "BerechnungenVorabTeil2"
						},
						{
							"name": "SuchePeriode"
						},
						{
							"name": "BerechnungenNachAggregationTeil2"
						},
						{
							"name": "AktiveMA"
						},
						{
							"name": "GroupChange"
						},
						{
							"name": "LookUebersetzung"
						},
						{
							"name": "lookGender"
						},
						{
							"name": "lookAnstArt"
						},
						{
							"name": "lookExitType"
						},
						{
							"name": "filter0"
						},
						{
							"name": "SucheGesKurz"
						}
					],
					"scriptLines": [
						"source(output(",
						"          STATUS as string,",
						"          ID as string,",
						"          MAILADDRESS as string,",
						"          FIRSTNAME as string,",
						"          LASTNAME as string,",
						"          DEPARTMENT as string,",
						"          AGE as decimal(27,4),",
						"          HIRED_AS as string,",
						"          HIRE_DATE as date,",
						"          EMPLOYMENT_TYPE as string,",
						"          EMPLOYEE_GROUPS_BY_FUNCTION as string,",
						"          EXIT_TYPE as string,",
						"          EXIT_TYPE_2 as string,",
						"          LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD as date,",
						"          PLACE_OF_BUSINESS as string,",
						"          LENGTH_OF_EMPLOYMENT_IN_YEARS as decimal(27,4),",
						"          ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD as date,",
						"          END_OF_EMPLOYMENT as date,",
						"          FIRST_ENTRY_DATE as date,",
						"          FTE as decimal(27,4),",
						"          GENDER as string,",
						"          COMPANY as string,",
						"          DEGREE_OF_SEVERE_DISABILITY as string,",
						"          COST_CENTRE as string,",
						"          TERMINATION_DATE as date,",
						"          REASON_FOR_TERMINATION as string,",
						"          NUMBER_OF_EMPLOYEES_STATUS_ACTIVE_AND_TIME_OFF as decimal(27,4),",
						"          DATEV_PERSONNEL_NUMBER as string,",
						"          POSITION as string,",
						"          WEEKLY_HOURS as decimal(27,4),",
						"          LOAD_PERIOD as string,",
						"          LOAD_TIME as timestamp,",
						"          BAD_CHURN as string,",
						"          ACCIDENT_AT_WORK as string,",
						"          WORKRELATED_DEATH as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> PersonioBasis",
						"source(output(",
						"          DP_PERIOD_ID as integer,",
						"          DP_PERIOD as string,",
						"          DP_START_DATE as date,",
						"          DP_END_DATE as date",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> PERIODE",
						"source(output(",
						"          DATAAREA as string,",
						"          SRC_VALUE as string,",
						"          TRANSLATION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Uebersetzung",
						"source(output(",
						"          DATAAREA as string,",
						"          SRC_VALUE as string,",
						"          TRANSLATION as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Uebersetzung2",
						"source(output(",
						"          COMPANY as string,",
						"          COMPANY_KEY as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Companytranslations",
						"lookExitType derive(LengthOfEmploymentRounded = iif(isNull(LENGTH_OF_EMPLOYMENT_IN_YEARS), toInteger(0), toInteger(round(LENGTH_OF_EMPLOYMENT_IN_YEARS, 0))),",
						"          AgeRounded = iif( isNull(AGE), toInteger(0), toInteger(round(AGE, 0))),",
						"          Jahr = substring(LOAD_PERIOD, 1, 4),",
						"          Monat = substring(LOAD_PERIOD, 5, 2),",
						"          HCNewHires = iif(\r",
						"    ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE \r",
						"    && ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE \r",
						"    && GroupChange == false() \r",
						"    && \r",
						"        (\r",
						"                isNull(EXIT_TYPE) \r",
						"            || \r",
						"                EXIT_TYPE != \"Verschmelzung\"\r",
						"            ||\r",
						"                ( EXIT_TYPE == \"Verschmelzung\" && toString(LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD, \"YYYYMM\") == toString(ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD, \"YYYYMM\") )\r",
						"        )\r",
						"    , \r",
						"        toDecimal('1')\r",
						"    , \r",
						"        toDecimal('0') \r",
						"),",
						"          HCNewHiresGroupChange = iif(ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE && ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE && ( EXIT_TYPE != 'Verschmelzung' || isNull(EXIT_TYPE)) , toDecimal('1'), toDecimal('0') ),",
						"          HCLeavers = iif( LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE &&  LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE  && GroupChange == false() && (isNull(EXIT_TYPE) || EXIT_TYPE != \"Verschmelzung\"), toDecimal('1'), toDecimal('0')),",
						"          HCLeaversGroupChange = iif( LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE &&  LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE && ( EXIT_TYPE != 'Verschmelzung' || isNull(EXIT_TYPE) ) , toDecimal('1'), toDecimal('0')),",
						"          Geschlecht = iif(GENDER  == \"\" || isNull(GENDER), \"N/A\", \r",
						"     iif(isNull(Uebersetzung@TRANSLATION), GENDER, Uebersetzung@TRANSLATION)\r",
						"),",
						"          ExitType = iif(isNull(EXIT_TYPE)||EXIT_TYPE == \"\" || EXIT_TYPE == \"0\", \"\", iif( isNull(Uebersetzung2@TRANSLATION), EXIT_TYPE, Uebersetzung2@TRANSLATION ))) ~> BerechnungenVorab",
						"BerechnungenVorabTeil2 aggregate(groupBy(DEPARTMENT,",
						"          AgeRounded,",
						"          HiredAs,",
						"          PLACE_OF_BUSINESS,",
						"          LengthOfEmploymentRounded,",
						"          Geschlecht,",
						"          COMPANY_KEY,",
						"          DEGREE_OF_SEVERE_DISABILITY,",
						"          COST_CENTRE,",
						"          LOAD_PERIOD,",
						"          DP_PERIOD_ID,",
						"          Jahr,",
						"          Monat,",
						"          EmployeeGroupFunction,",
						"          ExitType,",
						"          GroupChange),",
						"     StartCountEmployees = sum(AktiveMA),",
						"          EndCountEmployeesInclGroupChange = sum(AktiveMAInclGroupChange),",
						"          EndCountFTEInclGroupChange = sum(FTEEmployeesEndInclGroupChange),",
						"          HCNewHires = sum(HCNewHires),",
						"          HCNewHiresGroupChange = sum(HCNewHiresGroupChange),",
						"          HCLeavers = sum(HCLeavers),",
						"          HCLeaversGroupChange = sum(HCLeaversGroupChange),",
						"          FTEEmployeesStart = sum(FTEEmployeesEnd),",
						"          FTENewHires = sum(FTENewHires),",
						"          FTENewHiresGroupChange = sum(FTENewHiresGroupChange),",
						"          FTELeavers = sum(FTELeavers),",
						"          FTELeaversGroupChange = sum(FTELeaversGroupChange),",
						"          HCChurn = sum(HCChurn),",
						"          BadChurn = sum(BadChurn),",
						"          AccidentAtWork = sum(AccidentAtWork),",
						"          WorkRelDeath = sum(WorkRelatedFatalities),",
						"          DisabledHC = sum(DisabledHC),",
						"          DisabledFTE = sum(DisabledFTE)) ~> Aggregation",
						"Aggregation derive(Operative = iif( \r",
						"    locate('EXPERTS', upper(EmployeeGroupFunction), 1) > 0 \r",
						"    || locate('CONSULTANTS', upper(EmployeeGroupFunction), 1) > 0 \r",
						"    || locate('PROFESSIONALS', upper(EmployeeGroupFunction), 1) > 0, \r",
						"    'Operative', \r",
						"    'Non Operative'\r",
						"),",
						"          KST = toString(null()),",
						"          Position = toString(null()),",
						"          HCEmployeesEnd = StartCountEmployees -  HCLeavers + HCNewHires,",
						"          HCEmployeesStartInclGroupChange = EndCountEmployeesInclGroupChange +  HCLeaversGroupChange - HCNewHiresGroupChange) ~> BerechnungenNachAggregat",
						"BerechnungenVorab derive(FTEEmployeesEnd = AktiveMA * FTE,",
						"          FTEEmployeesEndInclGroupChange = AktiveMAInclGroupChange * FTE,",
						"          FTENewHires = HCNewHires * FTE,",
						"          FTENewHiresGroupChange = HCNewHiresGroupChange * FTE,",
						"          FTELeavers = HCLeavers * FTE,",
						"          FTELeaversGroupChange = HCLeaversGroupChange * FTE,",
						"          HCChurn = HCLeavers,",
						"          BadChurn = case(isNull(BAD_CHURN) , toDecimal(0, 18, 4), \r",
						"     BAD_CHURN == \"Nein\", toDecimal(0, 18, 4), \r",
						"     BAD_CHURN == \"No\", toDecimal(0, 18, 4), \r",
						"      BAD_CHURN == \"0\", toDecimal(0, 18, 4), \r",
						"      BAD_CHURN == \"Ja\" && HCLeavers == 1, toDecimal(1, 18, 4),\r",
						"      BAD_CHURN == \"Yes\" && HCLeavers == 1, toDecimal(1, 18, 4),\r",
						"      BAD_CHURN == \"1\" && HCLeavers == 1, toDecimal(1, 18, 4)),",
						"          EmployeeGroupFunction = replace(EMPLOYEE_GROUPS_BY_FUNCTION, \"A¼\", \"ü\"),",
						"          HiredAs = replace(replace(HIRED_AS, \"A¼\", \"ü\"), \"A¤\", \"ä\"),",
						"          DisabledHC = iif(DEGREE_OF_SEVERE_DISABILITY == \"Ja\" || DEGREE_OF_SEVERE_DISABILITY == \"mind. 50%\", AktiveMAInclGroupChange, toDecimal(0, 1, 0)),",
						"          DisabledFTE = iif(DEGREE_OF_SEVERE_DISABILITY == \"Ja\" || DEGREE_OF_SEVERE_DISABILITY == \"mind. 50%\", AktiveMAInclGroupChange * FTE, toDecimal(0, 1, 0)),",
						"          AccidentAtWork = iif(ACCIDENT_AT_WORK == \"Ja\", AktiveMAInclGroupChange, toDecimal(0, 1, 0)),",
						"          WorkRelatedFatalities = iif(WORKRELATED_DEATH == \"Ja\", AktiveMAInclGroupChange, toDecimal(0, 1, 0))) ~> BerechnungenVorabTeil2",
						"filter0, PERIODE lookup(LOAD_PERIOD == DP_PERIOD,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> SuchePeriode",
						"lookAnstArt derive(FTEEmployeesEnd = FTEEmployeesStart - FTELeavers + FTENewHires,",
						"          FTEEmployeesStartInclGroupChange = EndCountFTEInclGroupChange + FTELeaversGroupChange - FTENewHiresGroupChange,",
						"          FPR_PERMANENT_EMPLOYEES_FLAG = case(\r",
						"    left(HiredAs, 14) == \"Festangestellt\", true(), \r",
						"    left(HiredAs, 10) == \"Angestellt\", true(), \r",
						"    left(HiredAs, 13) == \"IT-Consultant\", true(),\r",
						"    left(HiredAs, 9) == \"IT-Expert\", true(),\r",
						"    false()\r",
						"),",
						"          PeriodDate = toDate(concat(LOAD_PERIOD, toString( lastDayOfMonth( toDate(concat(LOAD_PERIOD, \"01\"), \"yyyy-MM-dd\" )), \"dd\")), \"yyyy-MM-dd\"),",
						"          HiredAsText = iif( isNull(HiredAs) || HiredAs == \"\", \"no Hired As Information\", iif(isNull(Uebersetzung2@TRANSLATION), HiredAs, Uebersetzung2@TRANSLATION)),",
						"          EmployeeGroupFunctionText = iif( isNull(EmployeeGroupFunction) || EmployeeGroupFunction == \"\", \"no Function Information\", \r",
						"    iif( isNull(Uebersetzung@TRANSLATION),  EmployeeGroupFunction, Uebersetzung@TRANSLATION)\r",
						"    )) ~> BerechnungenNachAggregationTeil2",
						"GroupChange derive(AktiveMA = iif( ( isNull(LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD) || LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE || ( LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD >= DP_START_DATE && LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE && GroupChange == true() ) ) && \r",
						"         ( \r",
						"               ( isNull(ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD) || ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD < DP_START_DATE ) \r",
						"               || \r",
						"               ( \r",
						"\r",
						"                    ( \r",
						"                         ( \r",
						"                              EXIT_TYPE == \"Verschmelzung\" \r",
						"                              && \r",
						"                                   (\r",
						"                                        left(toString(LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD), 7) != left(toString(ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD), 7) \r",
						"                                        ||\r",
						"                                        isNull(LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD)\r",
						"                                   )\r",
						"                              \r",
						"                         ) \r",
						"                         || \r",
						"                         GroupChange == true() \r",
						"                    )  \r",
						"               )  \r",
						"          ) , \r",
						"            toDecimal(1) , \r",
						"            toDecimal(0)\r",
						"   ),",
						"          AktiveMAInclGroupChange = iif( \r",
						"    ( ( isNull(LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD) || LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD > DP_END_DATE ) || ( LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD == DP_END_DATE && EXIT_TYPE == 'Verschmelzung')  ) \r",
						"    && ( isNull(ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD) || ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD <= DP_END_DATE ) , \r",
						"        toDecimal(1) , \r",
						"        toDecimal(0)\r",
						")) ~> AktiveMA",
						"SucheGesKurz derive(GroupChange = case(   EXIT_TYPE == \"Gesellschaftswechsel\", true(), \r",
						"        EXIT_TYPE == \"GROUP-Wechsel\", true(), \r",
						"        EXIT_TYPE == \"GROUP-Wechsel Abgang\", true(), \r",
						"        EXIT_TYPE == \"GROUP-Wechsel Zugang\", true(),\r",
						"        FIRST_ENTRY_DATE < ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD, true(),\r",
						"    false())) ~> GroupChange",
						"BerechnungenNachAggregat, Uebersetzung lookup(EmployeeGroupFunction == SRC_VALUE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookUebersetzung",
						"AktiveMA, Uebersetzung lookup(GENDER == SRC_VALUE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookGender",
						"LookUebersetzung, Uebersetzung2 lookup(HiredAs == Uebersetzung2@SRC_VALUE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookAnstArt",
						"lookGender, Uebersetzung2 lookup(EXIT_TYPE == Uebersetzung2@SRC_VALUE,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookExitType",
						"PersonioBasis filter(COMPANY != '0' && (LOAD_PERIOD == '202312' || LOAD_PERIOD == '202311')) ~> filter0",
						"SuchePeriode, Companytranslations lookup(PersonioBasis@COMPANY == Companytranslations@COMPANY,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> SucheGesKurz",
						"BerechnungenNachAggregationTeil2 sink(allowSchemaDrift: true,",
						"     validateSchema: true,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     preSQLs:[('truncate table [400_DWH].[F_PERSONELL_REPORT]')],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          FPR_PERIOD = LOAD_PERIOD,",
						"          FPR_PERIOD_ID = DP_PERIOD_ID,",
						"          FPR_COSTCENTRE = KST,",
						"          FPR_POSITION = Position,",
						"          FPR_YEAR = Jahr,",
						"          FPR_MONTH = Monat,",
						"          FPR_GENDER = Geschlecht,",
						"          FPR_COMPANY = COMPANY_KEY,",
						"          FPR_PLANT = PLACE_OF_BUSINESS,",
						"          FPR_BU = DEPARTMENT,",
						"          FPR_PERMANENT_EMPLOYEE = HiredAsText,",
						"          FPR_DISABILITY = DEGREE_OF_SEVERE_DISABILITY,",
						"          FPR_FUNCTION = EmployeeGroupFunctionText,",
						"          FPR_OPERATIVE = Operative,",
						"          FPR_AGE = AgeRounded,",
						"          FPR_TENURE = LengthOfEmploymentRounded,",
						"          FPR_HC_EMPLOYEES_START_PERIOD = StartCountEmployees,",
						"          FPR_HC_EMPLOYEES_END_PERIOD = HCEmployeesEnd,",
						"          FPR_HC_EMPLOYEES_END_PERIOD_INCL_GROUPCHANGE = EndCountEmployeesInclGroupChange,",
						"          FPR_FTE_EMPLOYEES_END_PERIOD_INCL_GROUPCHANGE = EndCountFTEInclGroupChange,",
						"          FPR_HC_NEW_HIRES = HCNewHires,",
						"          FPR_HC_LEAVERS = HCLeavers,",
						"          FPR_FTE_EMPLOYEES_START_PERIOD = FTEEmployeesStart,",
						"          FPR_FTE_EMPLOYEES_END_PERIOD = FTEEmployeesEnd,",
						"          FPR_FTE_NEW_HIRES = FTENewHires,",
						"          FPR_FTE_LEAVERS = FTELeavers,",
						"          FPR_HC_CHURN = HCChurn,",
						"          FPR_BAD_CHURN = BadChurn,",
						"          FPR_PERMANENT_EMPLOYEES_FLAG,",
						"          FPR_WORK_REL_INURIES = AccidentAtWork,",
						"          FPR_WORK_REL_FATALITIES = WorkRelDeath,",
						"          FPR_DISABLED_EMPLOYEES_HC = DisabledHC,",
						"          FPR_DISABLED_EMPLOYEES_FTE = DisabledFTE,",
						"          FPR_PERIOD_DATE = PeriodDate,",
						"          FPR_EXIT_TYPE = ExitType,",
						"          FPR_HC_EMPLOYEES_START_PERIOD_INCL_GROUPCHANGE = HCEmployeesStartInclGroupChange,",
						"          FPR_FTE_EMPLOYEES_START_PERIOD_INCL_GROUPCHANGE = FTEEmployeesStartInclGroupChange,",
						"          FPR_HC_NEW_HIRES_GROUPCHANGE = HCNewHiresGroupChange,",
						"          FPR_HC_LEAVERS_GROUPCHANGE = HCLeaversGroupChange,",
						"          FPR_FTE_NEW_HIRES_GROUPCHANGE = FTENewHiresGroupChange,",
						"          FPR_FTE_LEAVERS_GROUPCHANGE = FTELeaversGroupChange",
						"     )) ~> PersonellData"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/200_Personio_Data')]",
				"[concat(variables('factoryId'), '/datasets/D_PERIOD')]",
				"[concat(variables('factoryId'), '/datasets/400_TRANSLATION')]",
				"[concat(variables('factoryId'), '/datasets/200_CompanyTranslation')]",
				"[concat(variables('factoryId'), '/datasets/AzureSqlTable1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/400_TRANSLATIONS')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "200_TRANSLATIONS",
								"type": "DatasetReference"
							},
							"name": "quelleUebersetzungen"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "400_TRANSLATION",
								"type": "DatasetReference"
							},
							"name": "zielUEbersetzungen"
						}
					],
					"transformations": [
						{
							"name": "unpivot"
						}
					],
					"scriptLines": [
						"source(output(",
						"          Bereich as string,",
						"          Deutsch as string,",
						"          Deutsch_kurz as string,",
						"          Englisch as string,",
						"          {für PowerBi } as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> quelleUebersetzungen",
						"quelleUebersetzungen unpivot(output(",
						"          QuellFeld as string,",
						"          Quellwert as string",
						"     ),",
						"     ungroupBy(Bereich,",
						"          {für PowerBi }),",
						"     lateral: false,",
						"     ignoreNullPivots: true) ~> unpivot",
						"unpivot sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          DATAAREA as string,",
						"          SRC_VALUE as string,",
						"          TRANSLATION as string",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     truncate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          DATAAREA = Bereich,",
						"          SRC_VALUE = Quellwert,",
						"          TRANSLATION = {für PowerBi }",
						"     )) ~> zielUEbersetzungen"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/200_TRANSLATIONS')]",
				"[concat(variables('factoryId'), '/datasets/400_TRANSLATION')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Add Age Calculation')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "200_STG_SAE",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "200_STG_SAE",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "derivedColumn1"
						},
						{
							"name": "Zeilenaendern"
						}
					],
					"scriptLines": [
						"source(output(",
						"          SID as string,",
						"          ID as integer,",
						"          VALID_FROM as date,",
						"          VALID_TO as date,",
						"          COST_CENTRE as integer,",
						"          cost_center_name as string,",
						"          cost_center_weight as short,",
						"          DEPARTMENT as string,",
						"          FIRST_ENTRY_DATE as date,",
						"          ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD as date,",
						"          LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD as date,",
						"          HIRED_AS as string,",
						"          EMPLOYEE_GROUPS_BY_FUNCTION as string,",
						"          MAILADDRESS as string,",
						"          FTE as string,",
						"          GENDER as string,",
						"          POSITION as string,",
						"          COMPANY as string,",
						"          EXIT_TYPE as string,",
						"          WEEKLY_HOURS as string,",
						"          upload_date as timestamp,",
						"          FIRSTNAME as string,",
						"          LASTNAME as string,",
						"          PLACE_OF_BUSINESS as string,",
						"          DEGREE_OF_SEVERE_DISABILITY as string,",
						"          DATE_OF_BIRTH as string,",
						"          LOAD_PERIOD as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source1",
						"source1 derive(AGE_Calculated = /* round(minus( */\r",
						"    /* toTimestamp(concat(LOAD_PERIOD, '-01'), 'yyyy-MM-dd') */\r",
						"round(minus(toTimestamp(concat(substring(LOAD_PERIOD, 0, 4),'-', substring(LOAD_PERIOD, 5, 6),'-01'), 'yyyy-MM-dd'), \r",
						"     toTimestamp(DATE_OF_BIRTH, 'yyyy-MM-dd'))  / 1000 / 60 / 60 / 24 / 365.25, 0, 2) \r",
						"/* toInteger(age) */,",
						"          Length_of_Employment = round(minus(toDate(concat(LOAD_PERIOD, '-01'), 'yyyy-MM-dd'), FIRST_ENTRY_DATE)/365, 0, 2)\r",
						"/* toInteger(age) */,",
						"          numeric_fte = toDecimal(FTE)) ~> derivedColumn1",
						"derivedColumn1 alterRow(updateIf(true())) ~> Zeilenaendern",
						"Zeilenaendern sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          SID,",
						"          ID,",
						"          VALID_FROM,",
						"          VALID_TO,",
						"          COST_CENTRE,",
						"          cost_center_name,",
						"          cost_center_weight,",
						"          DEPARTMENT,",
						"          FIRST_ENTRY_DATE,",
						"          ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD,",
						"          LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD,",
						"          HIRED_AS,",
						"          EMPLOYEE_GROUPS_BY_FUNCTION,",
						"          MAILADDRESS,",
						"          FTE,",
						"          GENDER,",
						"          POSITION,",
						"          COMPANY,",
						"          EXIT_TYPE,",
						"          WEEKLY_HOURS,",
						"          UPLOAD_DATE = upload_date,",
						"          FIRSTNAME,",
						"          LASTNAME,",
						"          PLACE_OF_BUSINESS,",
						"          DEGREE_OF_SEVERE_DISABILITY,",
						"          AGE = AGE_Calculated,",
						"          LOAD_PERIOD,",
						"          LENGTH_OF_EMPLOYMENT_IN_YEARS = Length_of_Employment,",
						"          DATE_OF_BIRTH",
						"     )) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/200_STG_SAE')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Add_NonPersonio_Employees')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "200_Personio_Data",
								"type": "DatasetReference"
							},
							"name": "source1"
						},
						{
							"dataset": {
								"referenceName": "200_STG_SML",
								"type": "DatasetReference"
							},
							"name": "MinloadPeriod"
						},
						{
							"dataset": {
								"referenceName": "200_CompanyTranslation",
								"type": "DatasetReference"
							},
							"name": "CompanyTranslation"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "200_STG_SEE",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "derivedColumn1"
						},
						{
							"name": "join1"
						},
						{
							"name": "filter1"
						},
						{
							"name": "join2"
						}
					],
					"scriptLines": [
						"source(output(",
						"          STATUS as string,",
						"          ID as string,",
						"          MAILADDRESS as string,",
						"          FIRSTNAME as string,",
						"          LASTNAME as string,",
						"          DEPARTMENT as string,",
						"          AGE as decimal(27,4),",
						"          HIRED_AS as string,",
						"          HIRE_DATE as date,",
						"          EMPLOYMENT_TYPE as string,",
						"          EMPLOYEE_GROUPS_BY_FUNCTION as string,",
						"          EXIT_TYPE as string,",
						"          EXIT_TYPE_2 as string,",
						"          LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD as date,",
						"          PLACE_OF_BUSINESS as string,",
						"          LENGTH_OF_EMPLOYMENT_IN_YEARS as decimal(27,4),",
						"          ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD as date,",
						"          END_OF_EMPLOYMENT as date,",
						"          FIRST_ENTRY_DATE as date,",
						"          FTE as decimal(27,4),",
						"          GENDER as string,",
						"          COMPANY as string,",
						"          DEGREE_OF_SEVERE_DISABILITY as string,",
						"          COST_CENTRE as string,",
						"          TERMINATION_DATE as date,",
						"          REASON_FOR_TERMINATION as string,",
						"          NUMBER_OF_EMPLOYEES_STATUS_ACTIVE_AND_TIME_OFF as decimal(27,4),",
						"          DATEV_PERSONNEL_NUMBER as string,",
						"          POSITION as string,",
						"          WEEKLY_HOURS as decimal(27,4),",
						"          LOAD_PERIOD as string,",
						"          LOAD_TIME as timestamp,",
						"          BAD_CHURN as string,",
						"          ACCIDENT_AT_WORK as string,",
						"          WORKRELATED_DEATH as string,",
						"          COMPANY_KEY as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source1",
						"source(output(",
						"          COMPANY as string,",
						"          Min_Load_Period as integer,",
						"          COMPANY_KEY as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> MinloadPeriod",
						"source(output(",
						"          COMPANY as string,",
						"          COMPANY_KEY as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT  [COMPANY] ,[COMPANY_KEY]\\nfrom [200_STG].[D_COMPANY_TRANSLATION]',",
						"     format: 'query') ~> CompanyTranslation",
						"filter1 derive(BAD_CHURN_ADJUSTED = iif( isNull(BAD_CHURN) || BAD_CHURN == \"No\" , \"Ja\", \"Nein\"),",
						"          COST_CENTRE_INT = toInteger(COST_CENTRE),",
						"          ID_INT = toInteger(ID)) ~> derivedColumn1",
						"join2, MinloadPeriod join(CompanyTranslation@COMPANY_KEY == MinloadPeriod@COMPANY_KEY,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join1",
						"join1 filter(toInteger(LOAD_PERIOD) < Min_Load_Period) ~> filter1",
						"source1, CompanyTranslation join(source1@COMPANY == CompanyTranslation@COMPANY,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join2",
						"derivedColumn1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          STATUS,",
						"          ID = ID_INT,",
						"          MAILADDRESS,",
						"          FIRSTNAME,",
						"          LASTNAME,",
						"          DEPARTMENT,",
						"          AGE,",
						"          HIRED_AS,",
						"          HIRE_DATE,",
						"          EMPLOYMENT_TYPE,",
						"          EMPLOYEE_GROUPS_BY_FUNCTION,",
						"          EXIT_TYPE,",
						"          EXIT_TYPE_2,",
						"          LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD,",
						"          PLACE_OF_BUSINESS,",
						"          LENGTH_OF_EMPLOYMENT_IN_YEARS,",
						"          ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD,",
						"          END_OF_EMPLOYMENT,",
						"          FIRST_ENTRY_DATE,",
						"          FTE,",
						"          GENDER,",
						"          COMPANY,",
						"          DEGREE_OF_SEVERE_DISABILITY,",
						"          COST_CENTRE = COST_CENTRE_INT,",
						"          TERMINATION_DATE,",
						"          REASON_FOR_TERMINATION,",
						"          NUMBER_OF_EMPLOYEES_STATUS_ACTIVE_AND_TIME_OFF,",
						"          DATEV_PERSONNEL_NUMBER,",
						"          POSITION,",
						"          WEEKLY_HOURS,",
						"          LOAD_PERIOD,",
						"          LOAD_TIME,",
						"          BAD_CHURN = BAD_CHURN_ADJUSTED,",
						"          ACCIDENT_AT_WORK,",
						"          WORKRELATED_DEATH",
						"     )) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/200_Personio_Data')]",
				"[concat(variables('factoryId'), '/datasets/200_STG_SML')]",
				"[concat(variables('factoryId'), '/datasets/200_CompanyTranslation')]",
				"[concat(variables('factoryId'), '/datasets/200_STG_SEE')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DF 100 STG Personio api data')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "JSON_PersonioAPI",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "100_STG_SRAE",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "aggregate1"
						},
						{
							"name": "flatten1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          data as (attributes as (archival_status as string, archived_at as string, author_first_name as string, author_last_name as string, columns as string[], created_at as timestamp, data_refreshed_at as timestamp, description as string, end_date as date, filters as string[], id as string, items as (employee_id as integer, historical_attributes as (attribute_id as string, cost_centers as (cost_center_id as integer, name as string, weight as short)[], data_type as string, effective_date as date, employee_id as integer, entity_id as integer, value as string)[])[], name as string, period_type as string, start_date as date, status as string, type as string, updated_at as string), type as string)[],",
						"          limit as boolean,",
						"          metadata as (current_page as boolean, total_elements as short, total_pages as boolean),",
						"          offset as boolean,",
						"          success as boolean",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     inferDriftedColumnTypes: true,",
						"     ignoreNoFilesFound: false,",
						"     documentForm: 'documentPerLine') ~> source1",
						"source1 aggregate(data = max(data.attributes.items.historical_attributes)) ~> aggregate1",
						"aggregate1 foldDown(unroll(data),",
						"     mapColumn(",
						"          historical_atributes = data",
						"     ),",
						"     skipDuplicateMapInputs: false,",
						"     skipDuplicateMapOutputs: false) ~> flatten1",
						"flatten1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          employee_id as integer,",
						"          attribute_id as string,",
						"          cost_center_id as integer,",
						"          cost_center_name as string,",
						"          cost_center_weight as integer,",
						"          data_type as string,",
						"          effective_date as date,",
						"          entity_id as integer,",
						"          value as string",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          employee_id = historical_atributes.employee_id,",
						"          attribute_id = historical_atributes.attribute_id,",
						"          cost_center_id = historical_atributes.cost_centers[1].cost_center_id,",
						"          cost_center_name = historical_atributes.cost_centers[1].name,",
						"          cost_center_weight = historical_atributes.cost_centers[1].weight,",
						"          data_type = historical_atributes.data_type,",
						"          effective_date = historical_atributes.effective_date,",
						"          entity_id = historical_atributes.entity_id,",
						"          value = historical_atributes.value",
						"     )) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/JSON_PersonioAPI')]",
				"[concat(variables('factoryId'), '/datasets/100_STG_SRAE')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DF 150 STG Personio api data')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "100_STG_SRAE",
								"type": "DatasetReference"
							},
							"name": "source1"
						},
						{
							"dataset": {
								"referenceName": "100_STG_SRAE",
								"type": "DatasetReference"
							},
							"name": "source2"
						},
						{
							"dataset": {
								"referenceName": "100_STG_SRAE",
								"type": "DatasetReference"
							},
							"name": "badchurns"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "150_STG_SPA",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "pivot1"
						},
						{
							"name": "aggregate1"
						},
						{
							"name": "derivedColumn1"
						},
						{
							"name": "join1"
						},
						{
							"name": "derivedColumn2"
						},
						{
							"name": "MapDrifted1",
							"description": "Hiermit wird für jede abweichende Spalte eine explizite Zuordnung erstellt."
						},
						{
							"name": "join2"
						}
					],
					"scriptLines": [
						"source(output(",
						"          employee_id as integer,",
						"          attribute_id as string,",
						"          cost_center_id as integer,",
						"          cost_center_name as string,",
						"          cost_center_weight as integer,",
						"          data_type as string,",
						"          effective_date as date,",
						"          entity_id as integer,",
						"          value as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source1",
						"source(output(",
						"          employee_id as integer,",
						"          attribute_id as string,",
						"          cost_center_id as integer,",
						"          cost_center_name as string,",
						"          cost_center_weight as integer,",
						"          data_type as string,",
						"          effective_date as date,",
						"          entity_id as integer,",
						"          value as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source2",
						"source(output(",
						"          employee_id as integer,",
						"          attribute_id as string,",
						"          effective_date as date,",
						"          value as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT \"employee_id\", \"attribute_id\", \"effective_date\", \"value\"\\nFROM \"100_STG\".\"SRAE_raw_api_employees\"\\nWHERE \"attribute_id\" = \\'dynamic_7467162\\'',",
						"     format: 'query') ~> badchurns",
						"source1 pivot(groupBy(employee_id,",
						"          effective_date),",
						"     pivotBy(attribute_id),",
						"     {} = max(value),",
						"     columnNaming: '$N$V',",
						"     lateral: true) ~> pivot1",
						"source2 aggregate(groupBy(employee_id,",
						"          effective_date),",
						"     cost_center_id = max(cost_center_id),",
						"          cost_center_name = max(cost_center_name),",
						"          cost_center_weight = max(cost_center_weight)) ~> aggregate1",
						"aggregate1 derive(sqlhash = md5(employee_id,effective_date)) ~> derivedColumn1",
						"derivedColumn1, MapDrifted1 join(aggregate1@employee_id == pivot1@employee_id",
						"     && aggregate1@effective_date == pivot1@effective_date,",
						"     joinType:'outer',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join1",
						"join2 derive(upload_date = fromUTC(currentUTC(), 'Europe/Berlin')) ~> derivedColumn2",
						"pivot1 derive(cost_centers = toString(byName('cost_centers')),",
						"          department_id = toString(byName('department_id')),",
						"          dynamic_4455758 = toString(byName('dynamic_4455758')),",
						"          dynamic_4455760 = toString(byName('dynamic_4455760')),",
						"          dynamic_4668965 = toString(byName('dynamic_4668965')),",
						"          dynamic_4668966 = toString(byName('dynamic_4668966')),",
						"          dynamic_4668967 = toString(byName('dynamic_4668967')),",
						"          dynamic_4908028 = toString(byName('dynamic_4908028')),",
						"          dynamic_4908107 = toString(byName('dynamic_4908107')),",
						"          dynamic_5849877 = toString(byName('dynamic_5849877')),",
						"          dynamic_7173473 = toString(byName('dynamic_7173473')),",
						"          email = toString(byName('email')),",
						"          employment_type = toString(byName('employment_type')),",
						"          fte = toString(byName('fte')),",
						"          gender = toString(byName('gender')),",
						"          position = toString(byName('position')),",
						"          status = toString(byName('status')),",
						"          subcompany_id = toString(byName('subcompany_id')),",
						"          supervisor_id = toString(byName('supervisor_id')),",
						"          termination_type = toString(byName('termination_type')),",
						"          weekly_working_hours = toString(byName('weekly_working_hours'))) ~> MapDrifted1",
						"join1, badchurns join(aggregate1@employee_id == badchurns@employee_id",
						"     && aggregate1@effective_date == badchurns@effective_date,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join2",
						"derivedColumn2 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          employee_id = aggregate1@employee_id,",
						"          effective_date = aggregate1@effective_date,",
						"          cost_center_id,",
						"          cost_center_name,",
						"          cost_center_weight,",
						"          sqlhash,",
						"          employee_id = pivot1@employee_id,",
						"          effective_date = pivot1@effective_date,",
						"          department_id,",
						"          first_entry_date = dynamic_4668965,",
						"          entry_date = dynamic_4668966,",
						"          exit_date = dynamic_4668967,",
						"          permanent_employee = dynamic_4908028,",
						"          dynamic_7173473,",
						"          email,",
						"          fte,",
						"          gender,",
						"          position,",
						"          subcompany_id,",
						"          termination_type,",
						"          weekly_working_hours,",
						"          upload_date,",
						"          place_of_business = dynamic_5849877,",
						"          DEGREE_OF_SEVERE_DISABILITY = dynamic_4908107,",
						"          age = dynamic_4455758,",
						"          bad_churn = value,",
						"          status",
						"     )) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/100_STG_SRAE')]",
				"[concat(variables('factoryId'), '/datasets/150_STG_SPA')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DF 175 STG Personio api data')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "150_STG_SPA",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "175_STG_SPAE",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "sort1"
						},
						{
							"name": "window1"
						},
						{
							"name": "derivedColumn1"
						},
						{
							"name": "window2"
						},
						{
							"name": "derivedColumn2"
						},
						{
							"name": "select1"
						},
						{
							"name": "filter1"
						},
						{
							"name": "filter2"
						}
					],
					"scriptLines": [
						"source(output(",
						"          employee_id as integer,",
						"          effective_date as date,",
						"          cost_center_id as integer,",
						"          cost_center_name as string,",
						"          cost_center_weight as integer,",
						"          sqlhash as string,",
						"          department_id as string,",
						"          first_entry_date as string,",
						"          entry_date as string,",
						"          exit_date as string,",
						"          permanent_employee as string,",
						"          dynamic_7173473 as string,",
						"          email as string,",
						"          fte as string,",
						"          gender as string,",
						"          position as string,",
						"          subcompany_id as string,",
						"          termination_type as string,",
						"          weekly_working_hours as string,",
						"          upload_date as timestamp,",
						"          place_of_business as string,",
						"          DEGREE_OF_SEVERE_DISABILITY as string,",
						"          age as string,",
						"          bad_churn as string,",
						"          status as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source1",
						"source1 sort(asc(employee_id, true),",
						"     asc(effective_date, true)) ~> sort1",
						"sort1 window(over(employee_id),",
						"     asc(effective_date, true),",
						"     Valid_to = lead(effective_date, 1, null())) ~> window1",
						"window1 derive(Valid_to = addDays(Valid_to, -1)) ~> derivedColumn1",
						"derivedColumn1 window(over(employee_id),",
						"     asc(effective_date, true),",
						"     Rank = denseRank()) ~> window2",
						"window2 derive(IsCurrent = iif(Rank == 1, \"TRUE\", \"FALSE\"),",
						"          FIRSTNAME = initCap((split(split(email, '@')[1], '.')[1])),",
						"          LASTNAME = initCap((split(split(email, '@')[1], '.')[2])),",
						"          Date_entry_date = toDate(entry_date, \"yyyy-MM-dd\"),",
						"          Date_exit_date = toDate(exit_date, \"yyyy-MM-dd\"),",
						"          Date_first_entry_date = toDate(first_entry_date, \"yyyy-MM-dd\")) ~> derivedColumn2",
						"derivedColumn2 select(mapColumn(",
						"          sqlhash,",
						"          employee_id,",
						"          effective_date,",
						"          Valid_to,",
						"          cost_center_id,",
						"          cost_center_name,",
						"          cost_center_weight,",
						"          cost_centers = cost_center_name,",
						"          department_id,",
						"          first_entry_date = Date_first_entry_date,",
						"          entry_date = Date_entry_date,",
						"          exit_date = Date_exit_date,",
						"          permanent_employee,",
						"          dynamic_7173473,",
						"          email,",
						"          fte,",
						"          gender,",
						"          position,",
						"          subcompany_id,",
						"          termination_type,",
						"          weekly_working_hours,",
						"          upload_date,",
						"          FIRSTNAME,",
						"          LASTNAME,",
						"          place_of_business,",
						"          DEGREE_OF_SEVERE_DISABILITY,",
						"          age,",
						"          bad_churn,",
						"          status",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select1",
						"select1 filter(and(\r",
						"    permanent_employee != \"gewerbliche Aushilfe\",\r",
						"    and(\r",
						"        permanent_employee != \"Leiharbeitnehmer:in\",\r",
						"        permanent_employee != \"Employer of Record (EOR)\"\r",
						"    )\r",
						")) ~> filter1",
						"filter1 filter(!(permanent_employee == 'Testaccount'",
						"  || LASTNAME == 'Mustermann'",
						"  || LASTNAME == 'Mustermann-test')) ~> filter2",
						"filter2 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          SID = sqlhash,",
						"          ID = employee_id,",
						"          VALID_FROM = effective_date,",
						"          VALID_TO = Valid_to,",
						"          COST_CENTRE = cost_center_id,",
						"          cost_center_name,",
						"          cost_center_weight,",
						"          cost_centers = cost_center_name,",
						"          DEPARTMENT = department_id,",
						"          FIRST_ENTRY_DATE = first_entry_date,",
						"          ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD = entry_date,",
						"          LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD = exit_date,",
						"          HIRED_AS = permanent_employee,",
						"          EMPLOYEE_GROUPS_BY_FUNCTION = dynamic_7173473,",
						"          MAILADDRESS = email,",
						"          FTE = fte,",
						"          GENDER = gender,",
						"          POSITION = position,",
						"          COMPANY = subcompany_id,",
						"          EXIT_TYPE = termination_type,",
						"          WEEKLY_HOURS = weekly_working_hours,",
						"          upload_date,",
						"          FIRSTNAME,",
						"          LASTNAME,",
						"          PLACE_OF_BUSINESS = place_of_business,",
						"          DEGREE_OF_SEVERE_DISABILITY,",
						"          DATE_OF_BIRTH = age,",
						"          BAD_CHURN = bad_churn,",
						"          status",
						"     )) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/150_STG_SPA')]",
				"[concat(variables('factoryId'), '/datasets/175_STG_SPAE')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dataflow1')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "200_STG_SAE",
								"type": "DatasetReference"
							},
							"name": "STGSAE"
						},
						{
							"dataset": {
								"referenceName": "200_STG_SML",
								"type": "DatasetReference"
							},
							"name": "MINLOADPERSONIO"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "200_STG_SAE",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "join1"
						},
						{
							"name": "filter1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          ID as integer,",
						"          SID as string,",
						"          VALID_FROM as date,",
						"          VALID_TO as date,",
						"          COST_CENTRE as integer,",
						"          cost_center_name as string,",
						"          cost_center_weight as integer,",
						"          DEPARTMENT as string,",
						"          FIRST_ENTRY_DATE as date,",
						"          ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD as date,",
						"          LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD as date,",
						"          HIRED_AS as string,",
						"          EMPLOYEE_GROUPS_BY_FUNCTION as string,",
						"          MAILADDRESS as string,",
						"          FTE as string,",
						"          GENDER as string,",
						"          POSITION as string,",
						"          COMPANY as string,",
						"          EXIT_TYPE as string,",
						"          WEEKLY_HOURS as string,",
						"          upload_date as timestamp,",
						"          FIRSTNAME as string,",
						"          LASTNAME as string,",
						"          PLACE_OF_BUSINESS as string,",
						"          DEGREE_OF_SEVERE_DISABILITY as string,",
						"          DATE_OF_BIRTH as string,",
						"          BAD_CHURN as string,",
						"          LOAD_PERIOD as string,",
						"          AGE as integer,",
						"          TENURE as integer,",
						"          start_accident_date as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> STGSAE",
						"source(output(",
						"          COMPANY as string,",
						"          Min_Load_Period as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> MINLOADPERSONIO",
						"STGSAE, MINLOADPERSONIO join(STGSAE@COMPANY == MINLOADPERSONIO@COMPANY,",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join1",
						"join1 filter(toInteger(LOAD_PERIOD) >= Min_Load_Period) ~> filter1",
						"filter1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     preSQLs:['TRUNCATE TABLE [200_STG].[SAE_API_EMPLOYEES]'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          ID,",
						"          SID,",
						"          VALID_FROM,",
						"          VALID_TO,",
						"          COST_CENTRE,",
						"          cost_center_name,",
						"          cost_center_weight,",
						"          DEPARTMENT,",
						"          FIRST_ENTRY_DATE,",
						"          ENTRY_DATE_CURRENT_EMPLOYMENT_PERIOD,",
						"          LEAVING_DATE_CURRENT_EMPLOYMENT_PERIOD,",
						"          HIRED_AS,",
						"          EMPLOYEE_GROUPS_BY_FUNCTION,",
						"          MAILADDRESS,",
						"          FTE,",
						"          GENDER,",
						"          POSITION,",
						"          COMPANY = STGSAE@COMPANY,",
						"          EXIT_TYPE,",
						"          WEEKLY_HOURS,",
						"          upload_date,",
						"          FIRSTNAME,",
						"          LASTNAME,",
						"          PLACE_OF_BUSINESS,",
						"          DEGREE_OF_SEVERE_DISABILITY,",
						"          DATE_OF_BIRTH,",
						"          BAD_CHURN,",
						"          LOAD_PERIOD,",
						"          AGE,",
						"          TENURE,",
						"          start_accident_date",
						"     )) ~> sink1"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/200_STG_SAE')]",
				"[concat(variables('factoryId'), '/datasets/200_STG_SML')]"
			]
		}
	]
}